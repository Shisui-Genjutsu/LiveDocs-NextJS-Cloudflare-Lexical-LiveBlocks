exports.id=721,exports.ids=[721],exports.modules={25881:(e,t,r)=>{"use strict";r.d(t,{z:()=>iH});var i,s,n,a,o,d,l,h,c,u,p,f,m,y,g,_,w,k,v,b=Object.defineProperty,S=Object.getOwnPropertyDescriptor,T=Object.getOwnPropertyNames,E=Object.prototype.hasOwnProperty,A=e=>{throw TypeError(e)},I=(e,t,r)=>t.has(e)||A("Cannot "+r),O=(e,t,r)=>(I(e,t,"read from private field"),r?r.call(e):t.get(e)),C=(e,t,r)=>t.has(e)?A("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),x=(e,t,r,i)=>(I(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),P=(e,t,r)=>(I(e,t,"access private method"),r),N={initialDelay:125,maxDelayBetweenRetries:0,factor:2,shouldRetry:(e,t)=>t<5,retryImmediately:!1,jitter:!0},U=async e=>new Promise(t=>setTimeout(t,e)),R=(e,t)=>t?e*(1+Math.random()):e,D=e=>{let t=0,r=()=>{let r=e.initialDelay*Math.pow(e.factor,t);return r=R(r,e.jitter),Math.min(e.maxDelayBetweenRetries||r,r)};return async()=>{await U(r()),t++}},q=async(e,t={})=>{let r=0,{shouldRetry:i,initialDelay:s,maxDelayBetweenRetries:n,factor:a,retryImmediately:o,jitter:d}={...N,...t},l=D({initialDelay:s,maxDelayBetweenRetries:n,factor:a,jitter:d});for(;;)try{return await e()}catch(e){if(!i(e,++r))throw e;o&&1===r?await U(R(100,d)):await l()}},L=e=>"undefined"!=typeof atob&&"function"==typeof atob?atob(e):"undefined"!=typeof global&&global.Buffer?new global.Buffer(e,"base64").toString():e,M=e=>"undefined"!=typeof btoa&&"function"==typeof btoa?btoa(e):"undefined"!=typeof global&&global.Buffer?new global.Buffer(e).toString("base64"):e,$=[".lcl.dev",".stg.dev",".lclstage.dev",".stgstage.dev",".dev.lclclerk.com",".stg.lclclerk.com",".accounts.lclclerk.com","accountsstage.dev","accounts.dev"],j="pk_live_";function J(e){if(!e.endsWith("$"))return!1;let t=e.slice(0,-1);return!t.includes("$")&&t.includes(".")}function z(e,t={}){let r;if(!(e=e||"")||!H(e)){if(t.fatal&&!e)throw Error("Publishable key is missing. Ensure that your publishable key is correctly configured. Double-check your environment configuration for your keys, or access them here: https://dashboard.clerk.com/last-active?path=api-keys");if(t.fatal&&!H(e))throw Error("Publishable key not valid.");return null}let i=e.startsWith(j)?"production":"development";try{r=L(e.split("_")[2])}catch{if(t.fatal)throw Error("Publishable key not valid: Failed to decode key.");return null}if(!J(r)){if(t.fatal)throw Error("Publishable key not valid: Decoded key has invalid format.");return null}let s=r.slice(0,-1);return t.proxyUrl?s=t.proxyUrl:"development"!==i&&t.domain&&t.isSatellite&&(s=`clerk.${t.domain}`),{instanceType:i,frontendApi:s}}function H(e=""){try{if(!(e.startsWith(j)||e.startsWith("pk_test_")))return!1;let t=e.split("_");if(3!==t.length)return!1;let r=t[2];if(!r)return!1;let i=L(r);return J(i)}catch{return!1}}async function K(e,t=globalThis.crypto.subtle){let r=new TextEncoder().encode(e);return M(String.fromCharCode(...new Uint8Array(await t.digest("sha-1",r)))).replace(/\+/gi,"-").replace(/\//gi,"_").substring(0,8)}var W=(e,t)=>`${e}_${t}`,F=()=>!1,B=()=>{try{return!0}catch{}return!1},G=new Set,V=(e,t,r)=>{let i=F()||B(),s=r??e;G.has(s)||i||(G.add(s),console.warn(`Clerk - DEPRECATION WARNING: "${e}" is deprecated and will be removed in the next major release.
${t}`))};function Y(e){return{code:e.code,message:e.message,longMessage:e.long_message,meta:{paramName:e?.meta?.param_name,sessionId:e?.meta?.session_id,emailAddresses:e?.meta?.email_addresses,identifiers:e?.meta?.identifiers,zxcvbn:e?.meta?.zxcvbn,plan:e?.meta?.plan,isPlanUpgradePossible:e?.meta?.is_plan_upgrade_possible}}}var Q=class e extends Error{constructor(t,{data:r,status:i,clerkTraceId:s,retryAfter:n}){super(t),this.toString=()=>{let e=`[${this.name}]
Message:${this.message}
Status:${this.status}
Serialized errors: ${this.errors.map(e=>JSON.stringify(e))}`;return this.clerkTraceId&&(e+=`
Clerk Trace ID: ${this.clerkTraceId}`),e},Object.setPrototypeOf(this,e.prototype),this.status=i,this.message=t,this.clerkTraceId=s,this.retryAfter=n,this.clerkError=!0,this.errors=function(e=[]){return e.length>0?e.map(Y):[]}(r)}},X=Object.freeze({InvalidProxyUrlErrorMessage:"The proxyUrl passed to Clerk is invalid. The expected value for proxyUrl is an absolute URL or a relative path with a leading '/'. (key={{url}})",InvalidPublishableKeyErrorMessage:"The publishableKey passed to Clerk is invalid. You can get your Publishable key at https://dashboard.clerk.com/last-active?path=api-keys. (key={{key}})",MissingPublishableKeyErrorMessage:"Missing publishableKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingSecretKeyErrorMessage:"Missing secretKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingClerkProvider:"{{source}} can only be used within the <ClerkProvider /> component. Learn more: https://clerk.com/docs/components/clerk-provider"});!function({packageName:e,customMessages:t}){}({packageName:"@clerk/backend"});var{isDevOrStagingUrl:Z}=function(){let e=new Map;return{isDevOrStagingUrl:t=>{if(!t)return!1;let r="string"==typeof t?t:t.hostname,i=e.get(r);return void 0===i&&(i=$.some(e=>r.endsWith(e)),e.set(r,i)),i}}}(),ee={InvalidSecretKey:"clerk_key_invalid"},et={TokenExpired:"token-expired",TokenInvalid:"token-invalid",TokenInvalidAlgorithm:"token-invalid-algorithm",TokenInvalidAuthorizedParties:"token-invalid-authorized-parties",TokenInvalidSignature:"token-invalid-signature",TokenNotActiveYet:"token-not-active-yet",TokenIatInTheFuture:"token-iat-in-the-future",TokenVerificationFailed:"token-verification-failed",InvalidSecretKey:"secret-key-invalid",LocalJWKMissing:"jwk-local-missing",RemoteJWKFailedToLoad:"jwk-remote-failed-to-load",JWKFailedToResolve:"jwk-failed-to-resolve",JWKKidMismatch:"jwk-kid-mismatch"},er={ContactSupport:"Contact support@clerk.com",EnsureClerkJWT:"Make sure that this is a valid Clerk generate JWT.",SetClerkJWTKey:"Set the CLERK_JWT_KEY environment variable.",SetClerkSecretKey:"Set the CLERK_SECRET_KEY environment variable."},ei=class e extends Error{constructor({action:t,message:r,reason:i}){super(r),Object.setPrototypeOf(this,e.prototype),this.reason=i,this.message=r,this.action=t}getFullMessage(){return`${[this.message,this.action].filter(e=>e).join(" ")} (reason=${this.reason}, token-carrier=${this.tokenCarrier})`}},es={TokenInvalid:"token-invalid",InvalidSecretKey:"secret-key-invalid",UnexpectedError:"unexpected-error"},en=class e extends Error{constructor({message:t,code:r,status:i}){super(t),Object.setPrototypeOf(this,e.prototype),this.code=r,this.status=i}getFullMessage(){return`${this.message} (code=${this.code}, status=${this.status})`}},ea=r(77598),eo=fetch.bind(globalThis),ed={crypto:ea.webcrypto,get fetch(){return eo},AbortController:globalThis.AbortController,Blob:globalThis.Blob,FormData:globalThis.FormData,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response},el={parse:(e,t)=>(function(e,t,r={}){if(!t.codes){t.codes={};for(let e=0;e<t.chars.length;++e)t.codes[t.chars[e]]=e}if(!r.loose&&e.length*t.bits&7)throw SyntaxError("Invalid padding");let i=e.length;for(;"="===e[i-1];)if(--i,!r.loose&&!((e.length-i)*t.bits&7))throw SyntaxError("Invalid padding");let s=new(r.out??Uint8Array)(i*t.bits/8|0),n=0,a=0,o=0;for(let r=0;r<i;++r){let i=t.codes[e[r]];if(void 0===i)throw SyntaxError("Invalid character "+e[r]);a=a<<t.bits|i,(n+=t.bits)>=8&&(n-=8,s[o++]=255&a>>n)}if(n>=t.bits||255&a<<8-n)throw SyntaxError("Unexpected end of data");return s})(e,eh,t)},eh={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bits:6},ec={RS256:"SHA-256",RS384:"SHA-384",RS512:"SHA-512"},eu="RSASSA-PKCS1-v1_5",ep={RS256:eu,RS384:eu,RS512:eu},ef=Object.keys(ec),em=e=>Array.isArray(e)&&e.length>0&&e.every(e=>"string"==typeof e),ey=(e,t)=>{let r=[t].flat().filter(e=>!!e),i=[e].flat().filter(e=>!!e);if(r.length>0&&i.length>0){if("string"==typeof e){if(!r.includes(e))throw new ei({action:er.EnsureClerkJWT,reason:et.TokenVerificationFailed,message:`Invalid JWT audience claim (aud) ${JSON.stringify(e)}. Is not included in "${JSON.stringify(r)}".`})}else if(em(e)&&!e.some(e=>r.includes(e)))throw new ei({action:er.EnsureClerkJWT,reason:et.TokenVerificationFailed,message:`Invalid JWT audience claim array (aud) ${JSON.stringify(e)}. Is not included in "${JSON.stringify(r)}".`})}},eg=e=>{if(void 0!==e&&"JWT"!==e)throw new ei({action:er.EnsureClerkJWT,reason:et.TokenInvalid,message:`Invalid JWT type ${JSON.stringify(e)}. Expected "JWT".`})},e_=e=>{if(!ef.includes(e))throw new ei({action:er.EnsureClerkJWT,reason:et.TokenInvalidAlgorithm,message:`Invalid JWT algorithm ${JSON.stringify(e)}. Supported: ${ef}.`})},ew=e=>{if("string"!=typeof e)throw new ei({action:er.EnsureClerkJWT,reason:et.TokenVerificationFailed,message:`Subject claim (sub) is required and must be a string. Received ${JSON.stringify(e)}.`})},ek=(e,t)=>{if(e&&t&&0!==t.length&&!t.includes(e))throw new ei({reason:et.TokenInvalidAuthorizedParties,message:`Invalid JWT Authorized party claim (azp) ${JSON.stringify(e)}. Expected "${t}".`})},ev=(e,t)=>{if("number"!=typeof e)throw new ei({action:er.EnsureClerkJWT,reason:et.TokenVerificationFailed,message:`Invalid JWT expiry date claim (exp) ${JSON.stringify(e)}. Expected number.`});let r=new Date(Date.now()),i=new Date(0);if(i.setUTCSeconds(e),i.getTime()<=r.getTime()-t)throw new ei({reason:et.TokenExpired,message:`JWT is expired. Expiry date: ${i.toUTCString()}, Current date: ${r.toUTCString()}.`})},eb=(e,t)=>{if(void 0===e)return;if("number"!=typeof e)throw new ei({action:er.EnsureClerkJWT,reason:et.TokenVerificationFailed,message:`Invalid JWT not before date claim (nbf) ${JSON.stringify(e)}. Expected number.`});let r=new Date(Date.now()),i=new Date(0);if(i.setUTCSeconds(e),i.getTime()>r.getTime()+t)throw new ei({reason:et.TokenNotActiveYet,message:`JWT cannot be used prior to not before date claim (nbf). Not before date: ${i.toUTCString()}; Current date: ${r.toUTCString()};`})},eS=(e,t)=>{if(void 0===e)return;if("number"!=typeof e)throw new ei({action:er.EnsureClerkJWT,reason:et.TokenVerificationFailed,message:`Invalid JWT issued at date claim (iat) ${JSON.stringify(e)}. Expected number.`});let r=new Date(Date.now()),i=new Date(0);if(i.setUTCSeconds(e),i.getTime()>r.getTime()+t)throw new ei({reason:et.TokenIatInTheFuture,message:`JWT issued at date claim (iat) is in the future. Issued at date: ${i.toUTCString()}; Current date: ${r.toUTCString()};`})};async function eT(e,t){let{header:r,signature:i,raw:s}=e,n=new TextEncoder().encode([s.header,s.payload].join(".")),a=function(e){let t=ec[e],r=ep[e];if(!t||!r)throw Error(`Unsupported algorithm ${e}, expected one of ${ef.join(",")}.`);return{hash:{name:ec[e]},name:ep[e]}}(r.alg);try{let e=await function(e,t,r){if("object"==typeof e)return ed.crypto.subtle.importKey("jwk",e,t,!1,[r]);let i=function(e){let t=L(e.replace(/-----BEGIN.*?-----/g,"").replace(/-----END.*?-----/g,"").replace(/\s/g,"")),r=new Uint8Array(new ArrayBuffer(t.length));for(let e=0,i=t.length;e<i;e++)r[e]=t.charCodeAt(e);return r}(e),s="sign"===r?"pkcs8":"spki";return ed.crypto.subtle.importKey(s,i,t,!1,[r])}(t,a,"verify");return{data:await ed.crypto.subtle.verify(a.name,e,i,n)}}catch(e){return{errors:[new ei({reason:et.TokenInvalidSignature,message:e?.message})]}}}function eE(e){let t=(e||"").toString().split(".");if(3!==t.length)return{errors:[new ei({reason:et.TokenInvalid,message:"Invalid JWT form. A JWT consists of three parts separated by dots."})]};let[r,i,s]=t,n=new TextDecoder,a=JSON.parse(n.decode(el.parse(r,{loose:!0}))),o=JSON.parse(n.decode(el.parse(i,{loose:!0})));return{data:{header:a,payload:o,signature:el.parse(s,{loose:!0}),raw:{header:r,payload:i,signature:s,text:e}}}}async function eA(e,t){let{audience:r,authorizedParties:i,clockSkewInMs:s,key:n}=t,a=s||5e3,{data:o,errors:d}=eE(e);if(d)return{errors:d};let{header:l,payload:h}=o;try{let{typ:e,alg:t}=l;eg(e),e_(t);let{azp:s,sub:n,aud:o,iat:d,exp:c,nbf:u}=h;ew(n),ey([o],[r]),ek(s,i),ev(c,a),eb(u,a),eS(d,a)}catch(e){return{errors:[e]}}let{data:c,errors:u}=await eT(o,n);return u?{errors:[new ei({action:er.EnsureClerkJWT,reason:et.TokenVerificationFailed,message:`Error verifying JWT signature. ${u[0]}`})]}:c?{data:h}:{errors:[new ei({reason:et.TokenInvalidSignature,message:"JWT signature is invalid."})]}}var eI={strict_mfa:{afterMinutes:10,level:"multi_factor"},strict:{afterMinutes:10,level:"second_factor"},moderate:{afterMinutes:60,level:"second_factor"},lax:{afterMinutes:1440,level:"second_factor"}},eO=new Set(["first_factor","second_factor","multi_factor"]),eC=new Set(["strict_mfa","strict","moderate","lax"]),ex=e=>"number"==typeof e&&e>0,eP=e=>eO.has(e),eN=e=>eC.has(e),eU=e=>e.replace(/^(org:)*/,"org:"),eR=(e,t)=>{let{orgId:r,orgRole:i,orgPermissions:s}=t;return(e.role||e.permission)&&r&&i&&s?e.permission?s.includes(eU(e.permission)):e.role?eU(i)===eU(e.role):null:null},eD=(e,t)=>{let{org:r,user:i}=eL(e),[s,n]=t.split(":"),a=n||s;return"org"===s?r.includes(a):"user"===s?i.includes(a):[...r,...i].includes(a)},eq=(e,t)=>{let{features:r,plans:i}=t;return e.feature&&r?eD(r,e.feature):e.plan&&i?eD(i,e.plan):null},eL=e=>{let t=e?e.split(",").map(e=>e.trim()):[];return{org:t.filter(e=>e.split(":")[0].includes("o")).map(e=>e.split(":")[1]),user:t.filter(e=>e.split(":")[0].includes("u")).map(e=>e.split(":")[1])}},eM=e=>{if(!e)return!1;let t="string"==typeof e&&eN(e),r="object"==typeof e&&eP(e.level)&&ex(e.afterMinutes);return(!!t||!!r)&&(e=>"string"==typeof e?eI[e]:e).bind(null,e)},e$=(e,{factorVerificationAge:t})=>{if(!e.reverification||!t)return null;let r=eM(e.reverification);if(!r)return null;let{level:i,afterMinutes:s}=r(),[n,a]=t,o=-1!==n?s>n:null,d=-1!==a?s>a:null;switch(i){case"first_factor":return o;case"second_factor":return -1!==a?d:o;case"multi_factor":return -1===a?o:o&&d}},ej=e=>t=>{if(!e.userId)return!1;let r=eq(t,e),i=eR(t,e),s=e$(t,e);return[r||i,s].some(e=>null===e)?[r||i,s].some(e=>!0===e):[r||i,s].every(e=>!0===e)},eJ=({per:e,fpm:t})=>{if(!e||!t)return{permissions:[],featurePermissionMap:[]};let r=e.split(",").map(e=>e.trim()),i=t.split(",").map(e=>Number.parseInt(e.trim(),10)).map(e=>e.toString(2).padStart(r.length,"0").split("").map(e=>Number.parseInt(e,10)).reverse()).filter(Boolean);return{permissions:r,featurePermissionMap:i}},ez=e=>{let t,r,i,s,n=e.fva??null,a=e.sts??null;if(2===e.v){if(e.o){t=e.o?.id,i=e.o?.slg,e.o?.rol&&(r=`org:${e.o?.rol}`);let{org:n}=eL(e.fea),{permissions:a,featurePermissionMap:o}=eJ({per:e.o?.per,fpm:e.o?.fpm});s=function({features:e,permissions:t,featurePermissionMap:r}){if(!e||!t||!r)return[];let i=[];for(let s=0;s<e.length;s++){let n=e[s];if(s>=r.length)continue;let a=r[s];if(a)for(let e=0;e<a.length;e++)1===a[e]&&i.push(`org:${n}:${t[e]}`)}return i}({features:n,featurePermissionMap:o,permissions:a})}}else t=e.org_id,r=e.org_role,i=e.org_slug,s=e.org_permissions;return{sessionClaims:e,sessionId:e.sid,sessionStatus:a,actor:e.act,userId:e.sub,orgId:t,orgRole:r,orgSlug:i,orgPermissions:s,factorVerificationAge:n}},eH=r(63800);function eK(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function eW(e){return e&&e.sensitive?"":"i"}var eF="https://api.clerk.com",eB="@clerk/backend@2.6.0",eG="2025-04-10",eV={Session:"__session",Refresh:"__refresh",ClientUat:"__client_uat",Handshake:"__clerk_handshake",DevBrowser:"__clerk_db_jwt",RedirectCount:"__clerk_redirect_count",HandshakeNonce:"__clerk_handshake_nonce"},eY={ClerkSynced:"__clerk_synced",SuffixedCookies:"suffixed_cookies",ClerkRedirectUrl:"__clerk_redirect_url",DevBrowser:eV.DevBrowser,Handshake:eV.Handshake,HandshakeHelp:"__clerk_help",LegacyDevBrowser:"__dev_session",HandshakeReason:"__clerk_hs_reason",HandshakeNonce:eV.HandshakeNonce,HandshakeFormat:"format"},eQ={Cookies:eV,Headers:{Accept:"accept",AuthMessage:"x-clerk-auth-message",Authorization:"authorization",AuthReason:"x-clerk-auth-reason",AuthSignature:"x-clerk-auth-signature",AuthStatus:"x-clerk-auth-status",AuthToken:"x-clerk-auth-token",CacheControl:"cache-control",ClerkRedirectTo:"x-clerk-redirect-to",ClerkRequestData:"x-clerk-request-data",ClerkUrl:"x-clerk-clerk-url",CloudFrontForwardedProto:"cloudfront-forwarded-proto",ContentType:"content-type",ContentSecurityPolicy:"content-security-policy",ContentSecurityPolicyReportOnly:"content-security-policy-report-only",EnableDebug:"x-clerk-debug",ForwardedHost:"x-forwarded-host",ForwardedPort:"x-forwarded-port",ForwardedProto:"x-forwarded-proto",Host:"host",Location:"location",Nonce:"x-nonce",Origin:"origin",Referrer:"referer",SecFetchDest:"sec-fetch-dest",SecFetchSite:"sec-fetch-site",UserAgent:"user-agent",ReportingEndpoints:"reporting-endpoints"},ContentTypes:{Json:"application/json"},QueryParameters:eY},eX=(e,t)=>{let r;if(e.startsWith("http"))r=new URL(e);else{if(!t||!t.startsWith("http"))throw Error("destination url or return back url should be an absolute path url!");let i=new URL(t);r=new URL(e,i.origin)}return t&&r.searchParams.set("redirect_url",t),r.toString()};function eZ(e,t){return Object.keys(e).reduce((e,r)=>({...e,[r]:t[r]||e[r]}),{...e})}function e0(e){if(!e||"string"!=typeof e)throw Error("Missing Clerk Secret Key. Go to https://dashboard.clerk.com and get your key for your instance.")}var e1=class{constructor(e,t,r){this.cookieSuffix=e,this.clerkRequest=t,this.originalFrontendApi="",this.initPublishableKeyValues(r),this.initHeaderValues(),this.initCookieValues(),this.initHandshakeValues(),Object.assign(this,r),this.clerkUrl=this.clerkRequest.clerkUrl}get sessionToken(){return this.sessionTokenInCookie||this.tokenInHeader}usesSuffixedCookies(){let e=this.getSuffixedCookie(eQ.Cookies.ClientUat),t=this.getCookie(eQ.Cookies.ClientUat),r=this.getSuffixedCookie(eQ.Cookies.Session)||"",i=this.getCookie(eQ.Cookies.Session)||"";if(i&&!this.tokenHasIssuer(i))return!1;if(i&&!this.tokenBelongsToInstance(i))return!0;if(!e&&!r)return!1;let{data:s}=eE(i),n=s?.payload.iat||0,{data:a}=eE(r),o=a?.payload.iat||0;if("0"!==e&&"0"!==t&&n>o||"0"===e&&"0"!==t)return!1;if("production"!==this.instanceType){let r=this.sessionExpired(a);if("0"!==e&&"0"===t&&r)return!1}return!!e||!r}isCrossOriginReferrer(){if(!this.referrer||!this.origin)return!1;try{if("cross-site"===this.getHeader(eQ.Headers.SecFetchSite))return!0;return new URL(this.referrer).origin!==this.origin}catch{return!1}}initPublishableKeyValues(e){z(e.publishableKey,{fatal:!0}),this.publishableKey=e.publishableKey;let t=z(this.publishableKey,{fatal:!0,domain:e.domain,isSatellite:e.isSatellite});this.originalFrontendApi=t.frontendApi;let r=z(this.publishableKey,{fatal:!0,proxyUrl:e.proxyUrl,domain:e.domain,isSatellite:e.isSatellite});this.instanceType=r.instanceType,this.frontendApi=r.frontendApi}initHeaderValues(){this.tokenInHeader=this.parseAuthorizationHeader(this.getHeader(eQ.Headers.Authorization)),this.origin=this.getHeader(eQ.Headers.Origin),this.host=this.getHeader(eQ.Headers.Host),this.forwardedHost=this.getHeader(eQ.Headers.ForwardedHost),this.forwardedProto=this.getHeader(eQ.Headers.CloudFrontForwardedProto)||this.getHeader(eQ.Headers.ForwardedProto),this.referrer=this.getHeader(eQ.Headers.Referrer),this.userAgent=this.getHeader(eQ.Headers.UserAgent),this.secFetchDest=this.getHeader(eQ.Headers.SecFetchDest),this.accept=this.getHeader(eQ.Headers.Accept)}initCookieValues(){this.sessionTokenInCookie=this.getSuffixedOrUnSuffixedCookie(eQ.Cookies.Session),this.refreshTokenInCookie=this.getSuffixedCookie(eQ.Cookies.Refresh),this.clientUat=Number.parseInt(this.getSuffixedOrUnSuffixedCookie(eQ.Cookies.ClientUat)||"")||0}initHandshakeValues(){this.devBrowserToken=this.getQueryParam(eQ.QueryParameters.DevBrowser)||this.getSuffixedOrUnSuffixedCookie(eQ.Cookies.DevBrowser),this.handshakeToken=this.getQueryParam(eQ.QueryParameters.Handshake)||this.getCookie(eQ.Cookies.Handshake),this.handshakeRedirectLoopCounter=Number(this.getCookie(eQ.Cookies.RedirectCount))||0,this.handshakeNonce=this.getQueryParam(eQ.QueryParameters.HandshakeNonce)||this.getCookie(eQ.Cookies.HandshakeNonce)}getQueryParam(e){return this.clerkRequest.clerkUrl.searchParams.get(e)}getHeader(e){return this.clerkRequest.headers.get(e)||void 0}getCookie(e){return this.clerkRequest.cookies.get(e)||void 0}getSuffixedCookie(e){return this.getCookie(W(e,this.cookieSuffix))||void 0}getSuffixedOrUnSuffixedCookie(e){return this.usesSuffixedCookies()?this.getSuffixedCookie(e):this.getCookie(e)}parseAuthorizationHeader(e){if(!e)return;let[t,r]=e.split(" ",2);return r?"Bearer"===t?r:void 0:t}tokenHasIssuer(e){let{data:t,errors:r}=eE(e);return!r&&!!t.payload.iss}tokenBelongsToInstance(e){if(!e)return!1;let{data:t,errors:r}=eE(e);if(r)return!1;let i=t.payload.iss.replace(/https?:\/\//gi,"");return this.originalFrontendApi===i}sessionExpired(e){return!!e&&e?.payload.exp<=(Date.now()/1e3|0)}},e2=async(e,t)=>new e1(t.publishableKey?await K(t.publishableKey,ed.crypto.subtle):"",e,t),e5=RegExp("(?<!:)/{1,}","g");function e6(...e){return e.filter(e=>e).join("/").replace(e5,"/")}var e3=class{constructor(e){this.request=e}requireId(e){if(!e)throw Error("A valid resource ID is required.")}},e4="/actor_tokens",e8=class extends e3{async create(e){return this.request({method:"POST",path:e4,bodyParams:e})}async revoke(e){return this.requireId(e),this.request({method:"POST",path:e6(e4,e,"revoke")})}},e9="/accountless_applications",e7=class extends e3{async createAccountlessApplication(){return this.request({method:"POST",path:e9})}async completeAccountlessApplicationOnboarding(){return this.request({method:"POST",path:e6(e9,"complete")})}},te="/allowlist_identifiers",tt=class extends e3{async getAllowlistIdentifierList(e={}){return this.request({method:"GET",path:te,queryParams:{...e,paginated:!0}})}async createAllowlistIdentifier(e){return this.request({method:"POST",path:te,bodyParams:e})}async deleteAllowlistIdentifier(e){return this.requireId(e),this.request({method:"DELETE",path:e6(te,e)})}},tr="/api_keys",ti=class extends e3{async create(e){return this.request({method:"POST",path:tr,bodyParams:e})}async revoke(e){let{apiKeyId:t,...r}=e;return this.requireId(t),this.request({method:"POST",path:e6(tr,t,"revoke"),bodyParams:r})}async getSecret(e){return this.requireId(e),this.request({method:"GET",path:e6(tr,e,"secret")})}async verifySecret(e){return this.request({method:"POST",path:e6(tr,"verify"),bodyParams:{secret:e}})}},ts=class extends e3{async changeDomain(e){return this.request({method:"POST",path:e6("/beta_features","change_domain"),bodyParams:e})}},tn="/blocklist_identifiers",ta=class extends e3{async getBlocklistIdentifierList(e={}){return this.request({method:"GET",path:tn,queryParams:e})}async createBlocklistIdentifier(e){return this.request({method:"POST",path:tn,bodyParams:e})}async deleteBlocklistIdentifier(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tn,e)})}},to="/clients",td=class extends e3{async getClientList(e={}){return this.request({method:"GET",path:to,queryParams:{...e,paginated:!0}})}async getClient(e){return this.requireId(e),this.request({method:"GET",path:e6(to,e)})}verifyClient(e){return this.request({method:"POST",path:e6(to,"verify"),bodyParams:{token:e}})}async getHandshakePayload(e){return this.request({method:"GET",path:e6(to,"handshake_payload"),queryParams:e})}},tl="/domains",th=class extends e3{async list(){return this.request({method:"GET",path:tl})}async add(e){return this.request({method:"POST",path:tl,bodyParams:e})}async update(e){let{domainId:t,...r}=e;return this.requireId(t),this.request({method:"PATCH",path:e6(tl,t),bodyParams:r})}async delete(e){return this.deleteDomain(e)}async deleteDomain(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tl,e)})}},tc="/email_addresses",tu=class extends e3{async getEmailAddress(e){return this.requireId(e),this.request({method:"GET",path:e6(tc,e)})}async createEmailAddress(e){return this.request({method:"POST",path:tc,bodyParams:e})}async updateEmailAddress(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:e6(tc,e),bodyParams:t})}async deleteEmailAddress(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tc,e)})}},tp=class extends e3{async verifyAccessToken(e){return this.request({method:"POST",path:e6("/oauth_applications/access_tokens","verify"),bodyParams:{access_token:e}})}},tf="/instance",tm=class extends e3{async get(){return this.request({method:"GET",path:tf})}async update(e){return this.request({method:"PATCH",path:tf,bodyParams:e})}async updateRestrictions(e){return this.request({method:"PATCH",path:e6(tf,"restrictions"),bodyParams:e})}async updateOrganizationSettings(e){return this.request({method:"PATCH",path:e6(tf,"organization_settings"),bodyParams:e})}},ty="/invitations",tg=class extends e3{async getInvitationList(e={}){return this.request({method:"GET",path:ty,queryParams:{...e,paginated:!0}})}async createInvitation(e){return this.request({method:"POST",path:ty,bodyParams:e})}async revokeInvitation(e){return this.requireId(e),this.request({method:"POST",path:e6(ty,e,"revoke")})}},t_="/machines",tw=class extends e3{async get(e){return this.requireId(e),this.request({method:"GET",path:e6(t_,e)})}async list(e={}){return this.request({method:"GET",path:t_,queryParams:e})}async create(e){return this.request({method:"POST",path:t_,bodyParams:e})}async update(e){let{machineId:t,...r}=e;return this.requireId(t),this.request({method:"PATCH",path:e6(t_,t),bodyParams:r})}async delete(e){return this.requireId(e),this.request({method:"DELETE",path:e6(t_,e)})}},tk=class extends e3{async verifySecret(e){return this.request({method:"POST",path:e6("/m2m_tokens","verify"),bodyParams:{secret:e}})}},tv=class extends e3{async getJwks(){return this.request({method:"GET",path:"/jwks"})}},tb="/jwt_templates",tS=class extends e3{async list(e={}){return this.request({method:"GET",path:tb,queryParams:{...e,paginated:!0}})}async get(e){return this.requireId(e),this.request({method:"GET",path:e6(tb,e)})}async create(e){return this.request({method:"POST",path:tb,bodyParams:e})}async update(e){let{templateId:t,...r}=e;return this.requireId(t),this.request({method:"PATCH",path:e6(tb,t),bodyParams:r})}async delete(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tb,e)})}},tT="/organizations",tE=class extends e3{async getOrganizationList(e){return this.request({method:"GET",path:tT,queryParams:e})}async createOrganization(e){return this.request({method:"POST",path:tT,bodyParams:e})}async getOrganization(e){let{includeMembersCount:t}=e,r="organizationId"in e?e.organizationId:e.slug;return this.requireId(r),this.request({method:"GET",path:e6(tT,r),queryParams:{includeMembersCount:t}})}async updateOrganization(e,t){return this.requireId(e),this.request({method:"PATCH",path:e6(tT,e),bodyParams:t})}async updateOrganizationLogo(e,t){this.requireId(e);let r=new ed.FormData;return r.append("file",t?.file),t?.uploaderUserId&&r.append("uploader_user_id",t?.uploaderUserId),this.request({method:"PUT",path:e6(tT,e,"logo"),formData:r})}async deleteOrganizationLogo(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tT,e,"logo")})}async updateOrganizationMetadata(e,t){return this.requireId(e),this.request({method:"PATCH",path:e6(tT,e,"metadata"),bodyParams:t})}async deleteOrganization(e){return this.request({method:"DELETE",path:e6(tT,e)})}async getOrganizationMembershipList(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"GET",path:e6(tT,t,"memberships"),queryParams:r})}async getInstanceOrganizationMembershipList(e){return this.request({method:"GET",path:"/organization_memberships",queryParams:e})}async createOrganizationMembership(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"POST",path:e6(tT,t,"memberships"),bodyParams:r})}async updateOrganizationMembership(e){let{organizationId:t,userId:r,...i}=e;return this.requireId(t),this.request({method:"PATCH",path:e6(tT,t,"memberships",r),bodyParams:i})}async updateOrganizationMembershipMetadata(e){let{organizationId:t,userId:r,...i}=e;return this.request({method:"PATCH",path:e6(tT,t,"memberships",r,"metadata"),bodyParams:i})}async deleteOrganizationMembership(e){let{organizationId:t,userId:r}=e;return this.requireId(t),this.request({method:"DELETE",path:e6(tT,t,"memberships",r)})}async getOrganizationInvitationList(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"GET",path:e6(tT,t,"invitations"),queryParams:r})}async createOrganizationInvitation(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"POST",path:e6(tT,t,"invitations"),bodyParams:r})}async createOrganizationInvitationBulk(e,t){return this.requireId(e),this.request({method:"POST",path:e6(tT,e,"invitations","bulk"),bodyParams:t})}async getOrganizationInvitation(e){let{organizationId:t,invitationId:r}=e;return this.requireId(t),this.requireId(r),this.request({method:"GET",path:e6(tT,t,"invitations",r)})}async revokeOrganizationInvitation(e){let{organizationId:t,invitationId:r,...i}=e;return this.requireId(t),this.request({method:"POST",path:e6(tT,t,"invitations",r,"revoke"),bodyParams:i})}async getOrganizationDomainList(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"GET",path:e6(tT,t,"domains"),queryParams:r})}async createOrganizationDomain(e){let{organizationId:t,...r}=e;return this.requireId(t),this.request({method:"POST",path:e6(tT,t,"domains"),bodyParams:{...r,verified:r.verified??!0}})}async updateOrganizationDomain(e){let{organizationId:t,domainId:r,...i}=e;return this.requireId(t),this.requireId(r),this.request({method:"PATCH",path:e6(tT,t,"domains",r),bodyParams:i})}async deleteOrganizationDomain(e){let{organizationId:t,domainId:r}=e;return this.requireId(t),this.requireId(r),this.request({method:"DELETE",path:e6(tT,t,"domains",r)})}},tA="/oauth_applications",tI=class extends e3{async list(e={}){return this.request({method:"GET",path:tA,queryParams:e})}async get(e){return this.requireId(e),this.request({method:"GET",path:e6(tA,e)})}async create(e){return this.request({method:"POST",path:tA,bodyParams:e})}async update(e){let{oauthApplicationId:t,...r}=e;return this.requireId(t),this.request({method:"PATCH",path:e6(tA,t),bodyParams:r})}async delete(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tA,e)})}async rotateSecret(e){return this.requireId(e),this.request({method:"POST",path:e6(tA,e,"rotate_secret")})}},tO="/phone_numbers",tC=class extends e3{async getPhoneNumber(e){return this.requireId(e),this.request({method:"GET",path:e6(tO,e)})}async createPhoneNumber(e){return this.request({method:"POST",path:tO,bodyParams:e})}async updatePhoneNumber(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:e6(tO,e),bodyParams:t})}async deletePhoneNumber(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tO,e)})}},tx=class extends e3{async verify(e){return this.request({method:"POST",path:"/proxy_checks",bodyParams:e})}},tP="/redirect_urls",tN=class extends e3{async getRedirectUrlList(){return this.request({method:"GET",path:tP,queryParams:{paginated:!0}})}async getRedirectUrl(e){return this.requireId(e),this.request({method:"GET",path:e6(tP,e)})}async createRedirectUrl(e){return this.request({method:"POST",path:tP,bodyParams:e})}async deleteRedirectUrl(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tP,e)})}},tU="/saml_connections",tR=class extends e3{async getSamlConnectionList(e={}){return this.request({method:"GET",path:tU,queryParams:e})}async createSamlConnection(e){return this.request({method:"POST",path:tU,bodyParams:e})}async getSamlConnection(e){return this.requireId(e),this.request({method:"GET",path:e6(tU,e)})}async updateSamlConnection(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:e6(tU,e),bodyParams:t})}async deleteSamlConnection(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tU,e)})}},tD="/sessions",tq=class extends e3{async getSessionList(e={}){return this.request({method:"GET",path:tD,queryParams:{...e,paginated:!0}})}async getSession(e){return this.requireId(e),this.request({method:"GET",path:e6(tD,e)})}async createSession(e){return this.request({method:"POST",path:tD,bodyParams:e})}async revokeSession(e){return this.requireId(e),this.request({method:"POST",path:e6(tD,e,"revoke")})}async verifySession(e,t){return this.requireId(e),this.request({method:"POST",path:e6(tD,e,"verify"),bodyParams:{token:t}})}async getToken(e,t,r){this.requireId(e);let i={method:"POST",path:t?e6(tD,e,"tokens",t):e6(tD,e,"tokens")};return void 0!==r&&(i.bodyParams={expires_in_seconds:r}),this.request(i)}async refreshSession(e,t){this.requireId(e);let{suffixed_cookies:r,...i}=t;return this.request({method:"POST",path:e6(tD,e,"refresh"),bodyParams:i,queryParams:{suffixed_cookies:r}})}},tL="/sign_in_tokens",tM=class extends e3{async createSignInToken(e){return this.request({method:"POST",path:tL,bodyParams:e})}async revokeSignInToken(e){return this.requireId(e),this.request({method:"POST",path:e6(tL,e,"revoke")})}},t$="/sign_ups",tj=class extends e3{async get(e){return this.requireId(e),this.request({method:"GET",path:e6(t$,e)})}async update(e){let{signUpAttemptId:t,...r}=e;return this.request({method:"PATCH",path:e6(t$,t),bodyParams:r})}},tJ=class extends e3{async createTestingToken(){return this.request({method:"POST",path:"/testing_tokens"})}},tz="/users",tH=class extends e3{async getUserList(e={}){let{limit:t,offset:r,orderBy:i,...s}=e,[n,a]=await Promise.all([this.request({method:"GET",path:tz,queryParams:e}),this.getCount(s)]);return{data:n,totalCount:a}}async getUser(e){return this.requireId(e),this.request({method:"GET",path:e6(tz,e)})}async createUser(e){return this.request({method:"POST",path:tz,bodyParams:e})}async updateUser(e,t={}){return this.requireId(e),this.request({method:"PATCH",path:e6(tz,e),bodyParams:t})}async updateUserProfileImage(e,t){this.requireId(e);let r=new ed.FormData;return r.append("file",t?.file),this.request({method:"POST",path:e6(tz,e,"profile_image"),formData:r})}async updateUserMetadata(e,t){return this.requireId(e),this.request({method:"PATCH",path:e6(tz,e,"metadata"),bodyParams:t})}async deleteUser(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tz,e)})}async getCount(e={}){return this.request({method:"GET",path:e6(tz,"count"),queryParams:e})}async getUserOauthAccessToken(e,t){this.requireId(e);let r=t.startsWith("oauth_"),i=r?t:`oauth_${t}`;return r&&V("getUserOauthAccessToken(userId, provider)","Remove the `oauth_` prefix from the `provider` argument."),this.request({method:"GET",path:e6(tz,e,"oauth_access_tokens",i),queryParams:{paginated:!0}})}async disableUserMFA(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tz,e,"mfa")})}async getOrganizationMembershipList(e){let{userId:t,limit:r,offset:i}=e;return this.requireId(t),this.request({method:"GET",path:e6(tz,t,"organization_memberships"),queryParams:{limit:r,offset:i}})}async getOrganizationInvitationList(e){let{userId:t,...r}=e;return this.requireId(t),this.request({method:"GET",path:e6(tz,t,"organization_invitations"),queryParams:r})}async verifyPassword(e){let{userId:t,password:r}=e;return this.requireId(t),this.request({method:"POST",path:e6(tz,t,"verify_password"),bodyParams:{password:r}})}async verifyTOTP(e){let{userId:t,code:r}=e;return this.requireId(t),this.request({method:"POST",path:e6(tz,t,"verify_totp"),bodyParams:{code:r}})}async banUser(e){return this.requireId(e),this.request({method:"POST",path:e6(tz,e,"ban")})}async unbanUser(e){return this.requireId(e),this.request({method:"POST",path:e6(tz,e,"unban")})}async lockUser(e){return this.requireId(e),this.request({method:"POST",path:e6(tz,e,"lock")})}async unlockUser(e){return this.requireId(e),this.request({method:"POST",path:e6(tz,e,"unlock")})}async deleteUserProfileImage(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tz,e,"profile_image")})}async deleteUserPasskey(e){return this.requireId(e.userId),this.requireId(e.passkeyIdentificationId),this.request({method:"DELETE",path:e6(tz,e.userId,"passkeys",e.passkeyIdentificationId)})}async deleteUserWeb3Wallet(e){return this.requireId(e.userId),this.requireId(e.web3WalletIdentificationId),this.request({method:"DELETE",path:e6(tz,e.userId,"web3_wallets",e.web3WalletIdentificationId)})}async deleteUserExternalAccount(e){return this.requireId(e.userId),this.requireId(e.externalAccountId),this.request({method:"DELETE",path:e6(tz,e.userId,"external_accounts",e.externalAccountId)})}async deleteUserBackupCodes(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tz,e,"backup_code")})}async deleteUserTOTP(e){return this.requireId(e),this.request({method:"DELETE",path:e6(tz,e,"totp")})}},tK="/waitlist_entries",tW=class extends e3{async list(e={}){return this.request({method:"GET",path:tK,queryParams:e})}async create(e){return this.request({method:"POST",path:tK,bodyParams:e})}},tF="/webhooks",tB=class extends e3{async createSvixApp(){return this.request({method:"POST",path:e6(tF,"svix")})}async generateSvixAuthURL(){return this.request({method:"POST",path:e6(tF,"svix_url")})}async deleteSvixApp(){return this.request({method:"DELETE",path:e6(tF,"svix")})}},tG=e=>"object"==typeof e&&null!==e,tV=e=>tG(e)&&!(e instanceof RegExp)&&!(e instanceof Error)&&!(e instanceof Date)&&!(globalThis.Blob&&e instanceof globalThis.Blob),tY=Symbol("mapObjectSkip"),tQ=(e,t,r,i=new WeakMap)=>{if(r={deep:!1,target:{},...r},i.has(e))return i.get(e);i.set(e,r.target);let{target:s}=r;delete r.target;let n=e=>e.map(e=>tV(e)?tQ(e,t,r,i):e);if(Array.isArray(e))return n(e);for(let[a,o]of Object.entries(e)){let d=t(a,o,e);if(d===tY)continue;let[l,h,{shouldRecurse:c=!0}={}]=d;"__proto__"!==l&&(r.deep&&c&&tV(h)&&(h=Array.isArray(h)?n(h):tQ(h,t,r,i)),s[l]=h)}return s};function tX(e,t,r){if(!tG(e))throw TypeError(`Expected an object, got \`${e}\` (${typeof e})`);if(Array.isArray(e))throw TypeError("Expected an object, got an array");return tQ(e,t,r)}var tZ=/([\p{Ll}\d])(\p{Lu})/gu,t0=/(\p{Lu})([\p{Lu}][\p{Ll}])/gu,t1=/(\d)\p{Ll}|(\p{L})\d/u,t2=/[^\p{L}\d]+/giu,t5="$1\0$2";function t6(e){let t=e.trim();t=(t=t.replace(tZ,t5).replace(t0,t5)).replace(t2,"\0");let r=0,i=t.length;for(;"\0"===t.charAt(r);)r++;if(r===i)return[];for(;"\0"===t.charAt(i-1);)i--;return t.slice(r,i).split(/\0/g)}function t3(e){let t=t6(e);for(let e=0;e<t.length;e++){let r=t[e],i=t1.exec(r);if(i){let s=i.index+(i[1]??i[2]).length;t.splice(e,1,r.slice(0,s),r.slice(s))}}return t}function t4(e,t){var r,i={delimiter:"_",...t};let[s,n,a]=function(e,t={}){let r=t.split??(t.separateNumbers?t3:t6),i=t.prefixCharacters??"",s=t.suffixCharacters??"",n=0,a=e.length;for(;n<e.length;){let t=e.charAt(n);if(!i.includes(t))break;n++}for(;a>n;){let t=a-1,r=e.charAt(t);if(!s.includes(r))break;a=t}return[e.slice(0,n),r(e.slice(n,a)),e.slice(a)]}(e,i);return s+n.map(!1===(r=i?.locale)?e=>e.toLowerCase():e=>e.toLocaleLowerCase(r)).join(i?.delimiter??" ")+a}var t8={}.constructor;function t9(e,t){return e.some(e=>"string"==typeof e?e===t:e.test(t))}function t7(e,t,r){return r.shouldRecurse?{shouldRecurse:r.shouldRecurse(e,t)}:void 0}var re=function(e,t){if(Array.isArray(e)){if(e.some(e=>e.constructor!==t8))throw Error("obj must be array of plain objects");let r=(t={deep:!0,exclude:[],parsingOptions:{},...t}).snakeCase||(e=>t4(e,t.parsingOptions));return e.map(e=>tX(e,(e,i)=>[t9(t.exclude,e)?e:r(e),i,t7(e,i,t)],t))}if(e.constructor!==t8)throw Error("obj must be an plain object");let r=(t={deep:!0,exclude:[],parsingOptions:{},...t}).snakeCase||(e=>t4(e,t.parsingOptions));return tX(e,(e,i)=>[t9(t.exclude,e)?e:r(e),i,t7(e,i,t)],t)},rt=class e{constructor(e,t,r,i){this.publishableKey=e,this.secretKey=t,this.claimUrl=r,this.apiKeysUrl=i}static fromJSON(t){return new e(t.publishable_key,t.secret_key,t.claim_url,t.api_keys_url)}},rr=class e{constructor(e,t,r,i,s,n,a,o){this.id=e,this.status=t,this.userId=r,this.actor=i,this.token=s,this.url=n,this.createdAt=a,this.updatedAt=o}static fromJSON(t){return new e(t.id,t.status,t.user_id,t.actor,t.token,t.url,t.created_at,t.updated_at)}},ri=class e{constructor(e,t,r,i,s,n,a){this.id=e,this.identifier=t,this.identifierType=r,this.createdAt=i,this.updatedAt=s,this.instanceId=n,this.invitationId=a}static fromJSON(t){return new e(t.id,t.identifier,t.identifier_type,t.created_at,t.updated_at,t.instance_id,t.invitation_id)}},rs=class e{constructor(e,t,r,i,s,n,a,o,d,l,h,c,u,p,f,m){this.id=e,this.type=t,this.name=r,this.subject=i,this.scopes=s,this.claims=n,this.revoked=a,this.revocationReason=o,this.expired=d,this.expiration=l,this.createdBy=h,this.description=c,this.lastUsedAt=u,this.createdAt=p,this.updatedAt=f,this.secret=m}static fromJSON(t){return new e(t.id,t.type,t.name,t.subject,t.scopes,t.claims,t.revoked,t.revocation_reason,t.expired,t.expiration,t.created_by,t.description,t.last_used_at,t.created_at,t.updated_at,t.secret)}},rn=class e{constructor(e,t,r,i,s,n){this.id=e,this.identifier=t,this.identifierType=r,this.createdAt=i,this.updatedAt=s,this.instanceId=n}static fromJSON(t){return new e(t.id,t.identifier,t.identifier_type,t.created_at,t.updated_at,t.instance_id)}},ra=class e{constructor(e,t,r,i,s,n,a,o){this.id=e,this.isMobile=t,this.ipAddress=r,this.city=i,this.country=s,this.browserVersion=n,this.browserName=a,this.deviceType=o}static fromJSON(t){return new e(t.id,t.is_mobile,t.ip_address,t.city,t.country,t.browser_version,t.browser_name,t.device_type)}},ro=class e{constructor(e,t,r,i,s,n,a,o,d,l,h,c=null){this.id=e,this.clientId=t,this.userId=r,this.status=i,this.lastActiveAt=s,this.expireAt=n,this.abandonAt=a,this.createdAt=o,this.updatedAt=d,this.lastActiveOrganizationId=l,this.latestActivity=h,this.actor=c}static fromJSON(t){return new e(t.id,t.client_id,t.user_id,t.status,t.last_active_at,t.expire_at,t.abandon_at,t.created_at,t.updated_at,t.last_active_organization_id,t.latest_activity&&ra.fromJSON(t.latest_activity),t.actor)}},rd=class e{constructor(e,t,r,i,s,n,a,o){this.id=e,this.sessionIds=t,this.sessions=r,this.signInId=i,this.signUpId=s,this.lastActiveSessionId=n,this.createdAt=a,this.updatedAt=o}static fromJSON(t){return new e(t.id,t.session_ids,t.sessions.map(e=>ro.fromJSON(e)),t.sign_in_id,t.sign_up_id,t.last_active_session_id,t.created_at,t.updated_at)}},rl=class e{constructor(e,t,r){this.host=e,this.value=t,this.required=r}static fromJSON(t){return new e(t.host,t.value,t.required)}},rh=class e{constructor(e){this.cookies=e}static fromJSON(t){return new e(t.cookies)}},rc=class e{constructor(e,t,r,i){this.object=e,this.id=t,this.slug=r,this.deleted=i}static fromJSON(t){return new e(t.object,t.id||null,t.slug||null,t.deleted)}},ru=class e{constructor(e,t,r,i,s,n,a,o){this.id=e,this.name=t,this.isSatellite=r,this.frontendApiUrl=i,this.developmentOrigin=s,this.cnameTargets=n,this.accountsPortalUrl=a,this.proxyUrl=o}static fromJSON(t){return new e(t.id,t.name,t.is_satellite,t.frontend_api_url,t.development_origin,t.cname_targets&&t.cname_targets.map(e=>rl.fromJSON(e)),t.accounts_portal_url,t.proxy_url)}},rp=class e{constructor(e,t,r,i,s,n,a,o,d,l,h){this.id=e,this.fromEmailName=t,this.emailAddressId=r,this.toEmailAddress=i,this.subject=s,this.body=n,this.bodyPlain=a,this.status=o,this.slug=d,this.data=l,this.deliveredByClerk=h}static fromJSON(t){return new e(t.id,t.from_email_name,t.email_address_id,t.to_email_address,t.subject,t.body,t.body_plain,t.status,t.slug,t.data,t.delivered_by_clerk)}},rf=class e{constructor(e,t){this.id=e,this.type=t}static fromJSON(t){return new e(t.id,t.type)}},rm=class e{constructor(e,t,r=null,i=null,s=null,n=null,a=null){this.status=e,this.strategy=t,this.externalVerificationRedirectURL=r,this.attempts=i,this.expireAt=s,this.nonce=n,this.message=a}static fromJSON(t){return new e(t.status,t.strategy,t.external_verification_redirect_url?new URL(t.external_verification_redirect_url):null,t.attempts,t.expire_at,t.nonce)}},ry=class e{constructor(e,t,r,i){this.id=e,this.emailAddress=t,this.verification=r,this.linkedTo=i}static fromJSON(t){return new e(t.id,t.email_address,t.verification&&rm.fromJSON(t.verification),t.linked_to.map(e=>rf.fromJSON(e)))}},rg=class e{constructor(e,t,r,i,s,n,a,o,d,l,h,c={},u,p){this.id=e,this.provider=t,this.identificationId=r,this.externalId=i,this.approvedScopes=s,this.emailAddress=n,this.firstName=a,this.lastName=o,this.imageUrl=d,this.username=l,this.phoneNumber=h,this.publicMetadata=c,this.label=u,this.verification=p}static fromJSON(t){return new e(t.id,t.provider,t.identification_id,t.provider_user_id,t.approved_scopes,t.email_address,t.first_name,t.last_name,t.image_url||"",t.username,t.phone_number,t.public_metadata,t.label,t.verification&&rm.fromJSON(t.verification))}},r_=class e{constructor(e,t,r,i,s,n,a,o,d,l,h){this.id=e,this.clientId=t,this.type=r,this.subject=i,this.scopes=s,this.revoked=n,this.revocationReason=a,this.expired=o,this.expiration=d,this.createdAt=l,this.updatedAt=h}static fromJSON(t){return new e(t.id,t.client_id,t.type,t.subject,t.scopes,t.revoked,t.revocation_reason,t.expired,t.expiration,t.created_at,t.updated_at)}},rw=class e{constructor(e,t,r){this.id=e,this.environmentType=t,this.allowedOrigins=r}static fromJSON(t){return new e(t.id,t.environment_type,t.allowed_origins)}},rk=class e{constructor(e,t,r,i,s){this.allowlist=e,this.blocklist=t,this.blockEmailSubaddresses=r,this.blockDisposableEmailDomains=i,this.ignoreDotsForGmailAddresses=s}static fromJSON(t){return new e(t.allowlist,t.blocklist,t.block_email_subaddresses,t.block_disposable_email_domains,t.ignore_dots_for_gmail_addresses)}},rv=class e{constructor(e,t,r,i,s){this.id=e,this.restrictedToAllowlist=t,this.fromEmailAddress=r,this.progressiveSignUp=i,this.enhancedEmailDeliverability=s}static fromJSON(t){return new e(t.id,t.restricted_to_allowlist,t.from_email_address,t.progressive_sign_up,t.enhanced_email_deliverability)}},rb=class e{constructor(e,t,r,i,s,n,a,o){this.id=e,this.emailAddress=t,this.publicMetadata=r,this.createdAt=i,this.updatedAt=s,this.status=n,this.url=a,this.revoked=o,this._raw=null}get raw(){return this._raw}static fromJSON(t){let r=new e(t.id,t.email_address,t.public_metadata,t.created_at,t.updated_at,t.status,t.url,t.revoked);return r._raw=t,r}},rS={AccountlessApplication:"accountless_application",ActorToken:"actor_token",AllowlistIdentifier:"allowlist_identifier",ApiKey:"api_key",BlocklistIdentifier:"blocklist_identifier",Client:"client",Cookies:"cookies",Domain:"domain",Email:"email",EmailAddress:"email_address",Instance:"instance",InstanceRestrictions:"instance_restrictions",InstanceSettings:"instance_settings",Invitation:"invitation",Machine:"machine",MachineToken:"machine_to_machine_token",JwtTemplate:"jwt_template",OauthAccessToken:"oauth_access_token",IdpOAuthAccessToken:"clerk_idp_oauth_access_token",OAuthApplication:"oauth_application",Organization:"organization",OrganizationInvitation:"organization_invitation",OrganizationMembership:"organization_membership",OrganizationSettings:"organization_settings",PhoneNumber:"phone_number",ProxyCheck:"proxy_check",RedirectUrl:"redirect_url",SamlConnection:"saml_connection",Session:"session",SignInToken:"sign_in_token",SignUpAttempt:"sign_up_attempt",SmsMessage:"sms_message",User:"user",WaitlistEntry:"waitlist_entry",Token:"token",TotalCount:"total_count"},rT=class e{constructor(e,t,r,i,s){this.id=e,this.name=t,this.instanceId=r,this.createdAt=i,this.updatedAt=s}static fromJSON(t){return new e(t.id,t.name,t.instance_id,t.created_at,t.updated_at)}},rE=class e{constructor(e,t,r,i,s,n,a,o,d,l,h,c,u){this.id=e,this.name=t,this.subject=r,this.scopes=i,this.claims=s,this.revoked=n,this.revocationReason=a,this.expired=o,this.expiration=d,this.createdBy=l,this.creationReason=h,this.createdAt=c,this.updatedAt=u}static fromJSON(t){return new e(t.id,t.name,t.subject,t.scopes,t.claims,t.revoked,t.revocation_reason,t.expired,t.expiration,t.created_by,t.creation_reason,t.created_at,t.updated_at)}},rA=class e{constructor(e,t,r,i,s,n,a,o,d){this.id=e,this.name=t,this.claims=r,this.lifetime=i,this.allowedClockSkew=s,this.customSigningKey=n,this.signingAlgorithm=a,this.createdAt=o,this.updatedAt=d}static fromJSON(t){return new e(t.id,t.name,t.claims,t.lifetime,t.allowed_clock_skew,t.custom_signing_key,t.signing_algorithm,t.created_at,t.updated_at)}},rI=class e{constructor(e,t,r,i={},s,n,a,o){this.externalAccountId=e,this.provider=t,this.token=r,this.publicMetadata=i,this.label=s,this.scopes=n,this.tokenSecret=a,this.expiresAt=o}static fromJSON(t){return new e(t.external_account_id,t.provider,t.token,t.public_metadata,t.label||"",t.scopes,t.token_secret,t.expires_at)}},rO=class e{constructor(e,t,r,i,s,n,a,o,d,l,h,c,u,p,f){this.id=e,this.instanceId=t,this.name=r,this.clientId=i,this.isPublic=s,this.scopes=n,this.redirectUris=a,this.authorizeUrl=o,this.tokenFetchUrl=d,this.userInfoUrl=l,this.discoveryUrl=h,this.tokenIntrospectionUrl=c,this.createdAt=u,this.updatedAt=p,this.clientSecret=f}static fromJSON(t){return new e(t.id,t.instance_id,t.name,t.client_id,t.public,t.scopes,t.redirect_uris,t.authorize_url,t.token_fetch_url,t.user_info_url,t.discovery_url,t.token_introspection_url,t.created_at,t.updated_at,t.client_secret)}},rC=class e{constructor(e,t,r,i,s,n,a,o={},d={},l,h,c,u){this.id=e,this.name=t,this.slug=r,this.imageUrl=i,this.hasImage=s,this.createdAt=n,this.updatedAt=a,this.publicMetadata=o,this.privateMetadata=d,this.maxAllowedMemberships=l,this.adminDeleteEnabled=h,this.membersCount=c,this.createdBy=u,this._raw=null}get raw(){return this._raw}static fromJSON(t){let r=new e(t.id,t.name,t.slug,t.image_url||"",t.has_image,t.created_at,t.updated_at,t.public_metadata,t.private_metadata,t.max_allowed_memberships,t.admin_delete_enabled,t.members_count,t.created_by);return r._raw=t,r}},rx=class e{constructor(e,t,r,i,s,n,a,o,d,l,h={},c={},u){this.id=e,this.emailAddress=t,this.role=r,this.roleName=i,this.organizationId=s,this.createdAt=n,this.updatedAt=a,this.expiresAt=o,this.url=d,this.status=l,this.publicMetadata=h,this.privateMetadata=c,this.publicOrganizationData=u,this._raw=null}get raw(){return this._raw}static fromJSON(t){let r=new e(t.id,t.email_address,t.role,t.role_name,t.organization_id,t.created_at,t.updated_at,t.expires_at,t.url,t.status,t.public_metadata,t.private_metadata,t.public_organization_data);return r._raw=t,r}},rP=class e{constructor(e,t,r,i={},s={},n,a,o,d){this.id=e,this.role=t,this.permissions=r,this.publicMetadata=i,this.privateMetadata=s,this.createdAt=n,this.updatedAt=a,this.organization=o,this.publicUserData=d,this._raw=null}get raw(){return this._raw}static fromJSON(t){let r=new e(t.id,t.role,t.permissions,t.public_metadata,t.private_metadata,t.created_at,t.updated_at,rC.fromJSON(t.organization),rN.fromJSON(t.public_user_data));return r._raw=t,r}},rN=class e{constructor(e,t,r,i,s,n){this.identifier=e,this.firstName=t,this.lastName=r,this.imageUrl=i,this.hasImage=s,this.userId=n}static fromJSON(t){return new e(t.identifier,t.first_name,t.last_name,t.image_url,t.has_image,t.user_id)}},rU=class e{constructor(e,t,r,i,s,n,a,o,d){this.enabled=e,this.maxAllowedMemberships=t,this.maxAllowedRoles=r,this.maxAllowedPermissions=i,this.creatorRole=s,this.adminDeleteEnabled=n,this.domainsEnabled=a,this.domainsEnrollmentModes=o,this.domainsDefaultRole=d}static fromJSON(t){return new e(t.enabled,t.max_allowed_memberships,t.max_allowed_roles,t.max_allowed_permissions,t.creator_role,t.admin_delete_enabled,t.domains_enabled,t.domains_enrollment_modes,t.domains_default_role)}},rR=class e{constructor(e,t,r,i,s,n){this.id=e,this.phoneNumber=t,this.reservedForSecondFactor=r,this.defaultSecondFactor=i,this.verification=s,this.linkedTo=n}static fromJSON(t){return new e(t.id,t.phone_number,t.reserved_for_second_factor,t.default_second_factor,t.verification&&rm.fromJSON(t.verification),t.linked_to.map(e=>rf.fromJSON(e)))}},rD=class e{constructor(e,t,r,i,s,n,a){this.id=e,this.domainId=t,this.lastRunAt=r,this.proxyUrl=i,this.successful=s,this.createdAt=n,this.updatedAt=a}static fromJSON(t){return new e(t.id,t.domain_id,t.last_run_at,t.proxy_url,t.successful,t.created_at,t.updated_at)}},rq=class e{constructor(e,t,r,i){this.id=e,this.url=t,this.createdAt=r,this.updatedAt=i}static fromJSON(t){return new e(t.id,t.url,t.created_at,t.updated_at)}},rL=class e{constructor(e,t,r,i,s,n,a,o,d,l,h,c,u,p,f,m,y,g,_,w,k){this.id=e,this.name=t,this.domain=r,this.organizationId=i,this.idpEntityId=s,this.idpSsoUrl=n,this.idpCertificate=a,this.idpMetadataUrl=o,this.idpMetadata=d,this.acsUrl=l,this.spEntityId=h,this.spMetadataUrl=c,this.active=u,this.provider=p,this.userCount=f,this.syncUserAttributes=m,this.allowSubdomains=y,this.allowIdpInitiated=g,this.createdAt=_,this.updatedAt=w,this.attributeMapping=k}static fromJSON(t){return new e(t.id,t.name,t.domain,t.organization_id,t.idp_entity_id,t.idp_sso_url,t.idp_certificate,t.idp_metadata_url,t.idp_metadata,t.acs_url,t.sp_entity_id,t.sp_metadata_url,t.active,t.provider,t.user_count,t.sync_user_attributes,t.allow_subdomains,t.allow_idp_initiated,t.created_at,t.updated_at,t.attribute_mapping&&r$.fromJSON(t.attribute_mapping))}},rM=class e{constructor(e,t,r,i,s,n,a,o,d,l){this.id=e,this.name=t,this.domain=r,this.active=i,this.provider=s,this.syncUserAttributes=n,this.allowSubdomains=a,this.allowIdpInitiated=o,this.createdAt=d,this.updatedAt=l}static fromJSON(t){return new e(t.id,t.name,t.domain,t.active,t.provider,t.sync_user_attributes,t.allow_subdomains,t.allow_idp_initiated,t.created_at,t.updated_at)}},r$=class e{constructor(e,t,r,i){this.userId=e,this.emailAddress=t,this.firstName=r,this.lastName=i}static fromJSON(t){return new e(t.user_id,t.email_address,t.first_name,t.last_name)}},rj=class e{constructor(e,t,r,i,s,n,a,o,d){this.id=e,this.provider=t,this.providerUserId=r,this.active=i,this.emailAddress=s,this.firstName=n,this.lastName=a,this.verification=o,this.samlConnection=d}static fromJSON(t){return new e(t.id,t.provider,t.provider_user_id,t.active,t.email_address,t.first_name,t.last_name,t.verification&&rm.fromJSON(t.verification),t.saml_connection&&rM.fromJSON(t.saml_connection))}},rJ=class e{constructor(e,t,r,i,s,n,a){this.id=e,this.userId=t,this.token=r,this.status=i,this.url=s,this.createdAt=n,this.updatedAt=a}static fromJSON(t){return new e(t.id,t.user_id,t.token,t.status,t.url,t.created_at,t.updated_at)}},rz=class e{constructor(e,t){this.nextAction=e,this.supportedStrategies=t}static fromJSON(t){return new e(t.next_action,t.supported_strategies)}},rH=class e{constructor(e,t,r,i){this.emailAddress=e,this.phoneNumber=t,this.web3Wallet=r,this.externalAccount=i}static fromJSON(t){return new e(t.email_address&&rz.fromJSON(t.email_address),t.phone_number&&rz.fromJSON(t.phone_number),t.web3_wallet&&rz.fromJSON(t.web3_wallet),t.external_account)}},rK=class e{constructor(e,t,r,i,s,n,a,o,d,l,h,c,u,p,f,m,y,g,_,w,k,v){this.id=e,this.status=t,this.requiredFields=r,this.optionalFields=i,this.missingFields=s,this.unverifiedFields=n,this.verifications=a,this.username=o,this.emailAddress=d,this.phoneNumber=l,this.web3Wallet=h,this.passwordEnabled=c,this.firstName=u,this.lastName=p,this.customAction=f,this.externalId=m,this.createdSessionId=y,this.createdUserId=g,this.abandonAt=_,this.legalAcceptedAt=w,this.publicMetadata=k,this.unsafeMetadata=v}static fromJSON(t){return new e(t.id,t.status,t.required_fields,t.optional_fields,t.missing_fields,t.unverified_fields,t.verifications?rH.fromJSON(t.verifications):null,t.username,t.email_address,t.phone_number,t.web3_wallet,t.password_enabled,t.first_name,t.last_name,t.custom_action,t.external_id,t.created_session_id,t.created_user_id,t.abandon_at,t.legal_accepted_at,t.public_metadata,t.unsafe_metadata)}},rW=class e{constructor(e,t,r,i,s,n,a){this.id=e,this.fromPhoneNumber=t,this.toPhoneNumber=r,this.message=i,this.status=s,this.phoneNumberId=n,this.data=a}static fromJSON(t){return new e(t.id,t.from_phone_number,t.to_phone_number,t.message,t.status,t.phone_number_id,t.data)}},rF=class e{constructor(e){this.jwt=e}static fromJSON(t){return new e(t.jwt)}},rB=class e{constructor(e,t,r){this.id=e,this.web3Wallet=t,this.verification=r}static fromJSON(t){return new e(t.id,t.web3_wallet,t.verification&&rm.fromJSON(t.verification))}},rG=class e{constructor(e,t,r,i,s,n,a,o,d,l,h,c,u,p,f,m,y,g,_,w={},k={},v={},b=[],S=[],T=[],E=[],A=[],I,O,C=null,x,P){this.id=e,this.passwordEnabled=t,this.totpEnabled=r,this.backupCodeEnabled=i,this.twoFactorEnabled=s,this.banned=n,this.locked=a,this.createdAt=o,this.updatedAt=d,this.imageUrl=l,this.hasImage=h,this.primaryEmailAddressId=c,this.primaryPhoneNumberId=u,this.primaryWeb3WalletId=p,this.lastSignInAt=f,this.externalId=m,this.username=y,this.firstName=g,this.lastName=_,this.publicMetadata=w,this.privateMetadata=k,this.unsafeMetadata=v,this.emailAddresses=b,this.phoneNumbers=S,this.web3Wallets=T,this.externalAccounts=E,this.samlAccounts=A,this.lastActiveAt=I,this.createOrganizationEnabled=O,this.createOrganizationsLimit=C,this.deleteSelfEnabled=x,this.legalAcceptedAt=P,this._raw=null}get raw(){return this._raw}static fromJSON(t){let r=new e(t.id,t.password_enabled,t.totp_enabled,t.backup_code_enabled,t.two_factor_enabled,t.banned,t.locked,t.created_at,t.updated_at,t.image_url,t.has_image,t.primary_email_address_id,t.primary_phone_number_id,t.primary_web3_wallet_id,t.last_sign_in_at,t.external_id,t.username,t.first_name,t.last_name,t.public_metadata,t.private_metadata,t.unsafe_metadata,(t.email_addresses||[]).map(e=>ry.fromJSON(e)),(t.phone_numbers||[]).map(e=>rR.fromJSON(e)),(t.web3_wallets||[]).map(e=>rB.fromJSON(e)),(t.external_accounts||[]).map(e=>rg.fromJSON(e)),(t.saml_accounts||[]).map(e=>rj.fromJSON(e)),t.last_active_at,t.create_organization_enabled,t.create_organizations_limit,t.delete_self_enabled,t.legal_accepted_at);return r._raw=t,r}get primaryEmailAddress(){return this.emailAddresses.find(({id:e})=>e===this.primaryEmailAddressId)??null}get primaryPhoneNumber(){return this.phoneNumbers.find(({id:e})=>e===this.primaryPhoneNumberId)??null}get primaryWeb3Wallet(){return this.web3Wallets.find(({id:e})=>e===this.primaryWeb3WalletId)??null}get fullName(){return[this.firstName,this.lastName].join(" ").trim()||null}},rV=class e{constructor(e,t,r,i,s,n,a){this.id=e,this.emailAddress=t,this.status=r,this.invitation=i,this.createdAt=s,this.updatedAt=n,this.isLocked=a}static fromJSON(t){return new e(t.id,t.email_address,t.status,t.invitation&&rb.fromJSON(t.invitation),t.created_at,t.updated_at,t.is_locked)}};function rY(e){if("string"!=typeof e&&"object"in e&&"deleted"in e)return rc.fromJSON(e);switch(e.object){case rS.AccountlessApplication:return rt.fromJSON(e);case rS.ActorToken:return rr.fromJSON(e);case rS.AllowlistIdentifier:return ri.fromJSON(e);case rS.ApiKey:return rs.fromJSON(e);case rS.BlocklistIdentifier:return rn.fromJSON(e);case rS.Client:return rd.fromJSON(e);case rS.Cookies:return rh.fromJSON(e);case rS.Domain:return ru.fromJSON(e);case rS.EmailAddress:return ry.fromJSON(e);case rS.Email:return rp.fromJSON(e);case rS.IdpOAuthAccessToken:return r_.fromJSON(e);case rS.Instance:return rw.fromJSON(e);case rS.InstanceRestrictions:return rk.fromJSON(e);case rS.InstanceSettings:return rv.fromJSON(e);case rS.Invitation:return rb.fromJSON(e);case rS.JwtTemplate:return rA.fromJSON(e);case rS.Machine:return rT.fromJSON(e);case rS.MachineToken:return rE.fromJSON(e);case rS.OauthAccessToken:return rI.fromJSON(e);case rS.OAuthApplication:return rO.fromJSON(e);case rS.Organization:return rC.fromJSON(e);case rS.OrganizationInvitation:return rx.fromJSON(e);case rS.OrganizationMembership:return rP.fromJSON(e);case rS.OrganizationSettings:return rU.fromJSON(e);case rS.PhoneNumber:return rR.fromJSON(e);case rS.ProxyCheck:return rD.fromJSON(e);case rS.RedirectUrl:return rq.fromJSON(e);case rS.SamlConnection:return rL.fromJSON(e);case rS.SignInToken:return rJ.fromJSON(e);case rS.SignUpAttempt:return rK.fromJSON(e);case rS.Session:return ro.fromJSON(e);case rS.SmsMessage:return rW.fromJSON(e);case rS.Token:return rF.fromJSON(e);case rS.TotalCount:return e.total_count;case rS.User:return rG.fromJSON(e);case rS.WaitlistEntry:return rV.fromJSON(e);default:return e}}function rQ(e){var t;return t=async t=>{let r,{secretKey:i,requireSecretKey:s=!0,apiUrl:n=eF,apiVersion:a="v1",userAgent:o=eB,skipApiVersionInUrl:d=!1}=e,{path:l,method:h,queryParams:c,headerParams:u,bodyParams:p,formData:f}=t;s&&e0(i);let m=new URL(d?e6(n,l):e6(n,a,l));if(c)for(let[e,t]of Object.entries(re({...c})))t&&[t].flat().forEach(t=>m.searchParams.append(e,t));let y=new Headers({"Clerk-API-Version":eG,"User-Agent":o,...u});i&&y.set("Authorization",`Bearer ${i}`);try{var g;f?r=await ed.fetch(m.href,{method:h,headers:y,body:f}):(y.set("Content-Type","application/json"),r=await ed.fetch(m.href,{method:h,headers:y,...(()=>{if(!("GET"!==h&&p&&Object.keys(p).length>0))return null;let e=e=>re(e,{deep:!1});return{body:JSON.stringify(Array.isArray(p)?p.map(e):e(p))}})()}));let e=r?.headers&&r.headers?.get(eQ.Headers.ContentType)===eQ.ContentTypes.Json,t=await (e?r.json():r.text());if(!r.ok)return{data:null,errors:r0(t),status:r?.status,statusText:r?.statusText,clerkTraceId:rX(t,r?.headers),retryAfter:rZ(r?.headers)};return{...Array.isArray(t)?{data:t.map(e=>rY(e))}:(g=t)&&"object"==typeof g&&"data"in g&&Array.isArray(g.data)&&void 0!==g.data?{data:t.data.map(e=>rY(e)),totalCount:t.total_count}:{data:rY(t)},errors:null}}catch(e){if(e instanceof Error)return{data:null,errors:[{code:"unexpected_error",message:e.message||"Unexpected error"}],clerkTraceId:rX(e,r?.headers)};return{data:null,errors:r0(e),status:r?.status,statusText:r?.statusText,clerkTraceId:rX(e,r?.headers),retryAfter:rZ(r?.headers)}}},async(...e)=>{let{data:r,errors:i,totalCount:s,status:n,statusText:a,clerkTraceId:o,retryAfter:d}=await t(...e);if(i){let e=new Q(a||"",{data:[],status:n,clerkTraceId:o,retryAfter:d});throw e.errors=i,e}return void 0!==s?{data:r,totalCount:s}:r}}function rX(e,t){return e&&"object"==typeof e&&"clerk_trace_id"in e&&"string"==typeof e.clerk_trace_id?e.clerk_trace_id:t?.get("cf-ray")||""}function rZ(e){let t=e?.get("Retry-After");if(!t)return;let r=parseInt(t,10);if(!isNaN(r))return r}function r0(e){if(e&&"object"==typeof e&&"errors"in e){let t=e.errors;return t.length>0?t.map(Y):[]}return[]}function r1(e){let t=rQ(e);return{__experimental_accountlessApplications:new e7(rQ({...e,requireSecretKey:!1})),actorTokens:new e8(t),allowlistIdentifiers:new tt(t),apiKeys:new ti(rQ({...e,skipApiVersionInUrl:!0})),betaFeatures:new ts(t),blocklistIdentifiers:new ta(t),clients:new td(t),domains:new th(t),emailAddresses:new tu(t),idPOAuthAccessToken:new tp(rQ({...e,skipApiVersionInUrl:!0})),instance:new tm(t),invitations:new tg(t),jwks:new tv(t),jwtTemplates:new tS(t),machines:new tw(t),machineTokens:new tk(rQ({...e,skipApiVersionInUrl:!0})),oauthApplications:new tI(t),organizations:new tE(t),phoneNumbers:new tC(t),proxyChecks:new tx(t),redirectUrls:new tN(t),samlConnections:new tR(t),sessions:new tq(t),signInTokens:new tM(t),signUps:new tj(t),testingTokens:new tJ(t),users:new tH(t),waitlistEntries:new tW(t),webhooks:new tB(t)}}var r2={SessionToken:"session_token",ApiKey:"api_key",MachineToken:"machine_token",OAuthToken:"oauth_token"},r5="oat_",r6=["mt_",r5,"ak_"];function r3(e){return r6.some(t=>e.startsWith(t))}function r4(e){if(e.startsWith("mt_"))return r2.MachineToken;if(e.startsWith(r5))return r2.OAuthToken;if(e.startsWith("ak_"))return r2.ApiKey;throw Error("Unknown machine token type")}var r8=(e,t)=>!!e&&("any"===t||(Array.isArray(t)?t:[t]).includes(e)),r9=e=>()=>{let t={...e};return t.secretKey=(t.secretKey||"").substring(0,7),t.jwtKey=(t.jwtKey||"").substring(0,7),{...t}};function r7(e,t){return{tokenType:r2.SessionToken,sessionClaims:null,sessionId:null,sessionStatus:t??null,userId:null,actor:null,orgId:null,orgRole:null,orgSlug:null,orgPermissions:null,factorVerificationAge:null,getToken:()=>Promise.resolve(null),has:()=>!1,debug:r9(e),isAuthenticated:!1}}var ie=e=>{let{fetcher:t,sessionToken:r,sessionId:i}=e||{};return async(e={})=>i?e.template||void 0!==e.expiresInSeconds?t(i,e.template,e.expiresInSeconds):r:null},it={SignedIn:"signed-in",SignedOut:"signed-out",Handshake:"handshake"},ir={ClientUATWithoutSessionToken:"client-uat-but-no-session-token",DevBrowserMissing:"dev-browser-missing",DevBrowserSync:"dev-browser-sync",PrimaryRespondsToSyncing:"primary-responds-to-syncing",PrimaryDomainCrossOriginSync:"primary-domain-cross-origin-sync",SatelliteCookieNeedsSyncing:"satellite-needs-syncing",SessionTokenAndUATMissing:"session-token-and-uat-missing",SessionTokenMissing:"session-token-missing",SessionTokenExpired:"session-token-expired",SessionTokenIATBeforeClientUAT:"session-token-iat-before-client-uat",SessionTokenNBF:"session-token-nbf",SessionTokenIatInTheFuture:"session-token-iat-in-the-future",SessionTokenWithoutClientUAT:"session-token-but-no-client-uat",ActiveOrganizationMismatch:"active-organization-mismatch",TokenTypeMismatch:"token-type-mismatch",UnexpectedError:"unexpected-error"};function ii(e){let{authenticateContext:t,headers:r=new Headers,token:i}=e;return{status:it.SignedIn,reason:null,message:null,proxyUrl:t.proxyUrl||"",publishableKey:t.publishableKey||"",isSatellite:t.isSatellite||!1,domain:t.domain||"",signInUrl:t.signInUrl||"",signUpUrl:t.signUpUrl||"",afterSignInUrl:t.afterSignInUrl||"",afterSignUpUrl:t.afterSignUpUrl||"",isSignedIn:!0,isAuthenticated:!0,tokenType:e.tokenType,toAuth:({treatPendingAsSignedOut:r=!0}={})=>{if(e.tokenType===r2.SessionToken){let{sessionClaims:s}=e,n=function(e,t,r){let{actor:i,sessionId:s,sessionStatus:n,userId:a,orgId:o,orgRole:d,orgSlug:l,orgPermissions:h,factorVerificationAge:c}=ez(r),u=r1(e),p=ie({sessionId:s,sessionToken:t,fetcher:async(e,t,r)=>(await u.sessions.getToken(e,t||"",r)).jwt});return{tokenType:r2.SessionToken,actor:i,sessionClaims:r,sessionId:s,sessionStatus:n,userId:a,orgId:o,orgRole:d,orgSlug:l,orgPermissions:h,factorVerificationAge:c,getToken:p,has:ej({orgId:o,orgRole:d,orgPermissions:h,userId:a,factorVerificationAge:c,features:r.fea||"",plans:r.pla||""}),debug:r9({...e,sessionToken:t}),isAuthenticated:!0}}(t,i,s);return r&&"pending"===n.sessionStatus?r7(void 0,n.sessionStatus):n}let{machineData:s}=e;var n=e.tokenType;let a={id:s.id,subject:s.subject,getToken:()=>Promise.resolve(i),has:()=>!1,debug:r9(t),isAuthenticated:!0};switch(n){case r2.ApiKey:return{...a,tokenType:n,name:s.name,claims:s.claims,scopes:s.scopes,userId:s.subject.startsWith("user_")?s.subject:null,orgId:s.subject.startsWith("org_")?s.subject:null};case r2.MachineToken:return{...a,tokenType:n,name:s.name,claims:s.claims,scopes:s.scopes,machineId:s.subject};case r2.OAuthToken:return{...a,tokenType:n,scopes:s.scopes,userId:s.subject,clientId:s.clientId};default:throw Error(`Invalid token type: ${n}`)}},headers:r,token:i}}function is(e){let{authenticateContext:t,headers:r=new Headers,reason:i,message:s="",tokenType:n}=e;return ia({status:it.SignedOut,reason:i,message:s,proxyUrl:t.proxyUrl||"",publishableKey:t.publishableKey||"",isSatellite:t.isSatellite||!1,domain:t.domain||"",signInUrl:t.signInUrl||"",signUpUrl:t.signUpUrl||"",afterSignInUrl:t.afterSignInUrl||"",afterSignUpUrl:t.afterSignUpUrl||"",isSignedIn:!1,isAuthenticated:!1,tokenType:n,toAuth:()=>n===r2.SessionToken?r7({...t,status:it.SignedOut,reason:i,message:s}):function(e,t){let r={id:null,subject:null,scopes:null,has:()=>!1,getToken:()=>Promise.resolve(null),debug:r9(t),isAuthenticated:!1};switch(e){case r2.ApiKey:return{...r,tokenType:e,name:null,claims:null,scopes:null,userId:null,orgId:null};case r2.MachineToken:return{...r,tokenType:e,name:null,claims:null,scopes:null,machineId:null};case r2.OAuthToken:return{...r,tokenType:e,scopes:null,userId:null,clientId:null};default:throw Error(`Invalid token type: ${e}`)}}(n,{reason:i,message:s,headers:r}),headers:r,token:null})}var ia=e=>{let t=new Headers(e.headers||{});if(e.message)try{t.set(eQ.Headers.AuthMessage,e.message)}catch{}if(e.reason)try{t.set(eQ.Headers.AuthReason,e.reason)}catch{}if(e.status)try{t.set(eQ.Headers.AuthStatus,e.status)}catch{}return e.headers=t,e},io=class extends URL{isCrossOrigin(e){return this.origin!==new URL(e.toString()).origin}},id=(...e)=>new io(...e),il=class extends Request{constructor(e,t){super("string"!=typeof e&&"url"in e?e.url:String(e),t||"string"==typeof e?void 0:e),this.clerkUrl=this.deriveUrlFromHeaders(this),this.cookies=this.parseCookies(this)}toJSON(){return{url:this.clerkUrl.href,method:this.method,headers:JSON.stringify(Object.fromEntries(this.headers)),clerkUrl:this.clerkUrl.toString(),cookies:JSON.stringify(Object.fromEntries(this.cookies))}}deriveUrlFromHeaders(e){let t=new URL(e.url),r=e.headers.get(eQ.Headers.ForwardedProto),i=e.headers.get(eQ.Headers.ForwardedHost),s=e.headers.get(eQ.Headers.Host),n=t.protocol,a=this.getFirstValueFromHeader(i)??s,o=this.getFirstValueFromHeader(r)??n?.replace(/[:/]/,""),d=a&&o?`${o}://${a}`:t.origin;return d===t.origin?id(t):id(t.pathname+t.search,d)}getFirstValueFromHeader(e){return e?.split(",")[0]}parseCookies(e){return new Map(Object.entries((0,eH.qg)(this.decodeCookieValue(e.headers.get("cookie")||""))))}decodeCookieValue(e){return e?e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent):e}},ih=(...e)=>e[0]instanceof il?e[0]:new il(...e),ic=e=>e.split(";")[0]?.split("=")[0],iu=e=>e.split(";")[0]?.split("=")[1],ip={},im=0;function iy(e,t=!0){ip[e.kid]=e,im=t?Date.now():-1}var ig="local";function i_(e){if(!ip[ig]){if(!e)throw new ei({action:er.SetClerkJWTKey,message:"Missing local JWK.",reason:et.LocalJWKMissing});iy({kid:"local",kty:"RSA",alg:"RS256",n:e.replace(/\r\n|\n|\r/g,"").replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace("MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA","").replace("IDAQAB","").replace(/\+/g,"-").replace(/\//g,"_"),e:"AQAB"},!1)}return ip[ig]}async function iw({secretKey:e,apiUrl:t=eF,apiVersion:r="v1",kid:i,skipJwksCache:s}){if(s||function(){if(-1===im)return!1;let e=Date.now()-im>=3e5;return e&&(ip={}),e}()||!ip[i]){if(!e)throw new ei({action:er.ContactSupport,message:"Failed to load JWKS from Clerk Backend or Frontend API.",reason:et.RemoteJWKFailedToLoad});let{keys:i}=await q(()=>ik(t,e,r));if(!i||!i.length)throw new ei({action:er.ContactSupport,message:"The JWKS endpoint did not contain any signing keys. Contact support@clerk.com.",reason:et.RemoteJWKFailedToLoad});i.forEach(e=>iy(e))}let n=ip[i];if(!n){let e=Object.values(ip).map(e=>e.kid).sort().join(", ");throw new ei({action:`Go to your Dashboard and validate your secret and public keys are correct. ${er.ContactSupport} if the issue persists.`,message:`Unable to find a signing key in JWKS that matches the kid='${i}' of the provided session token. Please make sure that the __session cookie or the HTTP authorization header contain a Clerk-generated session JWT. The following kid is available: ${e}`,reason:et.JWKKidMismatch})}return n}async function ik(e,t,r){if(!t)throw new ei({action:er.SetClerkSecretKey,message:"Missing Clerk Secret Key or API Key. Go to https://dashboard.clerk.com and get your key for your instance.",reason:et.RemoteJWKFailedToLoad});let i=new URL(e);i.pathname=e6(i.pathname,r,"/jwks");let s=await ed.fetch(i.href,{headers:{Authorization:`Bearer ${t}`,"Clerk-API-Version":eG,"Content-Type":"application/json","User-Agent":eB}});if(!s.ok){let e=await s.json(),t=iv(e?.errors,ee.InvalidSecretKey);if(t){let e=et.InvalidSecretKey;throw new ei({action:er.ContactSupport,message:t.message,reason:e})}throw new ei({action:er.ContactSupport,message:`Error loading Clerk JWKS from ${i.href} with code=${s.status}`,reason:et.RemoteJWKFailedToLoad})}return s.json()}var iv=(e,t)=>e?e.find(e=>e.code===t):null;async function ib(e,t){let{data:r,errors:i}=eE(e);if(i)return{errors:i};let{header:s}=r,{kid:n}=s;try{let r;if(t.jwtKey)r=i_(t.jwtKey);else{if(!t.secretKey)return{errors:[new ei({action:er.SetClerkJWTKey,message:"Failed to resolve JWK during verification.",reason:et.JWKFailedToResolve})]};r=await iw({...t,kid:n})}return await eA(e,{...t,key:r})}catch(e){return{errors:[e]}}}function iS(e,t,r){if("clerkError"in t){let i,s;switch(t.status){case 401:i=es.InvalidSecretKey,s=t.errors[0]?.message||"Invalid secret key";break;case 404:i=es.TokenInvalid,s=r;break;default:i=es.UnexpectedError,s="Unexpected error"}return{data:void 0,tokenType:e,errors:[new en({message:s,code:i,status:t.status})]}}return{data:void 0,tokenType:e,errors:[new en({message:"Unexpected error",code:es.UnexpectedError,status:t.status})]}}async function iT(e,t){try{let r=r1(t);return{data:await r.machineTokens.verifySecret(e),tokenType:r2.MachineToken,errors:void 0}}catch(e){return iS(r2.MachineToken,e,"Machine token not found")}}async function iE(e,t){try{let r=r1(t);return{data:await r.idPOAuthAccessToken.verifyAccessToken(e),tokenType:r2.OAuthToken,errors:void 0}}catch(e){return iS(r2.OAuthToken,e,"OAuth token not found")}}async function iA(e,t){try{let r=r1(t);return{data:await r.apiKeys.verifySecret(e),tokenType:r2.ApiKey,errors:void 0}}catch(e){return iS(r2.ApiKey,e,"API key not found")}}async function iI(e,t){if(e.startsWith("mt_"))return iT(e,t);if(e.startsWith(r5))return iE(e,t);if(e.startsWith("ak_"))return iA(e,t);throw Error("Unknown machine token type")}async function iO(e,{key:t}){let{data:r,errors:i}=eE(e);if(i)throw i[0];let{header:s,payload:n}=r,{typ:a,alg:o}=s;eg(a),e_(o);let{data:d,errors:l}=await eT(r,t);if(l)throw new ei({reason:et.TokenVerificationFailed,message:`Error verifying handshake token. ${l[0]}`});if(!d)throw new ei({reason:et.TokenInvalidSignature,message:"Handshake signature is invalid."});return n}async function iC(e,t){let r,{secretKey:i,apiUrl:s,apiVersion:n,jwksCacheTtlInMs:a,jwtKey:o,skipJwksCache:d}=t,{data:l,errors:h}=eE(e);if(h)throw h[0];let{kid:c}=l.header;if(o)r=i_(o);else if(i)r=await iw({secretKey:i,apiUrl:s,apiVersion:n,kid:c,jwksCacheTtlInMs:a,skipJwksCache:d});else throw new ei({action:er.SetClerkJWTKey,message:"Failed to resolve JWK during handshake verification.",reason:et.JWKFailedToResolve});return await iO(e,{key:r})}var ix=class{constructor(e,t,r){this.authenticateContext=e,this.options=t,this.organizationMatcher=r}isRequestEligibleForHandshake(){let{accept:e,secFetchDest:t}=this.authenticateContext;return!!("document"===t||"iframe"===t||!t&&e?.startsWith("text/html"))}buildRedirectToHandshake(e){if(!this.authenticateContext?.clerkUrl)throw Error("Missing clerkUrl in authenticateContext");let t=this.removeDevBrowserFromURL(this.authenticateContext.clerkUrl),r=this.authenticateContext.frontendApi.startsWith("http")?this.authenticateContext.frontendApi:`https://${this.authenticateContext.frontendApi}`,i=new URL("v1/client/handshake",r=r.replace(/\/+$/,"")+"/");i.searchParams.append("redirect_url",t?.href||""),i.searchParams.append("__clerk_api_version",eG),i.searchParams.append(eQ.QueryParameters.SuffixedCookies,this.authenticateContext.usesSuffixedCookies().toString()),i.searchParams.append(eQ.QueryParameters.HandshakeReason,e),i.searchParams.append(eQ.QueryParameters.HandshakeFormat,"nonce"),"development"===this.authenticateContext.instanceType&&this.authenticateContext.devBrowserToken&&i.searchParams.append(eQ.QueryParameters.DevBrowser,this.authenticateContext.devBrowserToken);let s=this.getOrganizationSyncTarget(this.authenticateContext.clerkUrl,this.organizationMatcher);return s&&this.getOrganizationSyncQueryParams(s).forEach((e,t)=>{i.searchParams.append(t,e)}),new Headers({[eQ.Headers.Location]:i.href})}async getCookiesFromHandshake(){let e=[];if(this.authenticateContext.handshakeNonce)try{let t=await this.authenticateContext.apiClient?.clients.getHandshakePayload({nonce:this.authenticateContext.handshakeNonce});t&&e.push(...t.directives)}catch(e){console.error("Clerk: HandshakeService: error getting handshake payload:",e)}else if(this.authenticateContext.handshakeToken){let t=await iC(this.authenticateContext.handshakeToken,this.authenticateContext);t&&Array.isArray(t.handshake)&&e.push(...t.handshake)}return e}async resolveHandshake(){let e=new Headers({"Access-Control-Allow-Origin":"null","Access-Control-Allow-Credentials":"true"}),t=await this.getCookiesFromHandshake(),r="";if(t.forEach(t=>{e.append("Set-Cookie",t),ic(t).startsWith(eQ.Cookies.Session)&&(r=iu(t))}),"development"===this.authenticateContext.instanceType){let t=new URL(this.authenticateContext.clerkUrl);t.searchParams.delete(eQ.QueryParameters.Handshake),t.searchParams.delete(eQ.QueryParameters.HandshakeHelp),e.append(eQ.Headers.Location,t.toString()),e.set(eQ.Headers.CacheControl,"no-store")}if(""===r)return is({tokenType:r2.SessionToken,authenticateContext:this.authenticateContext,reason:ir.SessionTokenMissing,message:"",headers:e});let{data:i,errors:[s]=[]}=await ib(r,this.authenticateContext);if(i)return ii({tokenType:r2.SessionToken,authenticateContext:this.authenticateContext,sessionClaims:i,headers:e,token:r});if("development"===this.authenticateContext.instanceType&&(s?.reason===et.TokenExpired||s?.reason===et.TokenNotActiveYet||s?.reason===et.TokenIatInTheFuture)){let t=new ei({action:s.action,message:s.message,reason:s.reason});t.tokenCarrier="cookie",console.error(`Clerk: Clock skew detected. This usually means that your system clock is inaccurate. Clerk will attempt to account for the clock skew in development.

To resolve this issue, make sure your system's clock is set to the correct time (e.g. turn off and on automatic time synchronization).

---

${t.getFullMessage()}`);let{data:i,errors:[n]=[]}=await ib(r,{...this.authenticateContext,clockSkewInMs:864e5});if(i)return ii({tokenType:r2.SessionToken,authenticateContext:this.authenticateContext,sessionClaims:i,headers:e,token:r});throw Error(n?.message||"Clerk: Handshake retry failed.")}throw Error(s?.message||"Clerk: Handshake failed.")}handleTokenVerificationErrorInDevelopment(e){if(e.reason===et.TokenInvalidSignature)throw Error("Clerk: Handshake token verification failed due to an invalid signature. If you have switched Clerk keys locally, clear your cookies and try again.");throw Error(`Clerk: Handshake token verification failed: ${e.getFullMessage()}.`)}checkAndTrackRedirectLoop(e){if(3===this.authenticateContext.handshakeRedirectLoopCounter)return!0;let t=this.authenticateContext.handshakeRedirectLoopCounter+1,r=eQ.Cookies.RedirectCount;return e.append("Set-Cookie",`${r}=${t}; SameSite=Lax; HttpOnly; Max-Age=3`),!1}removeDevBrowserFromURL(e){let t=new URL(e);return t.searchParams.delete(eQ.QueryParameters.DevBrowser),t.searchParams.delete(eQ.QueryParameters.LegacyDevBrowser),t}getOrganizationSyncTarget(e,t){return t.findTarget(e)}getOrganizationSyncQueryParams(e){let t=new Map;return"personalAccount"===e.type&&t.set("organization_id",""),"organization"===e.type&&(e.organizationId&&t.set("organization_id",e.organizationId),e.organizationSlug&&t.set("organization_id",e.organizationSlug)),t}},iP=class{constructor(e){this.organizationPattern=this.createMatcher(e?.organizationPatterns),this.personalAccountPattern=this.createMatcher(e?.personalAccountPatterns)}createMatcher(e){if(!e)return null;try{return function(e,t){try{var r,i,s,n,a,o,d;return r=void 0,i=[],s=function e(t,r,i){var s;return t instanceof RegExp?function(e,t){if(!t)return e;for(var r=/\((?:\?<(.*?)>)?(?!\?)/g,i=0,s=r.exec(e.source);s;)t.push({name:s[1]||i++,prefix:"",suffix:"",modifier:"",pattern:""}),s=r.exec(e.source);return e}(t,r):Array.isArray(t)?(s=t.map(function(t){return e(t,r,i).source}),new RegExp("(?:".concat(s.join("|"),")"),eW(i))):function(e,t,r){void 0===r&&(r={});for(var i=r.strict,s=void 0!==i&&i,n=r.start,a=r.end,o=r.encode,d=void 0===o?function(e){return e}:o,l=r.delimiter,h=r.endsWith,c="[".concat(eK(void 0===h?"":h),"]|$"),u="[".concat(eK(void 0===l?"/#?":l),"]"),p=void 0===n||n?"^":"",f=0;f<e.length;f++){var m=e[f];if("string"==typeof m)p+=eK(d(m));else{var y=eK(d(m.prefix)),g=eK(d(m.suffix));if(m.pattern)if(t&&t.push(m),y||g)if("+"===m.modifier||"*"===m.modifier){var _="*"===m.modifier?"?":"";p+="(?:".concat(y,"((?:").concat(m.pattern,")(?:").concat(g).concat(y,"(?:").concat(m.pattern,"))*)").concat(g,")").concat(_)}else p+="(?:".concat(y,"(").concat(m.pattern,")").concat(g,")").concat(m.modifier);else{if("+"===m.modifier||"*"===m.modifier)throw TypeError('Can not repeat "'.concat(m.name,'" without a prefix and suffix'));p+="(".concat(m.pattern,")").concat(m.modifier)}else p+="(?:".concat(y).concat(g,")").concat(m.modifier)}}if(void 0===a||a)s||(p+="".concat(u,"?")),p+=r.endsWith?"(?=".concat(c,")"):"$";else{var w=e[e.length-1],k="string"==typeof w?u.indexOf(w[w.length-1])>-1:void 0===w;s||(p+="(?:".concat(u,"(?=").concat(c,"))?")),k||(p+="(?=".concat(u,"|").concat(c,")"))}return new RegExp(p,eW(r))}(function(e,t){void 0===t&&(t={});for(var r=function(e){for(var t=[],r=0;r<e.length;){var i=e[r];if("*"===i||"+"===i||"?"===i){t.push({type:"MODIFIER",index:r,value:e[r++]});continue}if("\\"===i){t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});continue}if("{"===i){t.push({type:"OPEN",index:r,value:e[r++]});continue}if("}"===i){t.push({type:"CLOSE",index:r,value:e[r++]});continue}if(":"===i){for(var s="",n=r+1;n<e.length;){var a=e.charCodeAt(n);if(a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||95===a){s+=e[n++];continue}break}if(!s)throw TypeError("Missing parameter name at ".concat(r));t.push({type:"NAME",index:r,value:s}),r=n;continue}if("("===i){var o=1,d="",n=r+1;if("?"===e[n])throw TypeError('Pattern cannot start with "?" at '.concat(n));for(;n<e.length;){if("\\"===e[n]){d+=e[n++]+e[n++];continue}if(")"===e[n]){if(0==--o){n++;break}}else if("("===e[n]&&(o++,"?"!==e[n+1]))throw TypeError("Capturing groups are not allowed at ".concat(n));d+=e[n++]}if(o)throw TypeError("Unbalanced pattern at ".concat(r));if(!d)throw TypeError("Missing pattern at ".concat(r));t.push({type:"PATTERN",index:r,value:d}),r=n;continue}t.push({type:"CHAR",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}(e),i=t.prefixes,s=void 0===i?"./":i,n=t.delimiter,a=void 0===n?"/#?":n,o=[],d=0,l=0,h="",c=function(e){if(l<r.length&&r[l].type===e)return r[l++].value},u=function(e){var t=c(e);if(void 0!==t)return t;var i=r[l],s=i.type,n=i.index;throw TypeError("Unexpected ".concat(s," at ").concat(n,", expected ").concat(e))},p=function(){for(var e,t="";e=c("CHAR")||c("ESCAPED_CHAR");)t+=e;return t},f=function(e){for(var t=0;t<a.length;t++){var r=a[t];if(e.indexOf(r)>-1)return!0}return!1},m=function(e){var t=o[o.length-1],r=e||(t&&"string"==typeof t?t:"");if(t&&!r)throw TypeError('Must have text between two parameters, missing text after "'.concat(t.name,'"'));return!r||f(r)?"[^".concat(eK(a),"]+?"):"(?:(?!".concat(eK(r),")[^").concat(eK(a),"])+?")};l<r.length;){var y=c("CHAR"),g=c("NAME"),_=c("PATTERN");if(g||_){var w=y||"";-1===s.indexOf(w)&&(h+=w,w=""),h&&(o.push(h),h=""),o.push({name:g||d++,prefix:w,suffix:"",pattern:_||m(w),modifier:c("MODIFIER")||""});continue}var k=y||c("ESCAPED_CHAR");if(k){h+=k;continue}if(h&&(o.push(h),h=""),c("OPEN")){var w=p(),v=c("NAME")||"",b=c("PATTERN")||"",S=p();u("CLOSE"),o.push({name:v||(b?d++:""),pattern:v&&!b?m(w):b,prefix:w,suffix:S,modifier:c("MODIFIER")||""});continue}u("END")}return o}(t,i),r,i)}(e,i,r),n=i,a=r,void 0===a&&(a={}),o=a.decode,d=void 0===o?function(e){return e}:o,function(e){var t=s.exec(e);if(!t)return!1;for(var r=t[0],i=t.index,a=Object.create(null),o=1;o<t.length;o++)!function(e){if(void 0!==t[e]){var r=n[e-1];"*"===r.modifier||"+"===r.modifier?a[r.name]=t[e].split(r.prefix+r.suffix).map(function(e){return d(e,r)}):a[r.name]=d(t[e],r)}}(o);return{path:r,index:i,params:a}}}catch(e){throw Error(`Invalid path and options: Consult the documentation of path-to-regexp here: https://github.com/pillarjs/path-to-regexp/tree/6.x
${e.message}`)}}(e)}catch(t){throw Error(`Invalid pattern "${e}": ${t}`)}}findTarget(e){let t=this.findOrganizationTarget(e);return t||this.findPersonalAccountTarget(e)}findOrganizationTarget(e){if(!this.organizationPattern)return null;try{let t=this.organizationPattern(e.pathname);if(!t||!("params"in t))return null;let r=t.params;if(r.id)return{type:"organization",organizationId:r.id};if(r.slug)return{type:"organization",organizationSlug:r.slug};return null}catch(e){return console.error("Failed to match organization pattern:",e),null}}findPersonalAccountTarget(e){if(!this.personalAccountPattern)return null;try{return this.personalAccountPattern(e.pathname)?{type:"personalAccount"}:null}catch(e){return console.error("Failed to match personal account pattern:",e),null}}},iN={NonEligibleNoCookie:"non-eligible-no-refresh-cookie",NonEligibleNonGet:"non-eligible-non-get",InvalidSessionToken:"invalid-session-token",MissingApiClient:"missing-api-client",MissingSessionToken:"missing-session-token",MissingRefreshToken:"missing-refresh-token",ExpiredSessionTokenDecodeFailed:"expired-session-token-decode-failed",ExpiredSessionTokenMissingSidClaim:"expired-session-token-missing-sid-claim",FetchError:"fetch-error",UnexpectedSDKError:"unexpected-sdk-error",UnexpectedBAPIError:"unexpected-bapi-error"};function iU(e,t,r){return r8(e,t)?null:is({tokenType:e,authenticateContext:r,reason:ir.TokenTypeMismatch})}var iR=async(e,t)=>{let r=await e2(ih(e),t);e0(r.secretKey);let i=t.acceptsToken??r2.SessionToken;if(r.isSatellite&&(!function(e,t){if(!e&&(t.startsWith("test_")||t.startsWith("sk_test_")))throw Error("Missing signInUrl. Pass a signInUrl for dev instances if an app is satellite")}(r.signInUrl,r.secretKey),r.signInUrl&&r.origin&&function(e,t){let r;try{r=new URL(e)}catch{throw Error("The signInUrl needs to have a absolute url format.")}if(r.origin===t)throw Error("The signInUrl needs to be on a different origin than your satellite application.")}(r.signInUrl,r.origin),!(r.proxyUrl||r.domain)))throw Error("Missing domain and proxyUrl. A satellite application needs to specify a domain or a proxyUrl");let s=new iP(t.organizationSyncOptions),n=new ix(r,{organizationSyncOptions:t.organizationSyncOptions},s);async function a(r){if(!t.apiClient)return{data:null,error:{message:"An apiClient is needed to perform token refresh.",cause:{reason:iN.MissingApiClient}}};let{sessionToken:i,refreshTokenInCookie:s}=r;if(!i)return{data:null,error:{message:"Session token must be provided.",cause:{reason:iN.MissingSessionToken}}};if(!s)return{data:null,error:{message:"Refresh token must be provided.",cause:{reason:iN.MissingRefreshToken}}};let{data:n,errors:a}=eE(i);if(!n||a)return{data:null,error:{message:"Unable to decode the expired session token.",cause:{reason:iN.ExpiredSessionTokenDecodeFailed,errors:a}}};if(!n?.payload?.sid)return{data:null,error:{message:"Expired session token is missing the `sid` claim.",cause:{reason:iN.ExpiredSessionTokenMissingSidClaim}}};try{return{data:(await t.apiClient.sessions.refreshSession(n.payload.sid,{format:"cookie",suffixed_cookies:r.usesSuffixedCookies(),expired_token:i||"",refresh_token:s||"",request_origin:r.clerkUrl.origin,request_headers:Object.fromEntries(Array.from(e.headers.entries()).map(([e,t])=>[e,[t]]))})).cookies,error:null}}catch(e){if(!e?.errors?.length)return{data:null,error:{message:"Unexpected Server/BAPI error",cause:{reason:iN.UnexpectedBAPIError,errors:[e]}}};if("unexpected_error"===e.errors[0].code)return{data:null,error:{message:"Fetch unexpected error",cause:{reason:iN.FetchError,errors:e.errors}}};return{data:null,error:{message:e.errors[0].code,cause:{reason:e.errors[0].code,errors:e.errors}}}}}async function o(e){let{data:t,error:r}=await a(e);if(!t||0===t.length)return{data:null,error:r};let i=new Headers,s="";t.forEach(e=>{i.append("Set-Cookie",e),ic(e).startsWith(eQ.Cookies.Session)&&(s=iu(e))});let{data:n,errors:o}=await ib(s,e);return o?{data:null,error:{message:"Clerk: unable to verify refreshed session token.",cause:{reason:iN.InvalidSessionToken,errors:o}}}:{data:{jwtPayload:n,sessionToken:s,headers:i},error:null}}function d(e,t,r,i){if(!n.isRequestEligibleForHandshake())return is({tokenType:r2.SessionToken,authenticateContext:e,reason:t,message:r});let s=i??n.buildRedirectToHandshake(t);return(s.get(eQ.Headers.Location)&&s.set(eQ.Headers.CacheControl,"no-store"),n.checkAndTrackRedirectLoop(s))?(console.log("Clerk: Refreshing the session token resulted in an infinite redirect loop. This usually means that your Clerk instance keys do not match - make sure to copy the correct publishable and secret keys from the Clerk dashboard."),is({tokenType:r2.SessionToken,authenticateContext:e,reason:t,message:r})):function(e,t,r="",i){return ia({status:it.Handshake,reason:t,message:r,publishableKey:e.publishableKey||"",isSatellite:e.isSatellite||!1,domain:e.domain||"",proxyUrl:e.proxyUrl||"",signInUrl:e.signInUrl||"",signUpUrl:e.signUpUrl||"",afterSignInUrl:e.afterSignInUrl||"",afterSignUpUrl:e.afterSignUpUrl||"",isSignedIn:!1,isAuthenticated:!1,tokenType:r2.SessionToken,toAuth:()=>null,headers:i,token:null})}(e,t,r,s)}async function l(){let{tokenInHeader:e}=r;try{let{data:t,errors:i}=await ib(e,r);if(i)throw i[0];return ii({tokenType:r2.SessionToken,authenticateContext:r,sessionClaims:t,headers:new Headers,token:e})}catch(e){return c(e,"header")}}async function h(){let e=r.clientUat,t=!!r.sessionTokenInCookie,i=!!r.devBrowserToken;if(r.handshakeNonce||r.handshakeToken)try{return await n.resolveHandshake()}catch(e){e instanceof ei&&"development"===r.instanceType?n.handleTokenVerificationErrorInDevelopment(e):console.error("Clerk: unable to resolve handshake:",e)}if("development"===r.instanceType&&r.clerkUrl.searchParams.has(eQ.QueryParameters.DevBrowser))return d(r,ir.DevBrowserSync,"");let a=r.isSatellite&&"document"===r.secFetchDest;if("production"===r.instanceType&&a)return d(r,ir.SatelliteCookieNeedsSyncing,"");if("development"===r.instanceType&&a&&!r.clerkUrl.searchParams.has(eQ.QueryParameters.ClerkSynced)){let e=new URL(r.signInUrl);e.searchParams.append(eQ.QueryParameters.ClerkRedirectUrl,r.clerkUrl.toString());let t=new Headers({[eQ.Headers.Location]:e.toString()});return d(r,ir.SatelliteCookieNeedsSyncing,"",t)}let o=new URL(r.clerkUrl).searchParams.get(eQ.QueryParameters.ClerkRedirectUrl);if("development"===r.instanceType&&!r.isSatellite&&o){let e=new URL(o);r.devBrowserToken&&e.searchParams.append(eQ.QueryParameters.DevBrowser,r.devBrowserToken),e.searchParams.append(eQ.QueryParameters.ClerkSynced,"true");let t=new Headers({[eQ.Headers.Location]:e.toString()});return d(r,ir.PrimaryRespondsToSyncing,"",t)}if("development"===r.instanceType&&!i)return d(r,ir.DevBrowserMissing,"");if(!e&&!t)return is({tokenType:r2.SessionToken,authenticateContext:r,reason:ir.SessionTokenAndUATMissing});if(!e&&t)return d(r,ir.SessionTokenWithoutClientUAT,"");if(e&&!t)return d(r,ir.ClientUATWithoutSessionToken,"");let{data:l,errors:h}=eE(r.sessionTokenInCookie);if(h)return c(h[0],"cookie");if(l.payload.iat<r.clientUat)return d(r,ir.SessionTokenIATBeforeClientUAT,"");try{let{data:e,errors:t}=await ib(r.sessionTokenInCookie,r);if(t)throw t[0];let i=ii({tokenType:r2.SessionToken,authenticateContext:r,sessionClaims:e,headers:new Headers,token:r.sessionTokenInCookie});if(!r.isSatellite&&"document"===r.secFetchDest&&r.isCrossOriginReferrer())return d(r,ir.PrimaryDomainCrossOriginSync,"Cross-origin request from satellite domain requires handshake");let n=i.toAuth();if(n.userId){let e=function(e,t){let r=s.findTarget(e.clerkUrl);if(!r)return null;let i=!1;if("organization"===r.type&&(r.organizationSlug&&r.organizationSlug!==t.orgSlug&&(i=!0),r.organizationId&&r.organizationId!==t.orgId&&(i=!0)),"personalAccount"===r.type&&t.orgId&&(i=!0),!i)return null;if(e.handshakeRedirectLoopCounter>0)return console.warn("Clerk: Organization activation handshake loop detected. This is likely due to an invalid organization ID or slug. Skipping organization activation."),null;let n=d(e,ir.ActiveOrganizationMismatch,"");return"handshake"!==n.status?null:n}(r,n);if(e)return e}return i}catch(e){return c(e,"cookie")}}async function c(t,i){let s;if(!(t instanceof ei))return is({tokenType:r2.SessionToken,authenticateContext:r,reason:ir.UnexpectedError});if(t.reason===et.TokenExpired&&r.refreshTokenInCookie&&"GET"===e.method){let{data:e,error:t}=await o(r);if(e)return ii({tokenType:r2.SessionToken,authenticateContext:r,sessionClaims:e.jwtPayload,headers:e.headers,token:e.sessionToken});s=t?.cause?.reason?t.cause.reason:iN.UnexpectedSDKError}else s="GET"!==e.method?iN.NonEligibleNonGet:r.refreshTokenInCookie?null:iN.NonEligibleNoCookie;return(t.tokenCarrier=i,[et.TokenExpired,et.TokenNotActiveYet,et.TokenIatInTheFuture].includes(t.reason))?d(r,iq({tokenError:t.reason,refreshError:s}),t.getFullMessage()):is({tokenType:r2.SessionToken,authenticateContext:r,reason:t.reason,message:t.getFullMessage()})}function u(e,t){return t instanceof en?is({tokenType:e,authenticateContext:r,reason:t.code,message:t.getFullMessage()}):is({tokenType:e,authenticateContext:r,reason:ir.UnexpectedError})}async function p(){let{tokenInHeader:e}=r;if(!e)return c(Error("Missing token in header"),"header");if(!r3(e))return is({tokenType:i,authenticateContext:r,reason:ir.TokenTypeMismatch,message:""});let t=iU(r4(e),i,r);if(t)return t;let{data:s,tokenType:n,errors:a}=await iI(e,r);return a?u(n,a[0]):ii({tokenType:n,authenticateContext:r,machineData:s,token:e})}async function f(){let{tokenInHeader:e}=r;if(!e)return c(Error("Missing token in header"),"header");if(r3(e)){let t=iU(r4(e),i,r);if(t)return t;let{data:s,tokenType:n,errors:a}=await iI(e,r);return a?u(n,a[0]):ii({tokenType:n,authenticateContext:r,machineData:s,token:e})}let{data:t,errors:s}=await ib(e,r);return s?c(s[0],"header"):ii({tokenType:r2.SessionToken,authenticateContext:r,sessionClaims:t,token:e})}return Array.isArray(i)&&!function(e,t){let r=null,{tokenInHeader:i}=t;return i&&(r=r3(i)?r4(i):r2.SessionToken),r8(r??r2.SessionToken,e)}(i,r)?function(){let e={isAuthenticated:!1,tokenType:null,getToken:()=>Promise.resolve(null),has:()=>!1,debug:()=>({})};return ia({status:it.SignedOut,reason:ir.TokenTypeMismatch,message:"",proxyUrl:"",publishableKey:"",isSatellite:!1,domain:"",signInUrl:"",signUpUrl:"",afterSignInUrl:"",afterSignUpUrl:"",isSignedIn:!1,isAuthenticated:!1,tokenType:null,toAuth:()=>e,headers:new Headers,token:null})}():r.tokenInHeader?"any"===i?f():i===r2.SessionToken?l():p():i===r2.OAuthToken||i===r2.ApiKey||i===r2.MachineToken?is({tokenType:i,authenticateContext:r,reason:"No token in header"}):h()},iD=e=>{let{isSignedIn:t,isAuthenticated:r,proxyUrl:i,reason:s,message:n,publishableKey:a,isSatellite:o,domain:d}=e;return{isSignedIn:t,isAuthenticated:r,proxyUrl:i,reason:s,message:n,publishableKey:a,isSatellite:o,domain:d}},iq=({tokenError:e,refreshError:t})=>{switch(e){case et.TokenExpired:return`${ir.SessionTokenExpired}-refresh-${t}`;case et.TokenNotActiveYet:return ir.SessionTokenNBF;case et.TokenIatInTheFuture:return ir.SessionTokenIatInTheFuture;default:return ir.UnexpectedError}},iL={secretKey:"",jwtKey:"",apiUrl:void 0,apiVersion:void 0,proxyUrl:"",publishableKey:"",isSatellite:!1,domain:"",audience:""},iM=e=>{let t=r=>{if(!r)return r;if(Array.isArray(r))return r.map(e=>"object"==typeof e||Array.isArray(e)?t(e):e);let i={...r};for(let r of Object.keys(i)){let s=e(r.toString());s!==r&&(i[s]=i[r],delete i[r]),"object"==typeof i[s]&&(i[s]=t(i[s]))}return i};return t};function i$(e){if("boolean"==typeof e)return e;if(null==e)return!1;if("string"==typeof e){if("true"===e.toLowerCase())return!0;if("false"===e.toLowerCase())return!1}let t=parseInt(e,10);return!isNaN(t)&&t>0}iM(function(e){return e?e.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`):""}),iM(function(e){return e?e.replace(/([-_][a-z])/g,e=>e.toUpperCase().replace(/-|_/,"")):""});var ij=class{constructor(){C(this,n),C(this,i,"clerk_telemetry_throttler"),C(this,s,864e5)}isEventThrottled(e){if(!O(this,n,d))return!1;let t=Date.now(),r=P(this,n,a).call(this,e),l=O(this,n,o)?.[r];if(!l){let e={...O(this,n,o),[r]:t};localStorage.setItem(O(this,i),JSON.stringify(e))}if(l&&t-l>O(this,s)){let e=O(this,n,o);delete e[r],localStorage.setItem(O(this,i),JSON.stringify(e))}return!!l}};i=new WeakMap,s=new WeakMap,n=new WeakSet,a=function(e){let{sk:t,pk:r,payload:i,...s}=e,n={...i,...s};return JSON.stringify(Object.keys({...i,...s}).sort().map(e=>n[e]))},o=function(){let e=localStorage.getItem(O(this,i));return e?JSON.parse(e):{}},d=function(){if("undefined"==typeof window)return!1;let e=window.localStorage;if(!e)return!1;try{let t="test";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&("QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e.length>0&&e.removeItem(O(this,i)),!1}};var iJ={samplingRate:1,maxBufferSize:5,endpoint:"https://clerk-telemetry.com"},iz=class{constructor(e){C(this,f),C(this,l),C(this,h),C(this,c,{}),C(this,u,[]),C(this,p),x(this,l,{maxBufferSize:e.maxBufferSize??iJ.maxBufferSize,samplingRate:e.samplingRate??iJ.samplingRate,disabled:e.disabled??!1,debug:e.debug??!1,endpoint:iJ.endpoint}),e.clerkVersion||"undefined"!=typeof window?O(this,c).clerkVersion=e.clerkVersion??"":O(this,c).clerkVersion="",O(this,c).sdk=e.sdk,O(this,c).sdkVersion=e.sdkVersion,O(this,c).publishableKey=e.publishableKey??"";let t=z(e.publishableKey);t&&(O(this,c).instanceType=t.instanceType),e.secretKey&&(O(this,c).secretKey=e.secretKey.substring(0,16)),x(this,h,new ij)}get isEnabled(){return!("development"!==O(this,c).instanceType||O(this,l).disabled||"undefined"!=typeof process&&process.env&&i$(process.env.CLERK_TELEMETRY_DISABLED)||"undefined"!=typeof window&&window?.navigator?.webdriver)}get isDebug(){return O(this,l).debug||"undefined"!=typeof process&&process.env&&i$(process.env.CLERK_TELEMETRY_DEBUG)}record(e){let t=P(this,f,v).call(this,e.event,e.payload);P(this,f,w).call(this,t.event,t),P(this,f,m).call(this,t,e.eventSamplingRate)&&(O(this,u).push(t),P(this,f,g).call(this))}};l=new WeakMap,h=new WeakMap,c=new WeakMap,u=new WeakMap,p=new WeakMap,f=new WeakSet,m=function(e,t){return this.isEnabled&&!this.isDebug&&P(this,f,y).call(this,e,t)},y=function(e,t){let r=Math.random();return!!(r<=O(this,l).samplingRate&&(void 0===t||r<=t))&&!O(this,h).isEventThrottled(e)},g=function(){if("undefined"==typeof window)return void P(this,f,_).call(this);if(O(this,u).length>=O(this,l).maxBufferSize){O(this,p)&&("undefined"!=typeof cancelIdleCallback?cancelIdleCallback:clearTimeout)(O(this,p)),P(this,f,_).call(this);return}O(this,p)||("requestIdleCallback"in window?x(this,p,requestIdleCallback(()=>{P(this,f,_).call(this)})):x(this,p,setTimeout(()=>{P(this,f,_).call(this)},0)))},_=function(){fetch(new URL("/v1/event",O(this,l).endpoint),{method:"POST",body:JSON.stringify({events:O(this,u)}),headers:{"Content-Type":"application/json"}}).catch(()=>void 0).then(()=>{x(this,u,[])}).catch(()=>void 0)},w=function(e,t){this.isDebug&&(void 0!==console.groupCollapsed?(console.groupCollapsed("[clerk/telemetry]",e),console.log(t),console.groupEnd()):console.log("[clerk/telemetry]",e,t))},k=function(){let e={name:O(this,c).sdk,version:O(this,c).sdkVersion};if("undefined"!=typeof window){let t=window;if(t.Clerk){let r=t.Clerk;if("object"==typeof r&&null!==r&&"constructor"in r&&"object"==typeof r.constructor&&null!==r.constructor&&r.constructor.sdkMetadata){let{name:t,version:i}=r.constructor.sdkMetadata;void 0!==t&&(e.name=t),void 0!==i&&(e.version=i)}}}return e},v=function(e,t){let r=P(this,f,k).call(this);return{event:e,cv:O(this,c).clerkVersion??"",it:O(this,c).instanceType??"",sdk:r.name,sdkv:r.version,...O(this,c).publishableKey?{pk:O(this,c).publishableKey}:{},...O(this,c).secretKey?{sk:O(this,c).secretKey}:{},payload:t}};function iH(e){let t={...e},r=r1(t),i=function(e){let t=eZ(iL,e.options),r=e.apiClient;return{authenticateRequest:(e,i={})=>{let{apiUrl:s,apiVersion:n}=t,a=eZ(t,i);return iR(e,{...i,...a,apiUrl:s,apiVersion:n,apiClient:r})},debugRequestState:iD}}({options:t,apiClient:r}),s=new iz({...e.telemetry,publishableKey:t.publishableKey,secretKey:t.secretKey,samplingRate:.1,...t.sdkMetadata?{sdk:t.sdkMetadata.name,sdkVersion:t.sdkMetadata.version}:{}});return{...r,...i,telemetry:s}}},63800:(e,t)=>{"use strict";t.qg=function(e,t){let a=new r,o=e.length;if(o<2)return a;let d=t?.decode||n,l=0;do{let t=e.indexOf("=",l);if(-1===t)break;let r=e.indexOf(";",l),n=-1===r?o:r;if(t>n){l=e.lastIndexOf(";",t-1)+1;continue}let h=i(e,l,t),c=s(e,t,h),u=e.slice(h,c);if(void 0===a[u]){let r=i(e,t+1,n),o=s(e,n,r),l=d(e.slice(r,o));a[u]=l}l=n+1}while(l<o);return a},Object.prototype.toString;let r=(()=>{let e=function(){};return e.prototype=Object.create(null),e})();function i(e,t,r){do{let r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<r);return r}function s(e,t,r){for(;t>r;){let r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return r}function n(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},75993:(e,t,r)=>{"use strict";r.d(t,{B:()=>tq});var i=Object.defineProperty,s="@liveblocks/core",n="3.2.1",a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function o(e){console.error(e)}function d(e,t,r){let i=Symbol.for(e),d=r?`${t||"dev"} (${r})`:t||"dev";a[i]?a[i]===d||o(`Multiple copies of Liveblocks are being loaded in your project. This will cause issues! See https://liveblocks.io/docs/errors/dupes 

Conflicts:
- ${e} ${a[i]} (already loaded)
- ${e} ${d} (trying to load this now)`):a[i]=d,t&&n&&t!==n&&o(`Cross-linked versions of Liveblocks found, which will cause issues! See https://liveblocks.io/docs/errors/cross-linked 

Conflicts:
- ${s} is at ${n}
- ${e} is at ${t}

Always upgrade all Liveblocks packages to the same version number.`)}function l(e){let t=e.editedAt?new Date(e.editedAt):void 0,r=new Date(e.createdAt),i=e.reactions.map(e=>({...e,createdAt:new Date(e.createdAt)}));if(e.body)return{...e,reactions:i,createdAt:r,editedAt:t};{let s=new Date(e.deletedAt);return{...e,reactions:i,createdAt:r,editedAt:t,deletedAt:s}}}function h(e){let t=new Date(e.createdAt),r=new Date(e.updatedAt),i=e.comments.map(e=>l(e));return{...e,createdAt:t,updatedAt:r,comments:i}}function c(e){let t=new Date(e.notifiedAt),r=e.readAt?new Date(e.readAt):null;if("activities"in e){let i=e.activities.map(e=>({...e,createdAt:new Date(e.createdAt)}));return{...e,notifiedAt:t,readAt:r,activities:i}}return{...e,notifiedAt:t,readAt:r}}function u(e){let t=new Date(e.createdAt);return{...e,createdAt:t}}((e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})})({},{error:()=>y,errorWithTitle:()=>w,warn:()=>m,warnWithTitle:()=>_});var p="background:#0e0d12;border-radius:9999px;color:#fff;padding:3px 7px;font-family:sans-serif;font-weight:600;";function f(e){return"undefined"==typeof window?console[e]:(t,...r)=>console[e]("%cLiveblocks",p,t,...r)}var m=f("warn"),y=f("error");function g(e){return"undefined"==typeof window?console[e]:(t,r,...i)=>console[e](`%cLiveblocks%c ${t}`,p,"font-weight:600",r,...i)}var _=g("warn"),w=g("error");function k(e){return null!=e}function v(e){return null!==e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)}function b(e){return v(e)&&"string"==typeof e.startsWith}function S(e){throw Error(e)}function T(e){return Object.entries(e)}function E(e){try{return JSON.parse(e)}catch(e){return}}function A(e){return JSON.parse(JSON.stringify(e))}function I(e){let t={...e};return Object.keys(e).forEach(e=>{void 0===t[e]&&delete t[e]}),t}async function O(e,t,r){let i;return Promise.race([e,new Promise((e,s)=>{i=setTimeout(()=>{s(Error(r))},t)})]).finally(()=>clearTimeout(i))}var C=class e extends Error{response;details;constructor(e,t,r){super(e),this.name="HttpError",this.response=t,this.details=r}static async fromResponse(t){let r,i,s;try{r=await t.text()}catch{}let n=r?E(r):void 0;v(n)&&(i=n);let a="";a||="string"==typeof i?.message?i.message:"",a||="string"==typeof i?.error?i.error:"",void 0===n&&(a||=r||""),a||=t.statusText;try{s=new URL(t.url).pathname}catch{}return new e(a+=void 0!==s?` (got status ${t.status} from ${s})`:` (got status ${t.status})`,t,i)}get status(){return this.response.status}},x=e=>e instanceof C&&e.status>=400&&e.status<500;function P(){let e,t;return[new Promise((r,i)=>{e=r,t=i}),e,t]}function N(){let e=new Set;function t(t){return e.add(t),()=>e.delete(t)}function r(e){let r=t(t=>(r(),e(t)));return r}async function i(e){let r;return new Promise(i=>{r=t(t=>{(void 0===e||e(t))&&i(t)})}).finally(()=>r?.())}return{notify:function(t){let r=!1;for(let i of e)i(t),r=!0;return r},subscribe:t,subscribeOnce:r,count:function(){return e.size},waitUntil:i,dispose(){e.clear()},observable:{subscribe:t,subscribeOnce:r,waitUntil:i}}}var U=e=>e,R=Symbol("kSinks"),D=Symbol("kTrigger"),q=null,L=null;function M(e){if(null!==q)return void e();q=new Set;try{e()}finally{for(let e of q)e[D]();q=null}}function $(e){q||S("Expected to be in an active batch"),q.add(e)}function j(e,t){let r=!1,i={...e};return Object.keys(t).forEach(e=>{let s=t[e];i[e]!==s&&(void 0===s?delete i[e]:i[e]=s,r=!0)}),r?i:e}var J=class{equals;#e;[R];constructor(e){this.equals=e??Object.is,this.#e=N(),this[R]=new Set,this.get=this.get.bind(this),this.subscribe=this.subscribe.bind(this),this.subscribeOnce=this.subscribeOnce.bind(this)}dispose(){this.#e.dispose(),this.#e="(disposed)",this.equals="(disposed)"}get hasWatchers(){if(this.#e.count()>0)return!0;for(let e of this[R])if(e.hasWatchers)return!0;return!1}[D](){for(let e of(this.#e.notify(),this[R]))$(e)}subscribe(e){return 0===this.#e.count()&&this.get(),this.#e.subscribe(e)}subscribeOnce(e){let t=this.subscribe(()=>(t(),e()));return t}waitUntil(){throw Error("waitUntil not supported on Signals")}markSinksDirty(){for(let e of this[R])e.markDirty()}addSink(e){this[R].add(e)}removeSink(e){this[R].delete(e)}asReadonly(){return this}},z=class extends J{#t;constructor(e,t){super(t),this.#t=U(e)}dispose(){super.dispose(),this.#t="(disposed)"}get(){return L?.add(this),this.#t}set(e){M(()=>{"function"==typeof e&&(e=e(this.#t)),this.equals(this.#t,e)||(this.#t=U(e),this.markSinksDirty(),$(this))})}},H=Symbol(),K=class e extends J{#r;#i;#s;#n;#a;static from(...t){let r=t.pop();if("function"!=typeof r&&S("Invalid .from() call, last argument expected to be a function"),"function"!=typeof t[t.length-1])return new e(t,r);{let i=t.pop();return new e(t,i,r)}}constructor(e,t,r){super(r),this.#i=!0,this.#r=H,this.#n=e,this.#s=new Set,this.#a=t}dispose(){for(let e of this.#s)e.removeSink(this);this.#r="(disposed)",this.#s="(disposed)",this.#n="(disposed)",this.#a="(disposed)"}get isDirty(){return this.#i}#o(){let e,t=L;L=new Set;try{e=this.#a(...this.#n.map(e=>e.get()))}finally{let e=this.#s;for(let t of(this.#s=new Set,L))this.#s.add(t),e.delete(t);for(let t of e)t.removeSink(this);for(let e of this.#s)e.addSink(this);L=t}return this.#i=!1,!this.equals(this.#r,e)&&(this.#r=e,!0)}markDirty(){this.#i||(this.#i=!0,this.markSinksDirty())}get(){return this.#i&&this.#o(),L?.add(this),this.#r}[D](){this.hasWatchers&&this.#o()&&super[D]()}},W=class extends J{#d;constructor(e){super(),this.#d=e}dispose(){super.dispose(),this.#d="(disposed)"}get(){return L?.add(this),this.#d}mutate(e){M(()=>{let t=!e||e(this.#d);null!==t&&"object"==typeof t&&"then"in t&&S("MutableSignal.mutate() does not support async callbacks"),!1!==t&&(this.markSinksDirty(),$(this))})}};function F(e,t){return null===t||"object"!=typeof t||Array.isArray(t)?t:Object.keys(t).sort().reduce((e,r)=>(e[r]=t[r],e),{})}function B(e){return JSON.stringify(e,F)}function G(e){try{return JSON.stringify(e)}catch(t){throw console.error(`Could not stringify: ${t.message}`),console.error(e),t}}var V=class{input;resolve;reject;promise;constructor(e){this.input=e;let{promise:t,resolve:r,reject:i}=function(){let[e,t,r]=P();return{promise:e,resolve:t,reject:r}}();this.promise=t,this.resolve=r,this.reject=i}},Y=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t<63?"_":"-",""),Q=class extends Map{#l;constructor(e,t){super(t),this.#l=e}getOrCreate(e,t){if(super.has(e))return super.get(e);{let r=(t??this.#l??S("DefaultMap used without a factory function"))(e);return this.set(e,r),r}}},X=/^[a-zA-Z_][a-zA-Z0-9_]*$/;function Z(e){let t=[],r=Object.entries(e),i=[],s=[],n=[];return r.forEach(([e,t])=>{if(!X.test(e))throw Error("Key must only contain letters, numbers, _");er(t)?i.push([e,t]):v(t)&&(b(t)?s.push([e,t]):n.push([e,t]))}),t=[...ee(i),...et(s)],n.forEach(([e,r])=>{let i=Object.entries(r),s=[],n=[];i.forEach(([t,r])=>{if(es(t))throw Error("Key cannot be empty");er(r)?s.push([ei(e,t),r]):b(r)&&n.push([ei(e,t),r])}),t=[...t,...ee(s),...et(n)]}),t.map(({key:e,operator:t,value:r})=>`${e}${t}${en(r)}`).join(" ")}var ee=e=>{let t=[];return e.forEach(([e,r])=>{t.push({key:e,operator:":",value:r})}),t},et=e=>{let t=[];return e.forEach(([e,r])=>{"startsWith"in r&&"string"==typeof r.startsWith&&t.push({key:e,operator:"^",value:r.startsWith})}),t},er=e=>"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e,ei=(e,t)=>t?`${e}[${en(t)}]`:e,es=e=>!e||""===e.toString().trim();function en(e){let t=JSON.stringify(e);return"string"!=typeof e||t.includes("'")?t:`'${t.slice(1,-1).replace(/\\"/g,'"')}'`}function ea(e,t,r){let i=new URL(t,e);return void 0!==r&&(i.search=(r instanceof URLSearchParams?r:function(e){let t=new URLSearchParams;for(let[r,i]of Object.entries(e))null!=i&&t.set(r,i.toString());return t}(r)).toString()),i.toString()}function eo(e,...t){return e.reduce((e,r,i)=>e+encodeURIComponent(t[i-1]??"")+r)}function ed(e,t){throw Error(t)}function el(e,t="Expected value to be non-nullable"){return e}var eh=class{#h;constructor(e){this.#h=e}get current(){return this.#h}allowPatching(e){let t=this,r=!0;e({...this.#h,patch(e){if(r)for(let r of(t.#h=Object.assign({},t.#h,e),Object.entries(e))){let[e,t]=r;"patch"!==e&&(this[e]=t)}else throw Error("Can no longer patch stale context")}}),r=!1}},ec=1,eu=class{id;#c;#u;#p;#f;#m;#y;events;#g;#_;#w;get #k(){let e=this.#p.values()[Symbol.iterator]().next();if(!e.done)return e.value;throw Error("No states defined yet")}get currentState(){if(null===this.#f)if(0===this.#c)throw Error("Not started yet");else throw Error("Already stopped");return this.#f}start(){if(0!==this.#c)throw Error("State machine has already started");return this.#c=1,this.#f=this.#k,this.#v(null),this}stop(){if(1!==this.#c)throw Error("Cannot stop a state machine that hasn't started yet");this.#b(null),this.#c=2,this.#f=null}constructor(e){this.id=ec++,this.#c=0,this.#f=null,this.#p=new Set,this.#_=new Map,this.#g=[],this.#w=new Set,this.#m=new Map,this.#u=new eh(e),this.#y={didReceiveEvent:N(),willTransition:N(),didIgnoreEvent:N(),willExitState:N(),didEnterState:N()},this.events={didReceiveEvent:this.#y.didReceiveEvent.observable,willTransition:this.#y.willTransition.observable,didIgnoreEvent:this.#y.didIgnoreEvent.observable,willExitState:this.#y.willExitState.observable,didEnterState:this.#y.didEnterState.observable}}get context(){return this.#u.current}addState(e){if(0!==this.#c)throw Error("Already started");return this.#p.add(e),this}onEnter(e,t){if(0!==this.#c)throw Error("Already started");if(this.#_.has(e))throw Error(`enter/exit function for ${e} already exists`);return this.#_.set(e,t),this}onEnterAsync(e,t,r,i,s){return this.onEnter(e,()=>{let e=new AbortController,n=e.signal,a=s?setTimeout(()=>{let e=Error("Timed out");this.#S({type:"ASYNC_ERROR",reason:e},i)},s):void 0,o=!1;return t(this.#u.current,n).then(e=>{n.aborted||(o=!0,this.#S({type:"ASYNC_OK",data:e},r))},e=>{n.aborted||(o=!0,this.#S({type:"ASYNC_ERROR",reason:e},i))}),()=>{clearTimeout(a),o||e.abort()}})}#T(e){let t=[];if("*"===e)for(let e of this.#p)t.push(e);else if(e.endsWith(".*")){let r=e.slice(0,-1);for(let e of this.#p)e.startsWith(r)&&t.push(e)}else this.#p.has(e)&&t.push(e);if(0===t.length)throw Error(`No states match ${JSON.stringify(e)}`);return t}addTransitions(e,t){if(0!==this.#c)throw Error("Already started");for(let r of this.#T(e)){let i=this.#m.get(r);for(let[s,n]of(void 0===i&&(i=new Map,this.#m.set(r,i)),Object.entries(t))){if(i.has(s))throw Error(`Trying to set transition "${s}" on "${r}" (via "${e}"), but a transition already exists there.`);let t=n;if(this.#w.add(s),void 0!==t){let e="function"==typeof t?t:()=>t;i.set(s,e)}}}return this}addTimedTransition(e,t,r){return this.onEnter(e,()=>{let e=setTimeout(()=>{this.#S({type:"TIMER"},r)},"function"==typeof t?t(this.#u.current):t);return()=>{clearTimeout(e)}})}#E(e){return this.#m.get(this.currentState)?.get(e)}#b(e){this.#y.willExitState.notify(this.currentState),this.#u.allowPatching(t=>{e=e??this.#g.length;for(let r=0;r<e;r++)this.#g.pop()?.(t)})}#v(e){let t=function(e,t){let r=e.split(".");if(t<1||t>r.length+1)throw Error("Invalid number of levels");let i=[];t>r.length&&i.push("*");for(let e=r.length-t+1;e<r.length;e++){let t=r.slice(0,e);t.length>0&&i.push(t.join(".")+".*")}return i.push(e),i}(this.currentState,e??this.currentState.split(".").length+1);this.#u.allowPatching(e=>{for(let r of t){let t=this.#_.get(r),i=t?.(e);"function"==typeof i?this.#g.push(i):this.#g.push(null)}}),this.#y.didEnterState.notify(this.currentState)}send(e){if(!this.#w.has(e.type))throw Error(`Invalid event ${JSON.stringify(e.type)}`);if(2===this.#c)return;let t=this.#E(e.type);if(void 0!==t)return this.#S(e,t);this.#y.didIgnoreEvent.notify(e)}#S(e,t){let r,i;this.#y.didReceiveEvent.notify(e);let s=this.currentState,n=("function"==typeof t?t:()=>t)(e,this.#u.current);if(null===n)return void this.#y.didIgnoreEvent.notify(e);if("string"==typeof n?r=n:(r=n.target,i=Array.isArray(n.effect)?n.effect:[n.effect]),!this.#p.has(r))throw Error(`Invalid next state name: ${JSON.stringify(r)}`);this.#y.willTransition.notify({from:s,to:r});let[a,o]=function(e,t){if(e===t)return[0,0];let r=e.split("."),i=t.split("."),s=Math.min(r.length,i.length),n=0;for(;n<s&&r[n]===i[n];n++);return[r.length-n,i.length-n]}(this.currentState,r);if(a>0&&this.#b(a),this.#f=r,void 0!==i){let t=i;this.#u.allowPatching(r=>{for(let i of t)"function"==typeof i?i(r,e):r.patch(i)})}o>0&&this.#v(o)}},ep=(e=>(e[e.UPDATE_PRESENCE=100]="UPDATE_PRESENCE",e[e.USER_JOINED=101]="USER_JOINED",e[e.USER_LEFT=102]="USER_LEFT",e[e.BROADCASTED_EVENT=103]="BROADCASTED_EVENT",e[e.ROOM_STATE=104]="ROOM_STATE",e[e.INITIAL_STORAGE_STATE=200]="INITIAL_STORAGE_STATE",e[e.UPDATE_STORAGE=201]="UPDATE_STORAGE",e[e.REJECT_STORAGE_OP=299]="REJECT_STORAGE_OP",e[e.UPDATE_YDOC=300]="UPDATE_YDOC",e[e.THREAD_CREATED=400]="THREAD_CREATED",e[e.THREAD_DELETED=407]="THREAD_DELETED",e[e.THREAD_METADATA_UPDATED=401]="THREAD_METADATA_UPDATED",e[e.THREAD_UPDATED=408]="THREAD_UPDATED",e[e.COMMENT_CREATED=402]="COMMENT_CREATED",e[e.COMMENT_EDITED=403]="COMMENT_EDITED",e[e.COMMENT_DELETED=404]="COMMENT_DELETED",e[e.COMMENT_REACTION_ADDED=405]="COMMENT_REACTION_ADDED",e[e.COMMENT_REACTION_REMOVED=406]="COMMENT_REACTION_REMOVED",e))(ep||{}),ef=(e=>(e[e.CLOSE_NORMAL=1e3]="CLOSE_NORMAL",e[e.CLOSE_ABNORMAL=1006]="CLOSE_ABNORMAL",e[e.UNEXPECTED_CONDITION=1011]="UNEXPECTED_CONDITION",e[e.TRY_AGAIN_LATER=1013]="TRY_AGAIN_LATER",e[e.INVALID_MESSAGE_FORMAT=4e3]="INVALID_MESSAGE_FORMAT",e[e.NOT_ALLOWED=4001]="NOT_ALLOWED",e[e.MAX_NUMBER_OF_MESSAGES_PER_SECONDS=4002]="MAX_NUMBER_OF_MESSAGES_PER_SECONDS",e[e.MAX_NUMBER_OF_CONCURRENT_CONNECTIONS=4003]="MAX_NUMBER_OF_CONCURRENT_CONNECTIONS",e[e.MAX_NUMBER_OF_MESSAGES_PER_DAY_PER_APP=4004]="MAX_NUMBER_OF_MESSAGES_PER_DAY_PER_APP",e[e.MAX_NUMBER_OF_CONCURRENT_CONNECTIONS_PER_ROOM=4005]="MAX_NUMBER_OF_CONCURRENT_CONNECTIONS_PER_ROOM",e[e.ROOM_ID_UPDATED=4006]="ROOM_ID_UPDATED",e[e.KICKED=4100]="KICKED",e[e.TOKEN_EXPIRED=4109]="TOKEN_EXPIRED",e[e.CLOSE_WITHOUT_RETRY=4999]="CLOSE_WITHOUT_RETRY",e))(ef||{});function em(e){return 4999===e||e>=4e3&&e<4100}function ey(e){return 1013===e||e>=4200&&e<4300}function eg(e){let t=e.currentState;switch(t){case"@ok.connected":case"@ok.awaiting-pong":return"connected";case"@idle.initial":return"initial";case"@auth.busy":case"@auth.backoff":case"@connecting.busy":case"@connecting.backoff":case"@idle.zombie":return e.context.successCount>0?"reconnecting":"connecting";case"@idle.failed":return"disconnected";default:return ed(t,"Unknown state")}}var e_=[250,500,1e3,2e3,4e3,8e3,1e4],ew=e_[0]-1,ek=class extends Error{constructor(e){super(e)}};function ev(e,t){return t.find(t=>t>e)??t[t.length-1]}function eb(e){e.patch({backoffDelay:ev(e.backoffDelay,e_)})}function eS(e){e.patch({backoffDelay:ev(e.backoffDelay,null)})}function eT(e){e.patch({successCount:0})}function eE(e,t){let r=2===e?y:1===e?m:()=>{};return()=>{r(t)}}function eA(e){let t="Connection to Liveblocks websocket server";return r=>{e instanceof Error?m(`${t} could not be established. ${String(e)}`):m(eC(e)?`${t} closed prematurely (code: ${e.code}). Retrying in ${r.backoffDelay}ms.`:`${t} could not be established.`)}}function eI(e){let t=[`code: ${e.code}`];return e.reason&&t.push(`reason: ${e.reason}`),e=>{m(`Connection to Liveblocks websocket server closed (${t.join(", ")}). Retrying in ${e.backoffDelay}ms.`)}}var eO=eE(1,"Connection to WebSocket closed permanently. Won't retry.");function eC(e){return!(e instanceof Error)&&"close"===e.type}var ex=e=>t=>t.patch(e);function eP(e,t){if(Object.is(e,t))return!0;let r=Array.isArray(e),i=Array.isArray(t);if(r||i){if(!r||!i)return!1;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Object.is(e[r],t[r]))return!1;return!0}if(!v(e)||!v(t))return!1;let s=Object.keys(e);return s.length===Object.keys(t).length&&s.every(r=>Object.prototype.hasOwnProperty.call(t,r)&&Object.is(e[r],t[r]))}Symbol();var eN=class e{#A;#I;constructor(e,t){this.#I=t,this.#A=e}static with(t){return e.fromAlreadySorted([],t)}static from(t,r){let i=new e([],r);for(let e of t)i.add(e);return i}static fromAlreadySorted(t,r){return new e(t,r)}clone(){return new e(this.#A.slice(),this.#I)}add(e){let t=function(e,t,r){let i=0,s=e.length;for(;i<s;){let n=i+(s-i>>1);r(t,e[n])?s=n:i=n+1}return i}(this.#A,e,this.#I);this.#A.splice(t,0,e)}clear(){let e=this.#A.length>0;return this.#A.length=0,e}removeBy(e,t=Number.POSITIVE_INFINITY){let r=0;for(let i=0;i<this.#A.length;i++)if(e(this.#A[i])){if(this.#A.splice(i,1),++r>=t)break;i--}return r>0}remove(e){let t=this.#A.indexOf(e);return t>=0&&(this.#A.splice(t,1),!0)}at(e){return this.#A[e]}get length(){return this.#A.length}*filter(e){for(let t of this.#A)e(t)&&(yield t)}*findAllRight(e){for(let t=this.#A.length-1;t>=0;t--){let r=this.#A[t];e(r,t)&&(yield r)}}[Symbol.iterator](){return this.#A[Symbol.iterator]()}*iterReversed(){for(let e=this.#A.length-1;e>=0;e--)yield this.#A[e]}find(e,t){let r=this.findIndex(e,t);return r>-1?this.#A.at(r):void 0}findIndex(e,t=0){for(let r=Math.max(0,t);r<this.#A.length;r++)if(e(this.#A[r],r))return r;return -1}findRight(e,t){let r=this.findIndexRight(e,t);return r>-1?this.#A.at(r):void 0}findIndexRight(e,t=this.#A.length-1){for(let r=Math.min(t,this.#A.length-1);r>=0;r--)if(e(this.#A[r],r))return r;return -1}get rawArray(){return this.#A}},eU=(Symbol.iterator,(e=>(e.Read="room:read",e.Write="room:write",e.PresenceWrite="room:presence:write",e.CommentsWrite="comments:write",e.CommentsRead="comments:read",e))(eU||{}));Symbol("*");N().observable,Date.now();var eR=Symbol("notification-settings-plain");function eD(e){let t={[eR]:{value:e,enumerable:!1}};for(let e of["email","slack","teams","webPush"])t[e]={enumerable:!0,get(){let t=this[eR][e];return void 0===t?(y(`In order to use the '${e}' channel, please set up your project first. For more information: https://liveblocks.io/docs/errors/enable-a-notification-channel`),null):t}};return void 0!==t?Object.create(null,t):Object.create(null)}var eq=e$(0),eL=e$(1),eM=eq+e$(-1);function e$(e){let t=32+(e<0?95+e:e);if(t<32||t>126)throw Error(`Invalid n value: ${e}`);return String.fromCharCode(t)}function ej(e,t){if(void 0!==e&&void 0!==t){var r=e,i=t;if(r<i)return eJ(r,i);if(r>i)return eJ(i,r);throw Error("Cannot compute value between two equal positions")}if(void 0!==e){var s=e;for(let e=0;e<=s.length-1;e++){let t=s.charCodeAt(e);if(!(t>=126))return s.substring(0,e)+String.fromCharCode(t+1)}return s+eL}if(void 0===t)return eL;{var n=t;let e=n.length-1;for(let t=0;t<=e;t++){let r=n.charCodeAt(t);if(!(r<=32))if(t!==e)return n.substring(0,t+1);else if(33===r)return n.substring(0,t)+eM;else return n.substring(0,t)+String.fromCharCode(r-1)}return eL}}function eJ(e,t){let r=0,i=e.length,s=t.length;for(;;){let o=r<i?e.charCodeAt(r):32,d=r<s?t.charCodeAt(r):126;if(o===d){r++;continue}if(d-o!=1){var n,a;return n=e,((a=r)<n.length?n.substring(0,a):n+eq.repeat(a-n.length))+String.fromCharCode(d+o>>1)}{let t=r+1,i=e.substring(0,t);return i.length<t&&(i+=eq.repeat(t-i.length)),i+eJ(e.substring(t),"")}}}function ez(e){return!function(e){if(""===e)return!1;let t=e.length-1,r=e.charCodeAt(t);if(r<33||r>126)return!1;for(let r=0;r<t;r++){let t=e.charCodeAt(r);if(t<32||t>126)return!1}return!0}(e)?function(e){let t=[];for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);t.push(i<32?32:i>126?126:i)}for(;t.length>0&&32===t[t.length-1];)t.length--;return t.length>0?String.fromCharCode(...t):eL}(e):e}var eH=(e=>(e[e.INIT=0]="INIT",e[e.SET_PARENT_KEY=1]="SET_PARENT_KEY",e[e.CREATE_LIST=2]="CREATE_LIST",e[e.UPDATE_OBJECT=3]="UPDATE_OBJECT",e[e.CREATE_OBJECT=4]="CREATE_OBJECT",e[e.DELETE_CRDT=5]="DELETE_CRDT",e[e.DELETE_OBJECT_KEY=6]="DELETE_OBJECT_KEY",e[e.CREATE_MAP=7]="CREATE_MAP",e[e.CREATE_REGISTER=8]="CREATE_REGISTER",e))(eH||{});function eK(e,t,r=ez(t)){return Object.freeze({type:"HasParent",node:e,key:t,pos:r})}var eW=Object.freeze({type:"NoParent"}),eF=class{#O;#C;#x=eW;_getParentKeyOrThrow(){switch(this.parent.type){case"HasParent":return this.parent.key;case"NoParent":throw Error("Parent key is missing");case"Orphaned":return this.parent.oldKey;default:return ed(this.parent,"Unknown state")}}get _parentPos(){switch(this.parent.type){case"HasParent":return this.parent.pos;case"NoParent":throw Error("Parent key is missing");case"Orphaned":return this.parent.oldPos;default:return ed(this.parent,"Unknown state")}}get _pool(){return this.#O}get roomId(){return this.#O?this.#O.roomId:null}get _id(){return this.#C}get parent(){return this.#x}get _parentKey(){switch(this.parent.type){case"HasParent":return this.parent.key;case"NoParent":return null;case"Orphaned":return this.parent.oldKey;default:return ed(this.parent,"Unknown state")}}_apply(e,t){if(5===e.type&&"HasParent"===this.parent.type)return this.parent.node._detachChild(this);return{modified:!1}}_setParentLink(e,t){switch(this.parent.type){case"HasParent":if(this.parent.node!==e)throw Error("Cannot set parent: node already has a parent");this.#x=eK(e,t);return;case"Orphaned":case"NoParent":this.#x=eK(e,t);return;default:return ed(this.parent,"Unknown state")}}_attach(e,t){if(this.#C||this.#O)throw Error("Cannot attach node: already attached");t.addNode(e,this),this.#C=e,this.#O=t}_detach(){switch(this.#O&&this.#C&&this.#O.deleteNode(this.#C),this.parent.type){case"HasParent":this.#x=function(e,t=ez(e)){return Object.freeze({type:"Orphaned",oldKey:e,oldPos:t})}(this.parent.key,this.parent.pos);break;case"NoParent":this.#x=eW;break;case"Orphaned":break;default:ed(this.parent,"Unknown state")}this.#O=void 0}#P;#N;#U;invalidate(){(void 0!==this.#P||void 0!==this.#U)&&(this.#P=void 0,this.#U=void 0,"HasParent"===this.parent.type&&this.parent.node.invalidate())}toTreeNode(e){return(void 0===this.#U||this.#N!==e)&&(this.#N=e,this.#U=this._toTreeNode(e)),this.#U}toImmutable(){return void 0===this.#P&&(this.#P=this._toImmutable()),this.#P}},eB=(e=>(e[e.OBJECT=0]="OBJECT",e[e.LIST=1]="LIST",e[e.MAP=2]="MAP",e[e.REGISTER=3]="REGISTER",e))(eB||{}),eG=class e extends eF{#A;constructor(e){super(),this.#A=e}get data(){return this.#A}static _deserialize([t,r],i,s){let n=new e(r.data);return n._attach(t,s),n}_toOps(e,t,r){if(void 0===this._id)throw Error("Cannot serialize register if parentId or parentKey is undefined");return[{type:8,opId:r?.generateOpId(),id:this._id,parentId:e,parentKey:t,data:this.data}]}_serialize(){if("HasParent"!==this.parent.type)throw Error("Cannot serialize LiveRegister if parent is missing");return{type:3,parentId:el(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key,data:this.data}}_attachChild(e){throw Error("Method not implemented.")}_detachChild(e){throw Error("Method not implemented.")}_apply(e,t){return super._apply(e,t)}_toTreeNode(e){return{type:"Json",id:this._id??Y(),key:e,payload:this.#A}}_toImmutable(){return this.#A}clone(){return A(this.data)}};function eV(e,t){let r=e._parentPos,i=t._parentPos;return r===i?0:r<i?-1:1}var eY=class e extends eF{#R;#D;#q;constructor(e){let t;for(let r of(super(),this.#R=[],this.#D=new WeakSet,this.#q=new Map,e)){let e=ej(t),i=ts(r);i._setParentLink(this,e),this.#R.push(i),t=e}}static _deserialize([t],r,i){let s=new e([]);s._attach(t,i);let n=r.get(t);if(void 0===n)return s;for(let[e,t]of n){let n=e9([e,t],r,i);n._setParentLink(s,t.parentKey),s._insertAndSort(n)}return s}_toOps(e,t,r){if(void 0===this._id)throw Error("Cannot serialize item is not attached");let i=[],s={id:this._id,opId:r?.generateOpId(),type:2,parentId:e,parentKey:t};for(let e of(i.push(s),this.#R)){let t=e._getParentKeyOrThrow(),s=e5(e._toOps(this._id,t,r),void 0),n=s[0].opId;void 0!==n&&this.#q.set(t,n),i.push(...s)}return i}_insertAndSort(e){this.#R.push(e),this._sortItems()}_sortItems(){this.#R.sort(eV),this.invalidate()}_indexOfPosition(e){return this.#R.findIndex(t=>t._getParentKeyOrThrow()===e)}_attach(e,t){for(let r of(super._attach(e,t),this.#R))r._attach(t.generateId(),t)}_detach(){for(let e of(super._detach(),this.#R))e._detach()}#L(e){if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let{id:t,parentKey:r}=e,i=e4(e);i._attach(t,this._pool),i._setParentLink(this,r);let s=e.deletedId,n=this._indexOfPosition(r);if(-1!==n){let t=this.#R[n];if(t._id===s)return t._detach(),this.#R[n]=i,{modified:eX(this,[eZ(n,i)]),reverse:[]};{this.#D.add(t),this.#R[n]=i;let r=[eZ(n,i)],s=this.#M(e.deletedId);return s&&r.push(s),{modified:eX(this,r),reverse:[]}}}{let t=[],s=this.#M(e.deletedId);return s&&t.push(s),this._insertAndSort(i),t.push(e1(this._indexOfPosition(r),i)),{reverse:[],modified:eX(this,t)}}}#$(e){if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let t=[],r=this.#M(e.deletedId);r&&t.push(r);let i=this.#q.get(e.parentKey);if(void 0!==i)if(i!==e.opId)return 0===t.length?{modified:!1}:{modified:eX(this,t),reverse:[]};else this.#q.delete(e.parentKey);let s=this._indexOfPosition(e.parentKey),n=this.#R.find(t=>t._id===e.id);if(void 0!==n){if(n._parentKey===e.parentKey)return{modified:t.length>0&&eX(this,t),reverse:[]};if(-1!==s){this.#D.add(this.#R[s]);let[e]=this.#R.splice(s,1);t.push(e0(s,e))}let r=this.#R.indexOf(n);n._setParentLink(this,e.parentKey),this._sortItems();let i=this.#R.indexOf(n);return i!==r&&t.push(e2(r,i,n)),{modified:t.length>0&&eX(this,t),reverse:[]}}{let r=this._pool.getNode(e.id);if(r&&this.#D.has(r)){r._setParentLink(this,e.parentKey),this.#D.delete(r),this._insertAndSort(r);let i=this.#R.indexOf(r);return{modified:eX(this,[-1===s?e1(i,r):eZ(i,r),...t]),reverse:[]}}{-1!==s&&this.#R.splice(s,1);let{newItem:r,newIndex:i}=this.#j(e,e.parentKey);return{modified:eX(this,[-1===s?e1(i,r):eZ(i,r),...t]),reverse:[]}}}}#M(e){if(void 0===e||void 0===this._pool)return null;let t=this._pool.getNode(e);if(void 0===t)return null;let r=this._detachChild(t);return!1===r.modified?null:r.modified.updates[0]}#J(e){if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let t=ez(e.parentKey),r=this._indexOfPosition(t);-1!==r&&this.#z(r,t);let{newItem:i,newIndex:s}=this.#j(e,t);return{modified:eX(this,[e1(s,i)]),reverse:[]}}#H(e){let t=this.#R.find(t=>t._id===e.id),r=ez(e.parentKey),i=this._indexOfPosition(r);if(t)if(t._parentKey===r)return{modified:!1};else{let e=this.#R.indexOf(t);-1!==i&&this.#z(i,r),t._setParentLink(this,r),this._sortItems();let s=this._indexOfPosition(r);return s===e?{modified:!1}:{modified:eX(this,[e2(e,s,t)]),reverse:[]}}{let t=el(this._pool).getNode(e.id);if(t&&this.#D.has(t))return t._setParentLink(this,r),this.#D.delete(t),this._insertAndSort(t),{modified:eX(this,[e1(this._indexOfPosition(r),t)]),reverse:[]};{-1!==i&&this.#z(i,r);let{newItem:t,newIndex:s}=this.#j(e,r);return{modified:eX(this,[e1(s,t)]),reverse:[]}}}}#K(e){let{id:t,parentKey:r}=e,i=e4(e);if(this._pool?.getNode(t)!==void 0)return{modified:!1};i._attach(t,el(this._pool)),i._setParentLink(this,r);let s=this._indexOfPosition(r),n=r;return -1!==s&&(n=ej(this.#R[s]?._parentPos,this.#R[s+1]?._parentPos),i._setParentLink(this,n)),this._insertAndSort(i),{modified:eX(this,[e1(this._indexOfPosition(n),i)]),reverse:[{type:5,id:t}]}}#W(e){let{id:t,parentKey:r}=e,i=e4(e);if(this._pool?.getNode(t)!==void 0)return{modified:!1};this.#q.set(r,el(e.opId));let s=this._indexOfPosition(r);if(i._attach(t,el(this._pool)),i._setParentLink(this,r),-1===s)return this._insertAndSort(i),this.#M(e.deletedId),{reverse:[{type:5,id:t}],modified:eX(this,[e1(this._indexOfPosition(r),i)])};{let t=this.#R[s];t._detach(),this.#R[s]=i;let n=e5(t._toOps(el(this._id),r,this._pool),e.id),a=[eZ(s,i)],o=this.#M(e.deletedId);return o&&a.push(o),{modified:eX(this,a),reverse:n}}}_attachChild(e,t){let r;if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");return!1!==(r="set"===e.intent?1===t?this.#L(e):2===t?this.#$(e):this.#W(e):1===t?this.#J(e):2===t?this.#H(e):this.#K(e)).modified&&this.invalidate(),r}_detachChild(e){if(e){let t=el(e._parentKey),r=e._toOps(el(this._id),t,this._pool),i=this.#R.indexOf(e);if(-1===i)return{modified:!1};let[s]=this.#R.splice(i,1);return this.invalidate(),e._detach(),{modified:eX(this,[e0(i,s)]),reverse:r}}return{modified:!1}}#F(e,t){if(this.#D.has(t))return this.#D.delete(t),t._setParentLink(this,e),this._insertAndSort(t),{modified:eX(this,[e1(this.#R.indexOf(t),t)]),reverse:[]};if(e===t._parentKey)return{modified:!1};let r=this._indexOfPosition(e);if(-1===r){let r=this.#R.indexOf(t);t._setParentLink(this,e),this._sortItems();let i=this.#R.indexOf(t);return i===r?{modified:!1}:{modified:eX(this,[e2(r,i,t)]),reverse:[]}}{this.#R[r]._setParentLink(this,ej(e,this.#R[r+1]?._parentPos));let i=this.#R.indexOf(t);t._setParentLink(this,e),this._sortItems();let s=this.#R.indexOf(t);return s===i?{modified:!1}:{modified:eX(this,[e2(i,s,t)]),reverse:[]}}}#B(e,t){let r=el(t._parentKey);if(this.#D.has(t)){let r=this._indexOfPosition(e);return this.#D.delete(t),-1!==r&&this.#R[r]._setParentLink(this,ej(e,this.#R[r+1]?._parentPos)),t._setParentLink(this,e),this._insertAndSort(t),{modified:!1}}{if(e===r)return{modified:!1};let i=this.#R.indexOf(t),s=this._indexOfPosition(e);-1!==s&&this.#R[s]._setParentLink(this,ej(e,this.#R[s+1]?._parentPos)),t._setParentLink(this,e),this._sortItems();let n=this.#R.indexOf(t);return i===n?{modified:!1}:{modified:eX(this,[e2(i,n,t)]),reverse:[]}}}#G(e,t){let r=el(t._parentKey),i=this.#R.indexOf(t),s=this._indexOfPosition(e);-1!==s&&this.#R[s]._setParentLink(this,ej(e,this.#R[s+1]?._parentPos)),t._setParentLink(this,e),this._sortItems();let n=this.#R.indexOf(t);return i===n?{modified:!1}:{modified:eX(this,[e2(i,n,t)]),reverse:[{type:1,id:el(t._id),parentKey:r}]}}_setChildKey(e,t,r){return 1===r?this.#F(e,t):2===r?this.#B(e,t):this.#G(e,t)}_apply(e,t){return super._apply(e,t)}_serialize(){if("HasParent"!==this.parent.type)throw Error("Cannot serialize LiveList if parent is missing");return{type:1,parentId:el(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key}}get length(){return this.#R.length}push(e){return this._pool?.assertStorageIsWritable(),this.insert(e,this.length)}insert(e,t){if(this._pool?.assertStorageIsWritable(),t<0||t>this.#R.length)throw Error(`Cannot insert list item at index "${t}". index should be between 0 and ${this.#R.length}`);let r=ej(this.#R[t-1]?this.#R[t-1]._parentPos:void 0,this.#R[t]?this.#R[t]._parentPos:void 0),i=ts(e);if(i._setParentLink(this,r),this._insertAndSort(i),this._pool&&this._id){let e=this._pool.generateId();i._attach(e,this._pool),this._pool.dispatch(i._toOps(this._id,r,this._pool),[{type:5,id:e}],new Map([[this._id,eX(this,[e1(t,i)])]]))}}move(e,t){if(this._pool?.assertStorageIsWritable(),t<0)throw Error("targetIndex cannot be less than 0");if(t>=this.#R.length)throw Error("targetIndex cannot be greater or equal than the list length");if(e<0)throw Error("index cannot be less than 0");if(e>=this.#R.length)throw Error("index cannot be greater or equal than the list length");let r=null,i=null;e<t?(i=t===this.#R.length-1?void 0:this.#R[t+1]._parentPos,r=this.#R[t]._parentPos):(i=this.#R[t]._parentPos,r=0===t?void 0:this.#R[t-1]._parentPos);let s=ej(r,i),n=this.#R[e],a=n._getParentKeyOrThrow();if(n._setParentLink(this,s),this._sortItems(),this._pool&&this._id){let r=new Map([[this._id,eX(this,[e2(e,t,n)])]]);this._pool.dispatch([{type:1,id:el(n._id),opId:this._pool.generateOpId(),parentKey:s}],[{type:1,id:el(n._id),parentKey:a}],r)}}delete(e){if(this._pool?.assertStorageIsWritable(),e<0||e>=this.#R.length)throw Error(`Cannot delete list item at index "${e}". index should be between 0 and ${this.#R.length-1}`);let t=this.#R[e];t._detach();let[r]=this.#R.splice(e,1);if(this.invalidate(),this._pool){let i=t._id;if(i){let s=new Map;s.set(el(this._id),eX(this,[e0(e,r)])),this._pool.dispatch([{id:i,opId:this._pool.generateOpId(),type:5}],t._toOps(el(this._id),t._getParentKeyOrThrow()),s)}}}clear(){if(this._pool?.assertStorageIsWritable(),this._pool){let e=[],t=[],r=[];for(let i of this.#R){i._detach();let s=i._id;s&&(e.push({type:5,id:s,opId:this._pool.generateOpId()}),t.push(...i._toOps(el(this._id),i._getParentKeyOrThrow())),r.push(e0(0,i)))}this.#R=[],this.invalidate();let i=new Map;i.set(el(this._id),eX(this,r)),this._pool.dispatch(e,t,i)}else{for(let e of this.#R)e._detach();this.#R=[],this.invalidate()}}set(e,t){if(this._pool?.assertStorageIsWritable(),e<0||e>=this.#R.length)throw Error(`Cannot set list item at index "${e}". index should be between 0 and ${this.#R.length-1}`);let r=this.#R[e],i=r._getParentKeyOrThrow(),s=r._id;r._detach();let n=ts(t);if(n._setParentLink(this,i),this.#R[e]=n,this.invalidate(),this._pool&&this._id){let t=this._pool.generateId();n._attach(t,this._pool);let a=new Map;a.set(this._id,eX(this,[eZ(e,n)]));let o=e5(n._toOps(this._id,i,this._pool),s);this.#q.set(i,el(o[0].opId));let d=e5(r._toOps(this._id,i,void 0),t);this._pool.dispatch(o,d,a)}}toArray(){return this.#R.map(e=>ti(e))}every(e){return this.toArray().every(e)}filter(e){return this.toArray().filter(e)}find(e){return this.toArray().find(e)}findIndex(e){return this.toArray().findIndex(e)}forEach(e){return this.toArray().forEach(e)}get(e){if(!(e<0)&&!(e>=this.#R.length))return ti(this.#R[e])}indexOf(e,t){return this.toArray().indexOf(e,t)}lastIndexOf(e,t){return this.toArray().lastIndexOf(e,t)}map(e){return this.#R.map((t,r)=>e(ti(t),r))}some(e){return this.toArray().some(e)}[Symbol.iterator](){return new eQ(this.#R)}#j(e,t){let r=e4(e);return r._attach(e.id,el(this._pool)),r._setParentLink(this,t),this._insertAndSort(r),{newItem:r,newIndex:this._indexOfPosition(t)}}#z(e,t){let r=ej(t,this.#R.length>e+1?this.#R[e+1]?._parentPos:void 0);this.#R[e]._setParentLink(this,r)}_toTreeNode(e){return{type:"LiveList",id:this._id??Y(),key:e,payload:this.#R.map((e,t)=>e.toTreeNode(t.toString()))}}toImmutable(){return super.toImmutable()}_toImmutable(){return this.#R.map(e=>e.toImmutable())}clone(){return new e(this.#R.map(e=>e.clone()))}},eQ=class{#V;constructor(e){this.#V=e[Symbol.iterator]()}[Symbol.iterator](){return this}next(){let e=this.#V.next();return e.done?{done:!0,value:void 0}:{value:ti(e.value)}}};function eX(e,t){return{node:e,type:"LiveList",updates:t}}function eZ(e,t){return{index:e,type:"set",item:t instanceof eG?t.data:t}}function e0(e,t){return{type:"delete",index:e,deletedItem:t instanceof eG?t.data:t}}function e1(e,t){return{index:e,type:"insert",item:t instanceof eG?t.data:t}}function e2(e,t,r){return{type:"move",index:t,item:r instanceof eG?r.data:r,previousIndex:e}}function e5(e,t){return e.map((e,r)=>0===r?{...e,intent:"set",deletedId:t}:e)}var e6=class e extends eF{#Y;#Q;constructor(e){if(super(),this.#Q=new Map,e){let t=[];for(let[r,i]of e){let e=ts(i);e._setParentLink(this,r),t.push([r,e])}this.#Y=new Map(t)}else this.#Y=new Map}_toOps(e,t,r){if(void 0===this._id)throw Error("Cannot serialize item is not attached");let i=[],s={id:this._id,opId:r?.generateOpId(),type:7,parentId:e,parentKey:t};for(let[e,t]of(i.push(s),this.#Y))i.push(...t._toOps(this._id,e,r));return i}static _deserialize([t,r],i,s){let n=new e;n._attach(t,s);let a=i.get(t);if(void 0===a)return n;for(let[e,t]of a){let r=e9([e,t],i,s);r._setParentLink(n,t.parentKey),n.#Y.set(t.parentKey,r),n.invalidate()}return n}_attach(e,t){for(let[r,i]of(super._attach(e,t),this.#Y))te(i)&&i._attach(t.generateId(),t)}_attachChild(e,t){let r;if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let{id:i,parentKey:s,opId:n}=e,a=e4(e);if(void 0!==this._pool.getNode(i))return{modified:!1};if(2===t){let e=this.#Q.get(s);if(e===n)return this.#Q.delete(s),{modified:!1};if(void 0!==e)return{modified:!1}}else 1===t&&this.#Q.delete(s);let o=this.#Y.get(s);if(o){let e=el(this._id);r=o._toOps(e,s),o._detach()}else r=[{type:5,id:i}];return a._setParentLink(this,s),a._attach(i,this._pool),this.#Y.set(s,a),this.invalidate(),{modified:{node:this,type:"LiveMap",updates:{[s]:{type:"update"}}},reverse:r}}_detach(){for(let e of(super._detach(),this.#Y.values()))e._detach()}_detachChild(e){let t=el(this._id),r=el(e._parentKey),i=e._toOps(t,r,this._pool);for(let[t,r]of this.#Y)r===e&&(this.#Y.delete(t),this.invalidate());return e._detach(),{modified:{node:this,type:"LiveMap",updates:{[r]:{type:"delete"}}},reverse:i}}_serialize(){if("HasParent"!==this.parent.type)throw Error("Cannot serialize LiveMap if parent is missing");return{type:2,parentId:el(this.parent.node._id,"Parent node expected to have ID"),parentKey:this.parent.key}}get(e){let t=this.#Y.get(e);if(void 0!==t)return ti(t)}set(e,t){this._pool?.assertStorageIsWritable();let r=this.#Y.get(e);r&&r._detach();let i=ts(t);if(i._setParentLink(this,e),this.#Y.set(e,i),this.invalidate(),this._pool&&this._id){let t=this._pool.generateId();i._attach(t,this._pool);let s=new Map;s.set(this._id,{node:this,type:"LiveMap",updates:{[e]:{type:"update"}}});let n=i._toOps(this._id,e,this._pool);this.#Q.set(e,el(n[0].opId)),this._pool.dispatch(i._toOps(this._id,e,this._pool),r?r._toOps(this._id,e):[{type:5,id:t}],s)}}get size(){return this.#Y.size}has(e){return this.#Y.has(e)}delete(e){this._pool?.assertStorageIsWritable();let t=this.#Y.get(e);if(void 0===t)return!1;if(t._detach(),this.#Y.delete(e),this.invalidate(),this._pool&&t._id){let r=el(this._id),i=new Map;i.set(r,{node:this,type:"LiveMap",updates:{[e]:{type:"delete"}}}),this._pool.dispatch([{type:5,id:t._id,opId:this._pool.generateOpId()}],t._toOps(r,e),i)}return!0}entries(){let e=this.#Y.entries();return{[Symbol.iterator](){return this},next(){let t=e.next();return t.done?{done:!0,value:void 0}:{value:[t.value[0],ti(t.value[1])]}}}}[Symbol.iterator](){return this.entries()}keys(){return this.#Y.keys()}values(){let e=this.#Y.values();return{[Symbol.iterator](){return this},next(){let t=e.next();return t.done?{done:!0,value:void 0}:{value:ti(t.value)}}}}forEach(e){for(let t of this)e(t[1],t[0],this)}_toTreeNode(e){return{type:"LiveMap",id:this._id??Y(),key:e,payload:Array.from(this.#Y.entries()).map(([e,t])=>t.toTreeNode(e))}}toImmutable(){return super.toImmutable()}_toImmutable(){let e=new Map;for(let[t,r]of this.#Y)e.set(t,r.toImmutable());return U(e)}clone(){return new e(Array.from(this.#Y).map(([e,t])=>[e,t.clone()]))}},e3=class e extends eF{#Y;#X;static detectLargeObjects=!1;static #Z(e){let t=new Map,r=null;for(let[s,n]of e){var i;if(0!==n.type||void 0!==(i=n).parentId&&void 0!==i.parentKey){let e=[s,n],r=t.get(n.parentId);void 0!==r?r.push(e):t.set(n.parentId,[e])}else r=[s,n]}if(null===r)throw Error("Root can't be null");return[r,t]}static _fromItems(t,r){let[i,s]=e.#Z(t);return e._deserialize(i,s,r)}constructor(e={}){super(),this.#X=new Map;let t=I(e);for(let e of Object.keys(t)){let r=t[e];te(r)&&r._setParentLink(this,e)}this.#Y=new Map(Object.entries(t))}_toOps(e,t,r){if(void 0===this._id)throw Error("Cannot serialize item is not attached");let i=r?.generateOpId(),s=[],n={type:4,id:this._id,opId:i,parentId:e,parentKey:t,data:{}};for(let[e,t]of(s.push(n),this.#Y))te(t)?s.push(...t._toOps(this._id,e,r)):n.data[e]=t;return s}static _deserialize([t,r],i,s){let n=new e(r.data);return n._attach(t,s),this._deserializeChildren(n,i,s)}static _deserializeChildren(e,t,r){let i=t.get(el(e._id));if(void 0===i)return e;for(let[s,n]of i){let i=function([e,t],r,i){switch(t.type){case 0:return e3._deserialize([e,t],r,i);case 1:return eY._deserialize([e,t],r,i);case 2:return e6._deserialize([e,t],r,i);case 3:return t.data;default:throw Error("Unexpected CRDT type")}}([s,n],t,r);e7(i)&&i._setParentLink(e,n.parentKey),e.#Y.set(n.parentKey,i),e.invalidate()}return e}_attach(e,t){for(let[r,i]of(super._attach(e,t),this.#Y))te(i)&&i._attach(t.generateId(),t)}_attachChild(e,t){let r;if(void 0===this._pool)throw Error("Can't attach child if managed pool is not present");let{id:i,opId:s,parentKey:n}=e,a=e8(e);if(void 0!==this._pool.getNode(i))return this.#X.get(n)===s&&this.#X.delete(n),{modified:!1};if(0===t)this.#X.set(n,el(s));else if(void 0===this.#X.get(n));else if(this.#X.get(n)===s)return this.#X.delete(n),{modified:!1};else return{modified:!1};let o=el(this._id),d=this.#Y.get(n);return te(d)?(r=d._toOps(o,n),d._detach()):r=void 0===d?[{type:6,id:o,key:n}]:[{type:3,id:o,data:{[n]:d}}],this.#Y.set(n,a),this.invalidate(),e7(a)&&(a._setParentLink(this,n),a._attach(i,this._pool)),{reverse:r,modified:{node:this,type:"LiveObject",updates:{[n]:{type:"update"}}}}}_detachChild(e){if(e){let t=el(this._id),r=el(e._parentKey),i=e._toOps(t,r,this._pool);for(let[t,r]of this.#Y)r===e&&(this.#Y.delete(t),this.invalidate());return e._detach(),{modified:{node:this,type:"LiveObject",updates:{[r]:{type:"delete"}}},reverse:i}}return{modified:!1}}_detach(){for(let e of(super._detach(),this.#Y.values()))te(e)&&e._detach()}_apply(e,t){return 3===e.type?this.#ee(e,t):6===e.type?this.#et(e,t):super._apply(e,t)}_serialize(){let e={};for(let[t,r]of this.#Y)te(r)||(e[t]=r);return"HasParent"===this.parent.type&&this.parent.node._id?{type:0,parentId:this.parent.node._id,parentKey:this.parent.key,data:e}:{type:0,data:e}}#ee(e,t){let r=!1,i=el(this._id),s=[],n={type:3,id:i,data:{}};for(let t in e.data){let e=this.#Y.get(t);te(e)?(s.push(...e._toOps(i,t)),e._detach()):void 0!==e?n.data[t]=e:void 0===e&&s.push({type:6,id:i,key:t})}let a={};for(let i in e.data){let s=e.data[i];if(void 0===s)continue;if(t)this.#X.set(i,el(e.opId));else if(void 0===this.#X.get(i))r=!0;else{if(this.#X.get(i)!==e.opId)continue;this.#X.delete(i);continue}let n=this.#Y.get(i);te(n)&&n._detach(),r=!0,a[i]={type:"update"},this.#Y.set(i,s),this.invalidate()}return 0!==Object.keys(n.data).length&&s.unshift(n),r?{modified:{node:this,type:"LiveObject",updates:a},reverse:s}:{modified:!1}}#et(e,t){let r=e.key;if(!1===this.#Y.has(r)||!t&&void 0!==this.#X.get(r))return{modified:!1};let i=this.#Y.get(r),s=el(this._id),n=[];return te(i)?(n=i._toOps(s,e.key),i._detach()):void 0!==i&&(n=[{type:3,id:s,data:{[r]:i}}]),this.#Y.delete(r),this.invalidate(),{modified:{node:this,type:"LiveObject",updates:{[e.key]:{type:"delete"}}},reverse:n}}toObject(){return Object.fromEntries(this.#Y)}set(e,t){this._pool?.assertStorageIsWritable(),this.update({[e]:t})}get(e){return this.#Y.get(e)}delete(e){let t;this._pool?.assertStorageIsWritable();let r=this.#Y.get(e);if(void 0===r)return;if(void 0===this._pool||void 0===this._id){te(r)&&r._detach(),this.#Y.delete(e),this.invalidate();return}te(r)?(r._detach(),t=r._toOps(this._id,e)):t=[{type:3,data:{[e]:r},id:this._id}],this.#Y.delete(e),this.invalidate();let i=new Map;i.set(this._id,{node:this,type:"LiveObject",updates:{[e]:{type:"delete"}}}),this._pool.dispatch([{type:6,key:e,id:this._id,opId:this._pool.generateOpId()}],t,i)}update(t){if(this._pool?.assertStorageIsWritable(),e.detectLargeObjects){let e={};for(let[t,r]of this.#Y)te(r)||(e[t]=r);for(let r of Object.keys(t)){let i=t[r];void 0!==i&&(te(i)||(e[r]=i))}let r=JSON.stringify(e);if(4*r.length>131072){let e=new TextEncoder().encode(r).length;if(e>131072)throw Error(`LiveObject size exceeded limit: ${e} bytes > 131072 bytes. See https://liveblocks.io/docs/platform/limits#Liveblocks-Storage-limits`)}}if(void 0===this._pool||void 0===this._id){for(let e in t){let r=t[e];if(void 0===r)continue;let i=this.#Y.get(e);te(i)&&i._detach(),te(r)&&r._setParentLink(this,e),this.#Y.set(e,r),this.invalidate()}return}let r=[],i=[],s=this._pool.generateOpId(),n={},a={id:this._id,type:3,data:{}},o={};for(let e in t){let d=t[e];if(void 0===d)continue;let l=this.#Y.get(e);if(te(l)?(i.push(...l._toOps(this._id,e)),l._detach()):void 0===l?i.push({type:6,id:this._id,key:e}):a.data[e]=l,te(d)){d._setParentLink(this,e),d._attach(this._pool.generateId(),this._pool);let t=d._toOps(this._id,e,this._pool),i=t.find(e=>e.parentId===this._id);i&&this.#X.set(e,el(i.opId)),r.push(...t)}else n[e]=d,this.#X.set(e,s);this.#Y.set(e,d),this.invalidate(),o[e]={type:"update"}}0!==Object.keys(a.data).length&&i.unshift(a),0!==Object.keys(n).length&&r.unshift({opId:s,id:this._id,type:3,data:n});let d=new Map;d.set(this._id,{node:this,type:"LiveObject",updates:o}),this._pool.dispatch(r,i,d)}toImmutable(){return super.toImmutable()}toTreeNode(e){return super.toTreeNode(e)}_toTreeNode(e){let t=this._id??Y();return{type:"LiveObject",id:t,key:e,payload:Array.from(this.#Y.entries()).map(([e,r])=>te(r)?r.toTreeNode(e):{type:"Json",id:`${t}:${e}`,key:e,payload:r})}}_toImmutable(){let e={};for(let[t,r]of this.#Y)e[t]=e7(r)?r.toImmutable():r;return e}clone(){return new e(Object.fromEntries(Array.from(this.#Y).map(([e,t])=>[e,e7(t)?t.clone():A(t)])))}};function e4(e){return ts(e8(e))}function e8(e){switch(e.type){case 8:return e.data;case 4:return new e3(e.data);case 7:return new e6;case 2:return new eY([]);default:return ed(e,"Unknown creation Op")}}function e9([e,t],r,i){switch(t.type){case 0:return e3._deserialize([e,t],r,i);case 1:return eY._deserialize([e,t],r,i);case 2:return e6._deserialize([e,t],r,i);case 3:return eG._deserialize([e,t],r,i);default:throw Error("Unexpected CRDT type")}}function e7(e){return tt(e)||e instanceof e6||tr(e)}function te(e){return e7(e)||e instanceof eG}function tt(e){return e instanceof eY}function tr(e){return e instanceof e3}function ti(e){return e instanceof eG?e.data:e instanceof eY||e instanceof e6||e instanceof e3?e:ed(e,"Unknown AbstractCrdt")}function ts(e){return e instanceof e3||e instanceof e6||e instanceof eY?e:new eG(e)}Symbol.iterator;var tn=(e=>(e[e.UPDATE_PRESENCE=100]="UPDATE_PRESENCE",e[e.BROADCAST_EVENT=103]="BROADCAST_EVENT",e[e.FETCH_STORAGE=200]="FETCH_STORAGE",e[e.UPDATE_STORAGE=201]="UPDATE_STORAGE",e[e.FETCH_YDOC=300]="FETCH_YDOC",e[e.UPDATE_YDOC=301]="UPDATE_YDOC",e))(tn||{});function ta(e,t,r,i,s){if("number"!=typeof t||t<r||void 0!==i&&t>i)throw Error(void 0!==i?`${e} should be between ${s??r} and ${i}.`:`${e} should be at least ${s??r}.`);return t}var to={paragraph:function(e){return"type"in e&&"paragraph"===e.type},text:function(e){return!("type"in e)&&"text"in e&&"string"==typeof e.text},link:function(e){return"type"in e&&"link"===e.type},mention:function(e){return"type"in e&&"mention"===e.type}},td={paragraph:"block",text:"inline",link:"inline",mention:"inline"},tl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},th=RegExp(Object.keys(tl).map(e=>`\\${e}`).join("|"),"g"),tc=class{#er;#ei;constructor(e,t){this.#er=e,this.#ei=t}toString(){return this.#er.reduce((e,t,r)=>e+function(e){if(e instanceof tc)return e.toString();if(Array.isArray(e))return(e.length<=0?new tc([""],[]):new tc(["",...Array(e.length-1).fill(""),""],e)).toString();return String(e).replace(th,e=>tl[e])}(el(this.#ei[r-1]))+t)}};function tu(e,...t){return new tc(e,t)}var tp={_:"\\_","*":"\\*","#":"\\#","`":"\\`","~":"\\~","!":"\\!","|":"\\|","(":"\\(",")":"\\)","{":"\\{","}":"\\}","[":"\\[","]":"\\]"},tf=RegExp(Object.keys(tp).map(e=>`\\${e}`).join("|"),"g"),tm=class{#er;#ei;constructor(e,t){this.#er=e,this.#ei=t}toString(){return this.#er.reduce((e,t,r)=>e+function(e){if(e instanceof tm)return e.toString();if(Array.isArray(e))return(e.length<=0?new tm([""],[]):new tm(["",...Array(e.length-1).fill(""),""],e)).toString();return String(e).replace(tf,e=>tp[e])}(el(this.#ei[r-1]))+t)}};function ty(e,...t){return new tm(e,t)}function tg(e){let t={};for(let r in e){let i=e[r];void 0!==i&&(t[r]=t_(i))}return t}function t_(e){if(e instanceof e3)return tg(e.toObject());if(e instanceof eY)return e.toArray().map(t_);if(e instanceof e6){let t={};for(let[r,i]of e.entries())t[r]=t_(i);return t}return e instanceof eG?e.data:Array.isArray(e)?e.map(t_):v(e)?tg(e):e}function tw(e){if(Array.isArray(e))return new eY(e.map(tw));if(!v(e))return e;{let t={};for(let r in e){let i=e[r];void 0!==i&&(t[r]=tw(i))}return new e3(t)}}var tk=(e=>(e.Lexical="lexical",e.TipTap="tiptap",e.BlockNote="blocknote",e))(tk||{});async function tv(e){let t=[];for await(let r of e)t.push(r);return t}async function tb(e,t,r){let i=new Set;for await(let s of e){i.size>=r&&await Promise.race(i);let e=(async()=>{try{await t(s)}finally{i.delete(e)}})();i.add(e)}i.size>0&&await Promise.all(i)}d(s,n,"esm"),r(98562),r(94068);var tS=class extends TransformStream{constructor(){let e="";super({transform(t,r){if((e+=t).includes("\n")){let t=e.split("\n");for(let e=0;e<t.length-1;e++)t[e].length>0&&r.enqueue(t[e]);e=t[t.length-1]}},flush(t){e.length>0&&t.enqueue(e)}})}},tT=class extends TransformStream{constructor(){super({transform(e,t){let r=JSON.parse(e);t.enqueue(r)}})}},tE=/^[\w-]+$/;async function tA(){return void 0!==globalThis.fetch?globalThis.fetch:(await r.e(851).then(r.bind(r,5851))).default}function tI(e){return"string"==typeof e}function tO(e,t){if(!(tI(e)&&e.length>0))throw Error(`Invalid value for field '${t}'. Please provide a non-empty string. For more information: https://liveblocks.io/docs/api-reference/liveblocks-node#authorize`)}function tC(e){return e>=200&&e<300?200:e>=500?503:403}var tx=Object.freeze(["room:write","room:read","room:presence:write","comments:write","comments:read"]),tP=Object.freeze(["room:read","room:presence:write","comments:read"]),tN=Object.freeze(["room:write","comments:write"]),tU=/^([*]|[^*]{1,128}[*]?)$/,tR=class{FULL_ACCESS=tN;READ_ACCESS=tP;#es;#en;#ea;#eo=!1;#ed=new Map;constructor(e,t,r){tO(t,"userId"),this.#es=e,this.#en=t,this.#ea=r}#el(e){if(this.#eo)throw Error("You can no longer change these permissions.");let t=this.#ed.get(e);if(t)return t;if(this.#ed.size>=10)throw Error("You cannot add permissions for more than 10 rooms in a single token");return t=new Set,this.#ed.set(e,t),t}allow(e,t){if("string"!=typeof e)throw Error("Room name or pattern must be a string");if(!tU.test(e))throw Error("Invalid room name or pattern");if(0===t.length)throw Error("Permission list cannot be empty");let r=this.#el(e);for(let e of t){if(!tx.includes(e))throw Error(`Not a valid permission: ${e}`);r.add(e)}return this}hasPermissions(){return this.#ed.size>0}seal(){if(this.#eo)throw Error("You cannot reuse Session instances. Please create a new session every time.");this.#eo=!0}serializePermissions(){return Object.fromEntries(Array.from(this.#ed.entries()).map(([e,t])=>[e,Array.from(t)]))}async authorize(){this.seal(),this.hasPermissions()||console.warn("Access tokens without any permission will not be supported soon, you should use wildcards when the client requests a token for resources outside a room. See https://liveblocks.io/docs/errors/liveblocks-client/access-tokens-not-enough-permissions");try{let e=await this.#es(eo`/v2/authorize-user`,{userId:this.#en,permissions:this.serializePermissions(),userInfo:this.#ea});return{status:tC(e.status),body:await e.text()}}catch(e){return{status:503,body:'Call to /v2/authorize-user failed. See "error" for more information.',error:e}}}};function tD(e){let t=new Date(e.createdAt),r=e.lastConnectionAt?new Date(e.lastConnectionAt):void 0;return{...e,createdAt:t,lastConnectionAt:r}}var tq=class{#eh;#ec;constructor(e){let t=e.secret;!function(e,t){if(!(tI(e)&&e.startsWith("sk_")))throw Error(`Invalid value for field '${t}'. Secret keys must start with 'sk_'. Please provide the secret key from your Liveblocks dashboard at https://liveblocks.io/dashboard/apikeys.`);if(!tE.test(e))throw Error(`Invalid chars found in field '${t}'. Please check that you correctly copied the secret key from your Liveblocks dashboard at https://liveblocks.io/dashboard/apikeys.`)}(t,"secret"),this.#eh=t,this.#ec=new URL(function(e){return"string"==typeof e&&e.startsWith("http")?e:"https://api.liveblocks.io"}(e.baseUrl))}async #eu(e,t,r){let i=ea(this.#ec,e),s={Authorization:`Bearer ${this.#eh}`,"Content-Type":"application/json"},n=await tA();return await n(i,{method:"POST",headers:s,body:JSON.stringify(t),signal:r?.signal})}async #ep(e,t,r){let i=ea(this.#ec,e),s={Authorization:`Bearer ${this.#eh}`,"Content-Type":"application/json"},n=await tA();return await n(i,{method:"PUT",headers:s,body:JSON.stringify(t),signal:r?.signal})}async #ef(e,t,r,i){let s=ea(this.#ec,e,r),n={Authorization:`Bearer ${this.#eh}`,"Content-Type":"application/octet-stream"},a=await tA();return await a(s,{method:"PUT",headers:n,body:t,signal:i?.signal})}async #em(e,t){let r=ea(this.#ec,e),i={Authorization:`Bearer ${this.#eh}`},s=await tA();return await s(r,{method:"DELETE",headers:i,signal:t?.signal})}async #ey(e,t,r){let i=ea(this.#ec,e,t),s={Authorization:`Bearer ${this.#eh}`},n=await tA();return await n(i,{method:"GET",headers:s,signal:r?.signal})}prepareSession(e,...t){let r=t[0];return new tR(this.#eu.bind(this),e,r?.userInfo)}async identifyUser(e,...t){let r=t[0],i=eo`/v2/identify-user`,{userId:s,groupIds:n,tenantId:a}="string"==typeof e?{userId:e,groupIds:void 0,tenantId:void 0}:e;tO(s,"userId");let o={userId:s,groupIds:n,tenantId:a,userInfo:r?.userInfo};try{let e=await this.#eu(i,o);return{status:tC(e.status),body:await e.text()}}catch(e){return{status:503,body:`Call to ${ea(this.#ec,i)} failed. See "error" for more information.`,error:e}}}async getRooms(e={},t){let r,i=eo`/v2/rooms`;"string"==typeof e.query?r=e.query:"object"==typeof e.query&&(r=Z(e.query));let s={limit:e.limit,startingAfter:e.startingAfter,userId:e.userId,groupIds:e.groupIds?e.groupIds.join(","):void 0,query:r},n=await this.#ey(i,s,t);if(!n.ok)throw await tL.from(n);let a=await n.json(),o=a.data.map(tD);return{...a,data:o}}async *iterRooms(e,t){let r,{signal:i}=t??{},s=ta("pageSize",t?.pageSize??40,20);for(;;){let{nextCursor:t,data:n}=await this.getRooms({...e,startingAfter:r,limit:s},{signal:i});for(let e of n)yield e;if(!t)break;r=t}}async createRoom(e,t,r){let{defaultAccesses:i,groupsAccesses:s,usersAccesses:n,metadata:a}=t,o=await this.#eu(r?.idempotent?eo`/v2/rooms?idempotent`:eo`/v2/rooms`,{id:e,defaultAccesses:i,groupsAccesses:s,usersAccesses:n,metadata:a},r);if(!o.ok)throw await tL.from(o);return tD(await o.json())}async getOrCreateRoom(e,t,r){return await this.createRoom(e,t,{...r,idempotent:!0})}async upsertRoom(e,t,r){let i=await this.#eu(eo`/v2/rooms/${e}/upsert`,t,r);if(!i.ok)throw await tL.from(i);return tD(await i.json())}async getRoom(e,t){let r=await this.#ey(eo`/v2/rooms/${e}`,void 0,t);if(!r.ok)throw await tL.from(r);return tD(await r.json())}async updateRoom(e,t,r){let{defaultAccesses:i,groupsAccesses:s,usersAccesses:n,metadata:a}=t,o=await this.#eu(eo`/v2/rooms/${e}`,{defaultAccesses:i,groupsAccesses:s,usersAccesses:n,metadata:a},r);if(!o.ok)throw await tL.from(o);return tD(await o.json())}async deleteRoom(e,t){let r=await this.#em(eo`/v2/rooms/${e}`,t);if(!r.ok)throw await tL.from(r)}async getActiveUsers(e,t){let r=await this.#ey(eo`/v2/rooms/${e}/active_users`,void 0,t);if(!r.ok)throw await tL.from(r);return await r.json()}async broadcastEvent(e,t,r){let i=await this.#eu(eo`/v2/rooms/${e}/broadcast_event`,t,r);if(!i.ok)throw await tL.from(i)}async getStorageDocument(e,t="plain-lson",r){let i=await this.#ey(eo`/v2/rooms/${e}/storage`,{format:t},r);if(!i.ok)throw await tL.from(i);return await i.json()}async #eg(e,t){let r=await this.#eu(eo`/v2/rooms/${e}/request-storage-mutation`,{},t);if(!r.ok)throw await tL.from(r);if("application/x-ndjson"!==r.headers.get("content-type"))throw Error("Unexpected response content type");if(null===r.body)throw Error("Unexpected null body in response");let i=r.body.pipeThrough(new TextDecoderStream).pipeThrough(new tS).pipeThrough(new tT)[Symbol.asyncIterator](),s=(await i.next()).value;if(!v(s)||"number"!=typeof s.actor)throw Error("Failed to obtain a unique session");let n=await tv(i);return{actor:s.actor,nodes:n}}async initializeStorageDocument(e,t,r){let i=await this.#eu(eo`/v2/rooms/${e}/storage`,t,r);if(!i.ok)throw await tL.from(i);return await i.json()}async deleteStorageDocument(e,t){let r=await this.#em(eo`/v2/rooms/${e}/storage`,t);if(!r.ok)throw await tL.from(r)}async getYjsDocument(e,t={},r){let{format:i,key:s,type:n}=t,a=eo`v2/rooms/${e}/ydoc`,o=await this.#ey(a,{formatting:i?"true":void 0,key:s,type:n},r);if(!o.ok)throw await tL.from(o);return await o.json()}async sendYjsBinaryUpdate(e,t,r={},i){let s=await this.#ef(eo`/v2/rooms/${e}/ydoc`,t,{guid:r.guid},i);if(!s.ok)throw await tL.from(s)}async getYjsDocumentAsBinaryUpdate(e,t={},r){let i=await this.#ey(eo`/v2/rooms/${e}/ydoc-binary`,{guid:t.guid},r);if(!i.ok)throw await tL.from(i);return i.arrayBuffer()}async createSchema(e,t,r){let i=await this.#eu(eo`/v2/schemas`,{name:e,body:t},r);if(!i.ok)throw await tL.from(i);let s=await i.json(),n=new Date(s.createdAt),a=new Date(s.updatedAt);return{...s,createdAt:n,updatedAt:a}}async getSchema(e,t){let r=await this.#ey(eo`/v2/schemas/${e}`,void 0,t);if(!r.ok)throw await tL.from(r);let i=await r.json(),s=new Date(i.createdAt),n=new Date(i.updatedAt);return{...i,createdAt:s,updatedAt:n}}async updateSchema(e,t,r){let i=await this.#ep(eo`/v2/schemas/${e}`,{body:t},r);if(!i.ok)throw await tL.from(i);let s=await i.json(),n=new Date(s.createdAt),a=new Date(s.updatedAt);return{...s,createdAt:n,updatedAt:a}}async deleteSchema(e,t){let r=await this.#em(eo`/v2/schemas/${e}`,t);if(!r.ok)throw await tL.from(r)}async getSchemaByRoomId(e,t){let r=await this.#ey(eo`/v2/rooms/${e}/schema`,void 0,t);if(!r.ok)throw await tL.from(r);let i=await r.json(),s=new Date(i.createdAt),n=new Date(i.updatedAt);return{...i,createdAt:s,updatedAt:n}}async attachSchemaToRoom(e,t,r){let i=await this.#eu(eo`/v2/rooms/${e}/schema`,{schema:t},r);if(!i.ok)throw await tL.from(i);return await i.json()}async detachSchemaFromRoom(e,t){let r=await this.#em(eo`/v2/rooms/${e}/schema`,t);if(!r.ok)throw await tL.from(r)}async getThreads(e,t){let r,{roomId:i}=e;"string"==typeof e.query?r=e.query:"object"==typeof e.query&&(r=Z(e.query));let s=await this.#ey(eo`/v2/rooms/${i}/threads`,{query:r},t);if(!s.ok)throw await tL.from(s);let{data:n}=await s.json();return{data:n.map(e=>h(e))}}async getThread(e,t){let{roomId:r,threadId:i}=e,s=await this.#ey(eo`/v2/rooms/${r}/threads/${i}`,void 0,t);if(!s.ok)throw await tL.from(s);return h(await s.json())}async getThreadParticipants(e,t){let{roomId:r,threadId:i}=e,s=await this.#ey(eo`/v2/rooms/${r}/threads/${i}/participants`,void 0,t);if(!s.ok)throw await tL.from(s);return await s.json()}async getThreadSubscriptions(e,t){let{roomId:r,threadId:i}=e,s=await this.#ey(eo`/v2/rooms/${r}/threads/${i}/subscriptions`,void 0,t);if(!s.ok)throw await tL.from(s);let{data:n}=await s.json();return{data:n.map(u)}}async getComment(e,t){let{roomId:r,threadId:i,commentId:s}=e,n=await this.#ey(eo`/v2/rooms/${r}/threads/${i}/comments/${s}`,void 0,t);if(!n.ok)throw await tL.from(n);return l(await n.json())}async createComment(e,t){let{roomId:r,threadId:i,data:s}=e,n=await this.#eu(eo`/v2/rooms/${r}/threads/${i}/comments`,{...s,createdAt:s.createdAt?.toISOString()},t);if(!n.ok)throw await tL.from(n);return l(await n.json())}async editComment(e,t){let{roomId:r,threadId:i,commentId:s,data:n}=e,a=await this.#eu(eo`/v2/rooms/${r}/threads/${i}/comments/${s}`,{...n,editedAt:n.editedAt?.toISOString()},t);if(!a.ok)throw await tL.from(a);return l(await a.json())}async deleteComment(e,t){let{roomId:r,threadId:i,commentId:s}=e,n=await this.#em(eo`/v2/rooms/${r}/threads/${i}/comments/${s}`,t);if(!n.ok)throw await tL.from(n)}async createThread(e,t){let{roomId:r,data:i}=e,s=await this.#eu(eo`/v2/rooms/${r}/threads`,{...i,comment:{...i.comment,createdAt:i.comment.createdAt?.toISOString()}},t);if(!s.ok)throw await tL.from(s);return h(await s.json())}async deleteThread(e,t){let{roomId:r,threadId:i}=e,s=await this.#em(eo`/v2/rooms/${r}/threads/${i}`,t);if(!s.ok)throw await tL.from(s)}async markThreadAsResolved(e,t){let{roomId:r,threadId:i}=e,s=await this.#eu(eo`/v2/rooms/${r}/threads/${i}/mark-as-resolved`,{userId:e.data.userId},t);if(!s.ok)throw await tL.from(s);return h(await s.json())}async markThreadAsUnresolved(e,t){let{roomId:r,threadId:i}=e,s=await this.#eu(eo`/v2/rooms/${r}/threads/${i}/mark-as-unresolved`,{userId:e.data.userId},t);if(!s.ok)throw await tL.from(s);return h(await s.json())}async subscribeToThread(e,t){let{roomId:r,threadId:i}=e,s=await this.#eu(eo`/v2/rooms/${r}/threads/${i}/subscribe`,{userId:e.data.userId},t);if(!s.ok)throw await tL.from(s);var n=await s.json();let a=new Date(n.createdAt);return{...n,createdAt:a}}async unsubscribeFromThread(e,t){let{roomId:r,threadId:i}=e,s=await this.#eu(eo`/v2/rooms/${r}/threads/${i}/unsubscribe`,{userId:e.data.userId},t);if(!s.ok)throw await tL.from(s)}async editThreadMetadata(e,t){let{roomId:r,threadId:i,data:s}=e,n=await this.#eu(eo`/v2/rooms/${r}/threads/${i}/metadata`,{...s,updatedAt:s.updatedAt?.toISOString()},t);if(!n.ok)throw await tL.from(n);return await n.json()}async addCommentReaction(e,t){var r;let{roomId:i,threadId:s,commentId:n,data:a}=e,o=await this.#eu(eo`/v2/rooms/${i}/threads/${s}/comments/${n}/add-reaction`,{...a,createdAt:a.createdAt?.toISOString()},t);if(!o.ok)throw await tL.from(o);return{...r=await o.json(),createdAt:new Date(r.createdAt)}}async removeCommentReaction(e,t){let{roomId:r,threadId:i,data:s}=e,n=await this.#eu(eo`/v2/rooms/${r}/threads/${i}/comments/${e.commentId}/remove-reaction`,{...s,removedAt:s.removedAt?.toISOString()},t);if(!n.ok)throw await tL.from(n)}async getInboxNotification(e,t){let{userId:r,inboxNotificationId:i}=e,s=await this.#ey(eo`/v2/users/${r}/inbox-notifications/${i}`,void 0,t);if(!s.ok)throw await tL.from(s);return c(await s.json())}async getInboxNotifications(e,t){let r,{userId:i}=e;"string"==typeof e.query?r=e.query:"object"==typeof e.query&&(r=Z(e.query));let s=await this.#ey(eo`/v2/users/${i}/inbox-notifications`,{query:r,limit:e?.limit,startingAfter:e?.startingAfter},t);if(!s.ok)throw await tL.from(s);let n=await s.json();return{...n,data:n.data.map(c)}}async *iterInboxNotifications(e,t){let r,{signal:i}=t??{},s=ta("pageSize",t?.pageSize??50,10);for(;;){let{nextCursor:t,data:n}=await this.getInboxNotifications({...e,startingAfter:r,limit:s},{signal:i});for(let e of n)yield e;if(!t)break;r=t}}async getUserRoomSubscriptionSettings(e,t){let{userId:r,startingAfter:i,limit:s}=e,n=await this.#ey(eo`/v2/users/${r}/room-subscription-settings`,{startingAfter:i,limit:s},t);if(!n.ok)throw await tL.from(n);return await n.json()}async getRoomSubscriptionSettings(e,t){let{userId:r,roomId:i}=e,s=await this.#ey(eo`/v2/rooms/${i}/users/${r}/subscription-settings`,void 0,t);if(!s.ok)throw await tL.from(s);return await s.json()}async updateRoomSubscriptionSettings(e,t){let{userId:r,roomId:i,data:s}=e,n=await this.#eu(eo`/v2/rooms/${i}/users/${r}/subscription-settings`,s,t);if(!n.ok)throw await tL.from(n);return await n.json()}async deleteRoomSubscriptionSettings(e,t){let{userId:r,roomId:i}=e,s=await this.#em(eo`/v2/rooms/${i}/users/${r}/subscription-settings`,t);if(!s.ok)throw await tL.from(s)}async updateRoomId(e,t){let{currentRoomId:r,newRoomId:i}=e,s=await this.#eu(eo`/v2/rooms/${r}/update-room-id`,{newRoomId:i},t);if(!s.ok)throw await tL.from(s);return tD(await s.json())}async triggerInboxNotification(e,t){let r=await this.#eu(eo`/v2/inbox-notifications/trigger`,e,t);if(!r.ok)throw await tL.from(r)}async deleteInboxNotification(e,t){let{userId:r,inboxNotificationId:i}=e,s=await this.#em(eo`/v2/users/${r}/inbox-notifications/${i}`,t);if(!s.ok)throw await tL.from(s)}async deleteAllInboxNotifications(e,t){let{userId:r}=e,i=await this.#em(eo`/v2/users/${r}/inbox-notifications`,t);if(!i.ok)throw await tL.from(i)}async getNotificationSettings(e,t){let{userId:r}=e,i=await this.#ey(eo`/v2/users/${r}/notification-settings`,void 0,t);if(!i.ok)throw await tL.from(i);return eD(await i.json())}async updateNotificationSettings(e,t){let{userId:r,data:i}=e,s=await this.#eu(eo`/v2/users/${r}/notification-settings`,i,t);if(!s.ok)throw await tL.from(s);return eD(await s.json())}async deleteNotificationSettings(e,t){let{userId:r}=e,i=await this.#em(eo`/v2/users/${r}/notification-settings`,t);if(!i.ok)throw await tL.from(i)}async mutateStorage(e,t,r){return this.#e_(e,void 0,t,r)}async massMutateStorage(e,t,r){let i=ta("concurrency",r?.concurrency??8,1,20),s=Math.max(20,4*i),{signal:n}=r??{},a=this.iterRooms(e,{pageSize:s,signal:n}),o={signal:n};await tb(a,e=>this.#e_(e.id,e,t,o),i)}async #e_(e,t,r,i){let s,{signal:n,abort:a}=function(e){let t=new AbortController;return{signal:e?AbortSignal.any([t.signal,e]):t.signal,abort:t.abort.bind(t)}}(i?.signal),o=[],d=performance.now(),l=t=>{if(0===o.length||s)return;let r=performance.now();if(!(t||r-d>200))return;d=r;let i=o;o=[],s=this.#ew(e,[{type:tn.UPDATE_STORAGE,ops:i}],{signal:n}).catch(e=>{a(e)}).finally(()=>{s=void 0})};try{let{actor:i,nodes:s}=await this.#eg(e,{signal:n}),a=function(e,t){let{getCurrentConnectionId:r,onDispatch:i,isStorageWritable:s=()=>!0}=t,n=0,a=0,o=new Map;return{roomId:e,nodes:o,getNode:e=>o.get(e),addNode:(e,t)=>void o.set(e,t),deleteNode:e=>void o.delete(e),generateId:()=>`${r()}:${n++}`,generateOpId:()=>`${r()}:${a++}`,dispatch(e,t,r){i?.(e,t,r)},assertStorageIsWritable:()=>{if(!s())throw Error("Cannot write to storage with a read only user, please ensure the user has write permissions")}}}(e,{getCurrentConnectionId:()=>i,onDispatch:(e,t,r)=>{if(0!==e.length){for(let t of e)o.push(t);l(!1)}}}),d=e3._fromItems(s,a),h=r({room:t,root:d});l(!0),await h}catch(e){throw a(),e}finally{await s,l(!0),await s}}async #ew(e,t,r){let i=await this.#eu(eo`/v2/rooms/${e}/send-message`,{messages:t},{signal:r?.signal});if(!i.ok)throw await tL.from(i)}},tL=class e extends Error{status;details;constructor(e,t,r){super(e),this.name="LiveblocksError",this.status=t,this.details=r}toString(){let e=`${this.name}: ${this.message} (status ${this.status})`;return this.details&&(e+=`
${this.details}`),e}static async from(t){let r,i=Error();Error.captureStackTrace(i,e.from);let s="An error happened without an error message";try{r=await t.text()}catch{r=s}let n=E(r)??{message:r},a=n.message||s,o=[n.suggestion?`Suggestion: ${String(n.suggestion)}`:void 0,n.docs?`See also: ${String(n.docs)}`:void 0].filter(Boolean).join("\n")||void 0,d=new e(a,t.status,o);return d.stack=i.stack,d}};d("@liveblocks/node","3.2.1","esm")},94068:function(e,t,r){var i,s={};!function(e){"use strict";e.__esModule=!0,e.digestLength=32,e.blockSize=64;var t=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]);function r(e,r,i,s,n){for(var a,o,d,l,h,c,u,p,f,m,y,g,_;n>=64;){for(m=0,a=r[0],o=r[1],d=r[2],l=r[3],h=r[4],c=r[5],u=r[6],p=r[7];m<16;m++)y=s+4*m,e[m]=(255&i[y])<<24|(255&i[y+1])<<16|(255&i[y+2])<<8|255&i[y+3];for(m=16;m<64;m++)g=((f=e[m-2])>>>17|f<<15)^(f>>>19|f<<13)^f>>>10,_=((f=e[m-15])>>>7|f<<25)^(f>>>18|f<<14)^f>>>3,e[m]=(g+e[m-7]|0)+(_+e[m-16]|0);for(m=0;m<64;m++)g=(((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&c^~h&u)|0)+(p+(t[m]+e[m]|0)|0)|0,_=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&o^a&d^o&d)|0,p=u,u=c,c=h,h=l+g|0,l=d,d=o,o=a,a=g+_|0;r[0]+=a,r[1]+=o,r[2]+=d,r[3]+=l,r[4]+=h,r[5]+=c,r[6]+=u,r[7]+=p,s+=64,n-=64}return s}var i=function(){function t(){this.digestLength=e.digestLength,this.blockSize=e.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return t.prototype.reset=function(){return this.state[0]=0x6a09e667,this.state[1]=0xbb67ae85,this.state[2]=0x3c6ef372,this.state[3]=0xa54ff53a,this.state[4]=0x510e527f,this.state[5]=0x9b05688c,this.state[6]=0x1f83d9ab,this.state[7]=0x5be0cd19,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},t.prototype.clean=function(){for(var e=0;e<this.buffer.length;e++)this.buffer[e]=0;for(var e=0;e<this.temp.length;e++)this.temp[e]=0;this.reset()},t.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this.finished)throw Error("SHA256: can't update because hash was finished.");var i=0;if(this.bytesHashed+=t,this.bufferLength>0){for(;this.bufferLength<64&&t>0;)this.buffer[this.bufferLength++]=e[i++],t--;64===this.bufferLength&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(t>=64&&(i=r(this.temp,this.state,e,i,t),t%=64);t>0;)this.buffer[this.bufferLength++]=e[i++],t--;return this},t.prototype.finish=function(e){if(!this.finished){var t=this.bytesHashed,i=this.bufferLength,s=t/0x20000000|0,n=t<<3,a=t%64<56?64:128;this.buffer[i]=128;for(var o=i+1;o<a-8;o++)this.buffer[o]=0;this.buffer[a-8]=s>>>24&255,this.buffer[a-7]=s>>>16&255,this.buffer[a-6]=s>>>8&255,this.buffer[a-5]=s>>>0&255,this.buffer[a-4]=n>>>24&255,this.buffer[a-3]=n>>>16&255,this.buffer[a-2]=n>>>8&255,this.buffer[a-1]=n>>>0&255,r(this.temp,this.state,this.buffer,0,a),this.finished=!0}for(var o=0;o<8;o++)e[4*o+0]=this.state[o]>>>24&255,e[4*o+1]=this.state[o]>>>16&255,e[4*o+2]=this.state[o]>>>8&255,e[4*o+3]=this.state[o]>>>0&255;return this},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype._saveState=function(e){for(var t=0;t<this.state.length;t++)e[t]=this.state[t]},t.prototype._restoreState=function(e,t){for(var r=0;r<this.state.length;r++)this.state[r]=e[r];this.bytesHashed=t,this.finished=!1,this.bufferLength=0},t}();e.Hash=i;var s=function(){function e(e){this.inner=new i,this.outer=new i,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var t=new Uint8Array(this.blockSize);if(e.length>this.blockSize)new i().update(e).finish(t).clean();else for(var r=0;r<e.length;r++)t[r]=e[r];for(var r=0;r<t.length;r++)t[r]^=54;this.inner.update(t);for(var r=0;r<t.length;r++)t[r]^=106;this.outer.update(t),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var r=0;r<t.length;r++)t[r]=0}return e.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},e.prototype.clean=function(){for(var e=0;e<this.istate.length;e++)this.ostate[e]=this.istate[e]=0;this.inner.clean(),this.outer.clean()},e.prototype.update=function(e){return this.inner.update(e),this},e.prototype.finish=function(e){return this.outer.finished?this.outer.finish(e):(this.inner.finish(e),this.outer.update(e,this.digestLength).finish(e)),this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e}();function n(e){var t=new i().update(e),r=t.digest();return t.clean(),r}function a(e,t){var r=new s(e).update(t),i=r.digest();return r.clean(),i}e.HMAC=s,e.hash=n,e.default=n,e.hmac=a;var o=new Uint8Array(e.digestLength);e.hkdf=function(e,t,r,i){void 0===t&&(t=o),void 0===i&&(i=32);for(var n=new Uint8Array([1]),d=new s(a(t,e)),l=new Uint8Array(d.digestLength),h=l.length,c=new Uint8Array(i),u=0;u<i;u++)h===l.length&&(!function(e,t,r,i){var s=i[0];if(0===s)throw Error("hkdf: cannot expand more");t.reset(),s>1&&t.update(e),r&&t.update(r),t.update(i),t.finish(e),i[0]++}(l,d,r,n),h=0),c[u]=l[h++];return d.clean(),l.fill(0),n.fill(0),c},e.pbkdf2=function(e,t,r,i){for(var n=new s(e),a=n.digestLength,o=new Uint8Array(4),d=new Uint8Array(a),l=new Uint8Array(a),h=new Uint8Array(i),c=0;c*a<i;c++){var u=c+1;o[0]=u>>>24&255,o[1]=u>>>16&255,o[2]=u>>>8&255,o[3]=u>>>0&255,n.reset(),n.update(t),n.update(o),n.finish(l);for(var p=0;p<a;p++)d[p]=l[p];for(var p=2;p<=r;p++){n.reset(),n.update(l).finish(l);for(var f=0;f<a;f++)d[f]^=l[f]}for(var p=0;p<a&&c*a+p<i;p++)h[c*a+p]=d[p]}for(var c=0;c<a;c++)d[c]=l[c]=0;for(var c=0;c<4;c++)o[c]=0;return n.clean(),h}}(s);var n=s.default;for(var a in s)n[a]=s[a];"object"==typeof e.exports?e.exports=n:void 0===(i=(function(){return n}).call(s,r,s,e))||(e.exports=i)},98562:function(e,t){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){void 0===e&&(e="="),this._paddingCharacter=e}return e.prototype.encodedLength=function(e){return this._paddingCharacter?(e+2)/3*4|0:(8*e+5)/6|0},e.prototype.encode=function(e){for(var t="",r=0;r<e.length-2;r+=3){var i=e[r]<<16|e[r+1]<<8|e[r+2];t+=this._encodeByte(i>>>18&63),t+=this._encodeByte(i>>>12&63),t+=this._encodeByte(i>>>6&63),t+=this._encodeByte(i>>>0&63)}var s=e.length-r;if(s>0){var i=e[r]<<16|(2===s?e[r+1]<<8:0);t+=this._encodeByte(i>>>18&63),t+=this._encodeByte(i>>>12&63),2===s?t+=this._encodeByte(i>>>6&63):t+=this._paddingCharacter||"",t+=this._paddingCharacter||""}return t},e.prototype.maxDecodedLength=function(e){return this._paddingCharacter?e/4*3|0:(6*e+7)/8|0},e.prototype.decodedLength=function(e){return this.maxDecodedLength(e.length-this._getPaddingLength(e))},e.prototype.decode=function(e){if(0===e.length)return new Uint8Array(0);for(var t=this._getPaddingLength(e),r=e.length-t,i=new Uint8Array(this.maxDecodedLength(r)),s=0,n=0,a=0,o=0,d=0,l=0,h=0;n<r-4;n+=4)o=this._decodeChar(e.charCodeAt(n+0)),d=this._decodeChar(e.charCodeAt(n+1)),l=this._decodeChar(e.charCodeAt(n+2)),h=this._decodeChar(e.charCodeAt(n+3)),i[s++]=o<<2|d>>>4,i[s++]=d<<4|l>>>2,i[s++]=l<<6|h,a|=256&o,a|=256&d,a|=256&l,a|=256&h;if(n<r-1&&(o=this._decodeChar(e.charCodeAt(n)),d=this._decodeChar(e.charCodeAt(n+1)),i[s++]=o<<2|d>>>4,a|=256&o,a|=256&d),n<r-2&&(l=this._decodeChar(e.charCodeAt(n+2)),i[s++]=d<<4|l>>>2,a|=256&l),n<r-3&&(h=this._decodeChar(e.charCodeAt(n+3)),i[s++]=l<<6|h,a|=256&h),0!==a)throw Error("Base64Coder: incorrect characters for decoding");return i},e.prototype._encodeByte=function(e){var t=e;return t+=65,t+=25-e>>>8&6,t+=51-e>>>8&-75,t+=61-e>>>8&-15,String.fromCharCode(t+=62-e>>>8&3)},e.prototype._decodeChar=function(e){var t;return 256+((42-e&e-44)>>>8&-256+e-43+62)+((46-e&e-48)>>>8&-256+e-47+63)+((47-e&e-58)>>>8&-256+e-48+52)+((64-e&e-91)>>>8&-256+e-65+0)+((96-e&e-123)>>>8&-256+e-97+26)},e.prototype._getPaddingLength=function(e){var t=0;if(this._paddingCharacter){for(var r=e.length-1;r>=0&&e[r]===this._paddingCharacter;r--)t++;if(e.length<4||t>2)throw Error("Base64Coder: incorrect padding")}return t},e}();t.Coder=s;var n=new s;t.encode=function(e){return n.encode(e)},t.decode=function(e){return n.decode(e)};var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._encodeByte=function(e){var t=e;return t+=65,t+=25-e>>>8&6,t+=51-e>>>8&-75,t+=61-e>>>8&-13,String.fromCharCode(t+=62-e>>>8&49)},t.prototype._decodeChar=function(e){var t;return 256+((44-e&e-46)>>>8&-256+e-45+62)+((94-e&e-96)>>>8&-256+e-95+63)+((47-e&e-58)>>>8&-256+e-48+52)+((64-e&e-91)>>>8&-256+e-65+0)+((96-e&e-123)>>>8&-256+e-97+26)},t}(s);t.URLSafeCoder=a;var o=new a;t.encodeURLSafe=function(e){return o.encode(e)},t.decodeURLSafe=function(e){return o.decode(e)},t.encodedLength=function(e){return n.encodedLength(e)},t.maxDecodedLength=function(e){return n.maxDecodedLength(e)},t.decodedLength=function(e){return n.decodedLength(e)}}};